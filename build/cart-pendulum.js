!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CP=t():e.CP=t()}(self,(function(){return(()=>{"use strict";var e,t,i,r,s,n,o,a,l,h={d:(e,t)=>{for(var i in t)h.o(t,i)&&!h.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},c={};return h.r(c),h.d(c,{Box:()=>t,Cart:()=>r,Line:()=>i,LinearModel:()=>n,LinearModelTrain:()=>a,LinearRegression:()=>s,Runner:()=>o,Utils:()=>l,Vector2:()=>e}),e=class{constructor(e,t){this.x=e,this.y=t}},t=class{constructor(e,t){this.min=e,this.max=t}getSize(){return new e(this.max.x-this.min.x,this.max.y-this.min.y)}draw(e){var t;return t=this.getSize(),e.lineWidth=3,e.strokeRect(this.min.x,this.min.y,t.x,t.y)}},i=class{constructor(e,t){this.origin=e,this.end=t}size(){return Math.sqrt(Math.pow(this.origin.x-this.end.x,2)+Math.pow(this.origin.y-this.end.y,2))}draw(e){return e.lineWidth=3,e.beginPath(),e.moveTo(this.origin.x,this.origin.y),e.lineTo(this.end.x,this.end.y),e.stroke()}},r=class{constructor(){this.barrierDistance=400,this.boxHalfSize=50,this.moveAcceleration=.2,this.limitAngle=.7,this.cart=new t(new e(-this.boxHalfSize,-30),new e(this.boxHalfSize,30)),this.pendulum=new i(new e(0,0),new e(0,100)),this.barrierLeft=new i(new e(-this.barrierDistance,-1e3),new e(-this.barrierDistance,1e3)),this.barrierRight=new i(new e(this.barrierDistance,-1e3),new e(this.barrierDistance,1e3)),this.reset()}reset(){var e;return this.gameOver=!1,this.score=0,this.position=0,this.leftPressed=!1,this.rightPressed=!1,this.acceleration=0,this.friction=.99,this.velocity=2*Math.random()-1,this.velocity+=null!=(e=this.velocity<0)?e:-{.2:.2},this.angle=0}draw(e){return this.barrierLeft.draw(e),this.barrierRight.draw(e),e.translate(this.position,0),e.strokeStyle="#FF0000",e.lineWidth=1,e.beginPath(),e.moveTo(100*Math.sin(-this.limitAngle),100*Math.cos(-this.limitAngle)),e.lineTo(0,0),e.lineTo(100*Math.sin(this.limitAngle),100*Math.cos(this.limitAngle)),e.stroke(),e.strokeStyle="#000000",e.lineWidth=3,this.pendulum.end.x=100*Math.sin(this.angle),this.pendulum.end.y=100*Math.cos(this.angle),this.pendulum.draw(e),this.cart.draw(e)}update(){if(!this.gameOver)return this.leftPressed?this.acceleration=-this.moveAcceleration:this.rightPressed?this.acceleration=this.moveAcceleration:this.acceleration=0,this.velocity+=this.acceleration,this.velocity*=this.friction,this.position+=this.velocity,this.angle+=.03*this.angle+.005*-this.velocity,this.score++,(this.angle>this.limitAngle||this.angle<-this.limitAngle)&&(this.gameOver=!0),this.position+this.boxHalfSize>this.barrierDistance||this.position-this.boxHalfSize<-this.barrierDistance?this.gameOver=!0:void 0}},s=class e{constructor(e,t){this.ori=e,this.decl=t}jitter(e){return this.ori+=(Math.random()-.5)*e,this.decl+=(Math.random()-.5)*e}clone(){return new e(this.ori,this.decl)}},n=class e{constructor(){this.vel=new s(0,0),this.angle=new s(0,0),this.pos=new s(0,0),this.e=0}jitter(e){return this.vel.jitter(e),this.angle.jitter(e),this.pos.jitter(e),this.e+=(Math.random()-.5)*e}clone(){var t;return(t=new e).vel=this.pos.clone(),t.angle=this.pos.clone(),t.pos=this.pos.clone(),t.e=this.e,t}control(e){var t,i;return t=this.vel.decl*e.velocity+this.vel.ori,i=this.angle.decl*e.angle+this.angle.ori+t+(this.pos.decl*e.position+this.pos.ori),e.leftPressed=i<this.e,e.rightPressed=i>this.e}},o=class{static runHeadless(e,t,i){var s,n,o;for(t=void 0!==t?t:Infinity,s=new r,i&&(o=performance.now());!s.gameOver&&s.score<t;)void 0!==e&&e(s),s.update();return i&&(n=performance.now(),console.log(" - Simulation ended with "+s.score+" points, took "+(n-o)+".")),s.score}static runGraphical(e,t,i){var s,n,o,a;return s=new r,n=e.getContext("2d"),o=0,(a=function(){return void 0!==t&&t(s),s.update(),s.gameOver&&(void 0!==i&&i(s,o),s.score>o&&(o=s.score),s.reset()),n.save(),n.clearRect(0,0,e.width,e.height),n.font="15px Arial",n.textAlign="left",n.fillText("Points: "+s.score,10,20),n.fillText("Max: "+o,10,40),n.transform(1,0,0,-1,0,e.height),n.translate(e.width/2,e.height/2),s.draw(n),n.restore(),requestAnimationFrame(a)})()}},a=class e{static trainIterative(t,i,r,s){var o,a,l,h,c,d,u,g;for(t=void 0!==t?t:500,i=void 0!==i?i:100,r=void 0!==r?r:5,s=void 0!==s?s:2e3,console.log(" - Training process starting. ",{epochs:t,iterations:i,runs:r}),o=new n,a=e.testModel(o,r,s),l=0;l<t;){for(console.log(" - Running epoch ",l," score ",a),h=null,c=0,d=0;d<i;)(u=o.clone()).jitter(1),(g=e.testModel(u,r,s))>c&&(h=u,c=g),d++;if(c>=a&&(o=h,a=c),a>=s)break;l++}return console.log(" - Training finished with score ",a," model ",o),o}static trainRandom(t,i,r){var s,o,a,l,h;for(t=void 0!==t?t:1e5,i=void 0!==i?i:5,r=void 0!==r?r:2e3,console.log(" - Training process starting. ",{iterations:t,runs:i}),s=null,o=0,a=0;a<t&&((l=new n).jitter(2),(h=e.testModel(l,i,r))>o&&(s=l,o=h),console.log(" - Iteration ",a," score ",o),!(o>=r));)a++;return console.log(" - Training finished with score ",o," model ",s),s}static testModel(e,t,i){var r,s,n;for(n=0,s=0;s<t;)r=function(t){e.control(t)},n+=o.runHeadless(r,i),s++;return n/t}},l=class{static writeFile(e,t){var i,r;"object"==typeof e&&(e=JSON.stringify(e,null,"\t")),i=new Blob([e],{type:"octet/stream"}),(r=document.createElement("a")).download=t,r.href=window.URL.createObjectURL(i),r.style.display="none",r.onclick=function(){document.body.removeChild(this)},document.body.appendChild(r),r.click()}static readFile(e){var t;return(t=document.createElement("input")).type="file",t.style.display="none",document.body.appendChild(t),t.onchange=function(){var i,r;if(0!==(i=t.files).length)return(r=new FileReader).onload=function(){var t;return t=r.result,e(t)},r.readAsText(i[0]),document.body.removeChild(t)},t.click()}},c})()}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FydC1wZW5kdWx1bS5qcyIsIm1hcHBpbmdzIjoiQ0FBQSxTQUEyQ0EsRUFBTUMsR0FDMUIsaUJBQVpDLFNBQTBDLGlCQUFYQyxPQUN4Q0EsT0FBT0QsUUFBVUQsSUFDUSxtQkFBWEcsUUFBeUJBLE9BQU9DLElBQzlDRCxPQUFPLEdBQUlILEdBQ2UsaUJBQVpDLFFBQ2RBLFFBQVksR0FBSUQsSUFFaEJELEVBQVMsR0FBSUMsSUFSZixDQVNHSyxNQUFNLFdBQ1QsTSxtQkNUQSxJQ0RBLEVDQUEsRUNBQSxFQ0FBLEVDSTBDLEVDSjFDLEVDQUEsRUNBQSxFQ0F5RCxFVENyREMsRUFBc0IsQ1VBMUJBLEVBQXdCLENBQUNMLEVBQVNNLEtBQ2pDLElBQUksSUFBSUMsS0FBT0QsRUFDWEQsRUFBb0JHLEVBQUVGLEVBQVlDLEtBQVNGLEVBQW9CRyxFQUFFUixFQUFTTyxJQUM1RUUsT0FBT0MsZUFBZVYsRUFBU08sRUFBSyxDQUFFSSxZQUFZLEVBQU1DLElBQUtOLEVBQVdDLE1DSjNFRixFQUF3QixDQUFDUSxFQUFLQyxJQUFVTCxPQUFPTSxVQUFVQyxlQUFlQyxLQUFLSixFQUFLQyxHQ0NsRlQsRUFBeUJMLElBQ0gsb0JBQVhrQixRQUEwQkEsT0FBT0MsYUFDMUNWLE9BQU9DLGVBQWVWLEVBQVNrQixPQUFPQyxZQUFhLENBQUVDLE1BQU8sV0FFN0RYLE9BQU9DLGVBQWVWLEVBQVMsYUFBYyxDQUFFb0IsT0FBTyxNLG1LWExqREMsRUFBTixNQUtJQyxZQUFjQyxFQUFHQyxHQUNiLEtBQUNELEVBQUlBLEVBQ0wsS0FBQ0MsRUFBSUEsSUNIUEMsRUFBTixNQUdJSCxZQUFjSSxFQUFLQyxHQUNmLEtBQUNELElBQU1BLEVBQ1AsS0FBQ0MsSUFBTUEsRUFLWEMsVUFDSSxPQUFPLElBQUlQLEVBQVEsS0FBQ00sSUFBSUosRUFBSSxLQUFDRyxJQUFJSCxFQUFHLEtBQUNJLElBQUlILEVBQUksS0FBQ0UsSUFBSUYsR0FLdERLLEtBQU9DLEdBQ1AsSUFBSixFLE9BQVFDLEVBQU8sS0FBQ0gsVUFDUkUsRUFBUUUsVUFBWSxFQUNwQkYsRUFBUUcsV0FBVyxLQUFDUCxJQUFJSCxFQUFHLEtBQUNHLElBQUlGLEVBQUdPLEVBQUtSLEVBQUdRLEVBQUtQLEtDakJsRFUsRUFBTixNQUNJWixZQUFjYSxFQUFRQyxHQUNsQixLQUFDRCxPQUFTQSxFQUNWLEtBQUNDLElBQU1BLEVBS1hMLE9BQ0ksT0FBT00sS0FBS0MsS0FBS0QsS0FBS0UsSUFBSSxLQUFDSixPQUFPWixFQUFJLEtBQUNhLElBQUliLEVBQUcsR0FBS2MsS0FBS0UsSUFBSSxLQUFDSixPQUFPWCxFQUFJLEtBQUNZLElBQUlaLEVBQUcsSUFLcEZLLEtBQU9DLEcsT0FDSEEsRUFBUUUsVUFBWSxFQUNwQkYsRUFBUVUsWUFDUlYsRUFBUVcsT0FBTyxLQUFDTixPQUFPWixFQUFHLEtBQUNZLE9BQU9YLEdBQ2xDTSxFQUFRWSxPQUFPLEtBQUNOLElBQUliLEVBQUcsS0FBQ2EsSUFBSVosR0FDNUJNLEVBQVFhLFdDbEJWQyxFQUFOLE1BQ0l0QixjQUVJLEtBQUN1QixnQkFBa0IsSUFHbkIsS0FBQ0MsWUFBYyxHQUdmLEtBQUNDLGlCQUFtQixHQUdwQixLQUFDQyxXQUFhLEdBR2QsS0FBQ0MsS0FBTyxJQUFJeEIsRUFBSSxJQUFJSixHQUFTLEtBQUN5QixhQUFjLElBQUssSUFBSXpCLEVBQVEsS0FBQ3lCLFlBQWEsS0FHM0UsS0FBQ0ksU0FBVyxJQUFJaEIsRUFBSyxJQUFJYixFQUFRLEVBQUcsR0FBSSxJQUFJQSxFQUFRLEVBQUcsTUFHdkQsS0FBQzhCLFlBQWMsSUFBSWpCLEVBQUssSUFBSWIsR0FBUyxLQUFDd0IsaUJBQWtCLEtBQU8sSUFBSXhCLEdBQVMsS0FBQ3dCLGdCQUFpQixNQUc5RixLQUFDTyxhQUFlLElBQUlsQixFQUFLLElBQUliLEVBQVEsS0FBQ3dCLGlCQUFrQixLQUFPLElBQUl4QixFQUFRLEtBQUN3QixnQkFBaUIsTUFDN0YsS0FBQ1EsUUFLTEEsUUFDQSxJQUFKLEUsT0FBUSxLQUFDQyxVQUFXLEVBQ1osS0FBQ0MsTUFBUSxFQUNULEtBQUNDLFNBQVcsRUFDWixLQUFDQyxhQUFjLEVBQ2YsS0FBQ0MsY0FBZSxFQUNoQixLQUFDQyxhQUFlLEVBQ2hCLEtBQUNDLFNBQVcsSUFDWixLQUFDQyxTQUE2QixFQUFqQnhCLEtBQUt5QixTQUFnQixFQUNsQyxLQUFDRCxVQUFELDZCQUE4QixJQUFNLElBQ3BDLEtBQUNFLE1BQVEsRUFNYmxDLEtBQU9DLEcsT0FDSCxLQUFDcUIsWUFBWXRCLEtBQUtDLEdBQ2xCLEtBQUNzQixhQUFhdkIsS0FBS0MsR0FFbkJBLEVBQVFrQyxVQUFVLEtBQUNSLFNBQVUsR0FHN0IxQixFQUFRbUMsWUFBYyxVQUN0Qm5DLEVBQVFFLFVBQVksRUFDcEJGLEVBQVFVLFlBQ1JWLEVBQVFXLE9BQWdDLElBQXpCSixLQUFLNkIsS0FBSyxLQUFDbEIsWUFBNEMsSUFBekJYLEtBQUs4QixLQUFLLEtBQUNuQixhQUN4RGxCLEVBQVFZLE9BQU8sRUFBRyxHQUNsQlosRUFBUVksT0FBK0IsSUFBeEJMLEtBQUs2QixJQUFJLEtBQUNsQixZQUE0QyxJQUF6QlgsS0FBSzhCLElBQUksS0FBQ25CLGFBQ3REbEIsRUFBUWEsU0FFUmIsRUFBUW1DLFlBQWMsVUFDdEJuQyxFQUFRRSxVQUFZLEVBQ3BCLEtBQUNrQixTQUFTZCxJQUFJYixFQUF1QixJQUFuQmMsS0FBSzZCLElBQUksS0FBQ0gsT0FDNUIsS0FBQ2IsU0FBU2QsSUFBSVosRUFBdUIsSUFBbkJhLEtBQUs4QixJQUFJLEtBQUNKLE9BQzVCLEtBQUNiLFNBQVNyQixLQUFLQyxHQUNmLEtBQUNtQixLQUFLcEIsS0FBS0MsR0FNZnNDLFNBRUksSUFBRyxLQUFDZCxTQXdCSixPQXBCRyxLQUFDRyxZQUNBLEtBQUNFLGNBQWdCLEtBQUNaLGlCQUNkLEtBQUNXLGFBQ0wsS0FBQ0MsYUFBZSxLQUFDWixpQkFFakIsS0FBQ1ksYUFBZSxFQUdwQixLQUFDRSxVQUFZLEtBQUNGLGFBQ2QsS0FBQ0UsVUFBWSxLQUFDRCxTQUNkLEtBQUNKLFVBQVksS0FBQ0ssU0FFZCxLQUFDRSxPQUFtQixJQUFULEtBQUNBLE1BQThCLE1BQVosS0FBQ0YsU0FDL0IsS0FBQ04sU0FHRSxLQUFDUSxNQUFRLEtBQUNmLFlBQWMsS0FBQ2UsT0FBUyxLQUFDZixjQUNsQyxLQUFDTSxVQUFXLEdBR2IsS0FBQ0UsU0FBVyxLQUFDVixZQUFjLEtBQUNELGlCQUFtQixLQUFDVyxTQUFXLEtBQUNWLGFBQWUsS0FBQ0QsZ0JBQzNFLEtBQUNTLFVBQVcsT0FEaEIsSUNwR0EsRUFBTixRQUNHLFlBQWMsRUFBSyxHQUNmLEtBQUMsSUFBTSxFQUNQLEtBQUMsS0FBTyxFQVFaLE9BQVMsRyxPQUNMLEtBQUMsTUFBUSxLQUFLLFNBQVcsSUFBTyxFQUNoQyxLQUFDLE9BQVMsS0FBSyxTQUFXLElBQU8sRUFNckMsUUFDSSxPQUFPLElBQUksRUFBaUIsS0FBQyxJQUFLLEtBQUMsUUNwQnRDZSxFQUFOLE1BQU1BLEVBQ0wvQyxjQUNDLEtBQUNnRCxJQUFNLElBQUlDLEVBQWlCLEVBQUcsR0FDL0IsS0FBQ1IsTUFBUSxJQUFJUSxFQUFpQixFQUFHLEdBQ2pDLEtBQUNDLElBQU0sSUFBSUQsRUFBaUIsRUFBRyxHQUMvQixLQUFDRSxFQUFJLEVBT05DLE9BQVNDLEcsT0FDUixLQUFDTCxJQUFJSSxPQUFPQyxHQUNaLEtBQUNaLE1BQU1XLE9BQU9DLEdBQ2QsS0FBQ0gsSUFBSUUsT0FBT0MsR0FFWixLQUFDRixJQUFNcEMsS0FBS3lCLFNBQVcsSUFBT2EsRUFHL0JDLFFBQ0QsTUFPRSxPQVBBQyxFQUFJLElBQUlSLEdBRU5DLElBQU0sS0FBQ0UsSUFBSUksUUFDYkMsRUFBRWQsTUFBUSxLQUFDUyxJQUFJSSxRQUNmQyxFQUFFTCxJQUFNLEtBQUNBLElBQUlJLFFBQ2JDLEVBQUVKLEVBQUksS0FBQ0EsRUFFQUksRUFHUkMsUUFBVTdCLEdBQ1gsUSxPQUFFOEIsRUFBSSxLQUFDVCxJQUFJVSxLQUFPL0IsRUFBS1ksU0FBVyxLQUFDUyxJQUFJVyxJQUlyQzdELEVBSEksS0FBQzJDLE1BQU1pQixLQUFPL0IsRUFBS2MsTUFBUSxLQUFDQSxNQUFNa0IsSUFHMUJGLEdBRlIsS0FBQ1AsSUFBSVEsS0FBTy9CLEVBQUtPLFNBQVcsS0FBQ2dCLElBQUlTLEtBSXJDaEMsRUFBS1EsWUFBY3JDLEVBQVEsS0FBQ3FELEVBQzVCeEIsRUFBS1MsYUFBZXRDLEVBQVEsS0FBQ3FELElDekN6QlMsRUFBTixNQVNrQixtQkFBQ0MsRUFBZUMsRUFBWUMsR0FDMUMsSUFBSixNQU9RLElBUEFELE9BQThCLElBQWRBLEVBQTZCQSxFQUFnQixTQUU3RG5DLEVBQU8sSUFBSUwsRUFFUnlDLElBQ0NDLEVBQU9DLFlBQVlDLFFBRWhCdkMsRUFBS0ssVUFBYUwsRUFBS00sTUFBUTZCLFFBQ2QsSUFBakJELEdBQ0NBLEVBQWNsQyxHQUVsQkEsRUFBS21CLFNBTVQsT0FKR2lCLElBQ0NqRCxFQUFNbUQsWUFBWUMsTUFDbEJDLFFBQVFDLElBQUksNEJBQThCekMsRUFBS00sTUFBUSxrQkFBb0JuQixFQUFNa0QsR0FBUSxNQUV0RnJDLEVBQUtNLE1BU0Qsb0JBQUNvQyxFQUFRQyxFQUFhQyxHQUNyQyxJQUFKLFEsT0FBUTVDLEVBQU8sSUFBSUwsRUFDWGQsRUFBVTZELEVBQU9HLFdBQVcsTUFDNUJDLEVBQVksR0FFWjNCLEVBQVMsVyxZQUNhLElBQWZ3QixHQUNDQSxFQUFZM0MsR0FFaEJBLEVBQUttQixTQUVGbkIsRUFBS0ssZ0JBQ2EsSUFBZHVDLEdBQ0NBLEVBQVc1QyxFQUFNOEMsR0FFbEI5QyxFQUFLTSxNQUFRd0MsSUFDWkEsRUFBWTlDLEVBQUtNLE9BRXJCTixFQUFLSSxTQUdUdkIsRUFBUWtFLE9BQ1JsRSxFQUFRbUUsVUFBVSxFQUFHLEVBQUdOLEVBQU9PLE1BQU9QLEVBQU9RLFFBRzdDckUsRUFBUXNFLEtBQU8sYUFDZnRFLEVBQVF1RSxVQUFZLE9BQ3BCdkUsRUFBUXdFLFNBQVMsV0FBYXJELEVBQUtNLE1BQU8sR0FBSSxJQUM5Q3pCLEVBQVF3RSxTQUFTLFFBQVVQLEVBQVcsR0FBSSxJQUcxQ2pFLEVBQVF5RSxVQUFVLEVBQUcsRUFBRyxHQUFJLEVBQUcsRUFBR1osRUFBT1EsUUFDekNyRSxFQUFRa0MsVUFBVTJCLEVBQU9PLE1BQVEsRUFBR1AsRUFBT1EsT0FBUyxHQUNwRGxELEVBQUtwQixLQUFLQyxHQUVWQSxFQUFRMEUsVUFDUkMsc0JBQXNCckMsU0NyRTVCc0MsRUFBTixNQUFNQSxFQVNZLHNCQUFDQyxFQUFRQyxFQUFZQyxFQUFNQyxHQUM3QyxvQkFnQkUsSUFoQkFILE9BQXNCLElBQVZBLEVBQXlCQSxFQUFZLElBQ2pEQyxPQUE4QixJQUFkQSxFQUE2QkEsRUFBZ0IsSUFDN0RDLE9BQWtCLElBQVJBLEVBQXVCQSxFQUFVLEVBRzNDQyxPQUE4QixJQUFkQSxFQUE2QkEsRUFBZ0IsSUFFN0RyQixRQUFRQyxJQUFJLGlDQUFrQyxDQUFDaUIsT0FBQUEsRUFBUUMsV0FBQUEsRUFBWUMsS0FBQUEsSUFFbkVFLEVBQVksSUFBSTFDLEVBQ2hCMkMsRUFBWU4sRUFBaUJPLFVBQVVGLEVBQVdGLEVBQU1DLEdBS3hEckMsRUFBSSxFQUNFQSxFQUFJa0MsR0FBVixDQVFDLElBUEFsQixRQUFRQyxJQUFJLG9CQUFxQmpCLEVBQUcsVUFBV3VDLEdBRS9DRSxFQUFhLEtBQ2JDLEVBQWEsRUFHYkMsRUFBSSxFQUNFQSxFQUFJUixJQUNUUyxFQUFRTixFQUFVbkMsU0FDWkYsT0FkQyxJQWdCUDRDLEVBQVNaLEVBQWlCTyxVQUFVSSxFQUFPUixFQUFNQyxJQUNyQ0ssSUFDWEQsRUFBYUcsRUFDYkYsRUFBYUcsR0FFZEYsSUFNRCxHQUpHRCxHQUFjSCxJQUNoQkQsRUFBWUcsRUFDWkYsRUFBWUcsR0FFVkgsR0FBYUYsRUFDZixNQUNEckMsSUFHRCxPQURBZ0IsUUFBUUMsSUFBSSxtQ0FBb0NzQixFQUFXLFVBQVdELEdBQy9EQSxFQU9NLG1CQUFDSCxFQUFZQyxFQUFNQyxHQUNsQyxjQWVFLElBZkFGLE9BQThCLElBQWRBLEVBQTZCQSxFQUFnQixJQUM3REMsT0FBa0IsSUFBUkEsRUFBdUJBLEVBQVUsRUFHM0NDLE9BQThCLElBQWRBLEVBQTZCQSxFQUFnQixJQUU3RHJCLFFBQVFDLElBQUksaUNBQWtDLENBQUNrQixXQUFBQSxFQUFZQyxLQUFBQSxJQUUzREUsRUFBWSxLQUNaQyxFQUFZLEVBS1pJLEVBQUksRUFDRUEsRUFBSVIsS0FDVFMsRUFBUSxJQUFJaEQsR0FDTkssT0FORSxJQVFSbkIsRUFBUW1ELEVBQWlCTyxVQUFVSSxFQUFPUixFQUFNQyxJQUNyQ0UsSUFDVkQsRUFBWU0sRUFDWkwsRUFBWXpELEdBRWJrQyxRQUFRQyxJQUFJLGdCQUFpQjBCLEVBQUcsVUFBV0osS0FFeENBLEdBQWFGLEtBR2hCTSxJQUlELE9BRkEzQixRQUFRQyxJQUFJLG1DQUFvQ3NCLEVBQVcsVUFBV0QsR0FFL0RBLEVBUUksaUJBQUNNLEVBQU9SLEVBQU1DLEdBQzNCLFVBRUUsSUFGQXZELEVBQVEsRUFDUmdFLEVBQUksRUFDRUEsRUFBSVYsR0FDVC9CLEVBQVUsU0FBQzdCLEdBQ1ZvRSxFQUFNdkMsUUFBUTdCLElBR2ZNLEdBQVMyQixFQUFPc0MsWUFBWTFDLEVBQVNnQyxHQUNyQ1MsSUFFRCxPQUFPaEUsRUFBUXNELElDdkhYWSxFQUFOLE1BS2EsaUJBQUNDLEVBQU1DLEdBQ3BCLFFBQW9CLGlCQUFSRCxJQUNUQSxFQUFPRSxLQUFLQyxVQUFVSCxFQUFNLEtBQU0sT0FFbkNJLEVBQU8sSUFBSUMsS0FBSyxDQUFDTCxHQUFPLENBQUNNLEtBQU0sa0JBRS9CQyxFQUFXQyxTQUFTQyxjQUFjLE1BQ3pCRixTQUFXTixFQUNwQk0sRUFBU0csS0FBT0MsT0FBT0MsSUFBSUMsZ0JBQWdCVCxHQUMzQ0csRUFBU08sTUFBTUMsUUFBVSxPQUV6QlIsRUFBU1MsUUFBVSxXQUNsQlIsU0FBU1MsS0FBS0MsWUFBWUMsT0FHM0JYLFNBQVNTLEtBQUtHLFlBQVliLEdBRTFCQSxFQUFTYyxRQUtDLGdCQUFDQyxHQUNiLE0sT0FBRUMsRUFBVWYsU0FBU0MsY0FBYyxVQUN6QkgsS0FBTyxPQUNmaUIsRUFBUVQsTUFBTUMsUUFBVSxPQUN4QlAsU0FBU1MsS0FBS0csWUFBWUcsR0FFMUJBLEVBQVFDLFNBQVcsV0FDckIsUUFDRyxHQUFtQixLQURuQkMsRUFBUUYsRUFBUUUsT0FDUEMsTyxPQUdUQyxFQUFTLElBQUlDLFlBQ05DLE9BQVMsV0FDbkIsTSxPQUFJQyxFQUFPSCxFQUFPSSxPQUNkVCxFQUFPUSxJQUVSSCxFQUFPSyxXQUFXUCxFQUFNLElBQ3hCakIsU0FBU1MsS0FBS0MsWUFBWUssSUFFM0JBLEVBQVFGLFUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9DUC93ZWJwYWNrL3VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24iLCJ3ZWJwYWNrOi8vQ1Avd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vQ1AvLi9zb3VyY2UvVmVjdG9yMi5jb2ZmZWUiLCJ3ZWJwYWNrOi8vQ1AvLi9zb3VyY2UvQm94LmNvZmZlZSIsIndlYnBhY2s6Ly9DUC8uL3NvdXJjZS9MaW5lLmNvZmZlZSIsIndlYnBhY2s6Ly9DUC8uL3NvdXJjZS9DYXJ0LmNvZmZlZSIsIndlYnBhY2s6Ly9DUC8uL3NvdXJjZS9MaW5lYXJSZWdyZXNzaW9uLmNvZmZlZSIsIndlYnBhY2s6Ly9DUC8uL3NvdXJjZS9MaW5lYXJNb2RlbC5jb2ZmZWUiLCJ3ZWJwYWNrOi8vQ1AvLi9zb3VyY2UvUnVubmVyLmNvZmZlZSIsIndlYnBhY2s6Ly9DUC8uL3NvdXJjZS9MaW5lYXJNb2RlbFRyYWluLmNvZmZlZSIsIndlYnBhY2s6Ly9DUC8uL3NvdXJjZS9VdGlscy5jb2ZmZWUiLCJ3ZWJwYWNrOi8vQ1Avd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL0NQL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vQ1Avd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCJdLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJDUFwiXSA9IGZhY3RvcnkoKTtcblx0ZWxzZVxuXHRcdHJvb3RbXCJDUFwiXSA9IGZhY3RvcnkoKTtcbn0pKHNlbGYsIGZ1bmN0aW9uKCkge1xucmV0dXJuICIsIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCJjbGFzcyBWZWN0b3IyXHJcbiAgICAjIDJEIFZlY3RvciBvYmplY3QgcmVwcmVzZW50ZWQgYnkgeCBhbmQgeSBjb29yZGluYXRlcy5cclxuICAgICMgXHJcbiAgICAjIEBwYXJhbSBbbnVtYmVyXSB4IFxyXG4gICAgIyBAcGFyYW0gW251bWJlcl0geSBcclxuICAgIGNvbnN0cnVjdG9yOiAoeCwgeSkgLT4gXHJcbiAgICAgICAgQHggPSB4XHJcbiAgICAgICAgQHkgPSB5XHJcblxyXG5leHBvcnQge1ZlY3RvcjJ9IiwiaW1wb3J0IHtWZWN0b3IyfSBmcm9tIFwiLi9WZWN0b3IyXCJcclxuXHJcblxyXG4jIEJveCBpcyByZXByZXNlbnRlZCBmcm9tIGEgbWluaW11bSBhbmQgYSBtYXhpbXVtIHBvaW50cy5cclxuY2xhc3MgQm94XHJcbiAgICAjIEBwYXJhbSBbVmVjdG9yMl0gbWluIFxyXG4gICAgIyBAcGFyYW0gW1ZlY3RvcjJdIG1heCBcclxuICAgIGNvbnN0cnVjdG9yOiAobWluLCBtYXgpIC0+XHJcbiAgICAgICAgQG1pbiA9IG1pblxyXG4gICAgICAgIEBtYXggPSBtYXhcclxuXHJcbiAgICAjIEdldCB0aGUgc2l6ZSBvZiB0aGUgYm94IGluIGEgVmVjdG9yLlxyXG4gICAgIyBcclxuICAgICMgQHJldHVybnMgW1ZlY3RvcjJdIFNpemUgb2YgdGhlIGJveC4gXHJcbiAgICBnZXRTaXplOiAoKSAtPlxyXG4gICAgICAgIHJldHVybiBuZXcgVmVjdG9yMihAbWF4LnggLSBAbWluLngsIEBtYXgueSAtIEBtaW4ueSlcclxuXHJcbiAgICAjIERyYXcgdGhlIGJveCBpbnRvIGEgY29udGV4dCBmb3IgdmlzdWFsaXphdGlvbi5cclxuICAgICMgXHJcbiAgICAjIEBwYXJhbSBbQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEXSBjb250ZXh0IFxyXG4gICAgZHJhdzogKGNvbnRleHQpIC0+XHJcbiAgICAgICAgc2l6ZSA9IEBnZXRTaXplKClcclxuICAgICAgICBjb250ZXh0LmxpbmVXaWR0aCA9IDNcclxuICAgICAgICBjb250ZXh0LnN0cm9rZVJlY3QoQG1pbi54LCBAbWluLnksIHNpemUueCwgc2l6ZS55KVxyXG5cclxuZXhwb3J0IHtCb3h9IiwiaW1wb3J0IHtWZWN0b3IyfSBmcm9tIFwiLi9WZWN0b3IyXCJcclxuXHJcbiMgTGluZSBiZXR3ZWVuIHR3byBwb2ludHMgKG9yaWdpbiB0byBlbmQpLlxyXG4jXHJcbiMgQHBhcmFtIFtWZWN0b3IyXSBvcmlnaW4gXHJcbiMgQHBhcmFtIFtWZWN0b3IyXSBlbmRcclxuY2xhc3MgTGluZVxyXG4gICAgY29uc3RydWN0b3I6IChvcmlnaW4sIGVuZCkgLT5cclxuICAgICAgICBAb3JpZ2luID0gb3JpZ2luXHJcbiAgICAgICAgQGVuZCA9IGVuZFxyXG4gICAgXHJcbiAgICAjIENhbGN1bGF0ZSB0aGUgZGlzdGFuY2UgYmV0d2VlbiB0aGUgb3JpZ2luIGFuZCBlbmQgcG9pbnRzLlxyXG4gICAgIyBcclxuICAgICMgQHJldHVybnMge251bWJlcn0gU2l6ZSBvZiB0aGUgbGluZS5cclxuICAgIHNpemU6ICgpIC0+XHJcbiAgICAgICAgcmV0dXJuIE1hdGguc3FydChNYXRoLnBvdyhAb3JpZ2luLnggLSBAZW5kLngsIDIpICsgTWF0aC5wb3coQG9yaWdpbi55IC0gQGVuZC55LCAyKSlcclxuXHJcbiAgICAjIERyYXcgdGhlIGxpbmUgaW50byBhIGNhbnZhcyAyRCBjb250ZXh0LlxyXG4gICAgIyBcclxuICAgICMgQHBhcmFtIFtDYW52YXNSZW5kZXJpbmdDb250ZXh0MkRdIGNvbnRleHQgXHJcbiAgICBkcmF3OiAoY29udGV4dCkgLT5cclxuICAgICAgICBjb250ZXh0LmxpbmVXaWR0aCA9IDNcclxuICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpXHJcbiAgICAgICAgY29udGV4dC5tb3ZlVG8oQG9yaWdpbi54LCBAb3JpZ2luLnkpXHJcbiAgICAgICAgY29udGV4dC5saW5lVG8oQGVuZC54LCBAZW5kLnkpXHJcbiAgICAgICAgY29udGV4dC5zdHJva2UoKVxyXG5cclxuXHJcbmV4cG9ydCB7TGluZX0iLCJpbXBvcnQge1ZlY3RvcjJ9IGZyb20gXCIuL1ZlY3RvcjJcIlxyXG5pbXBvcnQge0xpbmV9IGZyb20gXCIuL0xpbmVcIlxyXG5pbXBvcnQge0JveH0gZnJvbSBcIi4vQm94XCJcclxuXHJcbiMgQ2FydCBvYmplY3QsIHRoYXQgY29udGFpbnMgdGhlIGVudGlyZSBsb2dpYyBmb3IgdGhlIHNpbXVsYXRpb24uXHJcbiMgXHJcbiMgVGhlIGNhcnQgY2FuIGJlIGNvbmZpZ3VyZWRcclxuY2xhc3MgQ2FydFxyXG4gICAgY29uc3RydWN0b3I6ICgpIC0+XHJcbiAgICAgICAgIyBEaXN0YW5jZSBvZiB0aGUgYmFycmllcnMgcmVsYXRpdmUgdG8gdGhlIGNlbnRlci5cclxuICAgICAgICBAYmFycmllckRpc3RhbmNlID0gNDAwXHJcblxyXG4gICAgICAgICMgSGFsZiB0aGUgc2l6ZSBvZiB0aGUgY2FydCBib3guXHJcbiAgICAgICAgQGJveEhhbGZTaXplID0gNTBcclxuXHJcbiAgICAgICAgIyBBY2NlbGVyYXRpb24gdXNlZCBmb3IgbW92ZW1lbnQgb2YgdGhlIGNhcnQgb24ga2V5IHByZXNzLlxyXG4gICAgICAgIEBtb3ZlQWNjZWxlcmF0aW9uID0gMC4yXHJcblxyXG4gICAgICAgICMgTGltaXQgYW5nbGUgdGhhdCB0aGUgcGVuZHVsdW0gY2FuIHJlYWNoLlxyXG4gICAgICAgIEBsaW1pdEFuZ2xlID0gMC43XHJcblxyXG4gICAgICAgICMgQm94IHRoYXQgcmVwcmVzZW50cyB0aGUgY2FydC5cclxuICAgICAgICBAY2FydCA9IG5ldyBCb3gobmV3IFZlY3RvcjIoLUBib3hIYWxmU2l6ZSwgLTMwKSwgbmV3IFZlY3RvcjIoQGJveEhhbGZTaXplLCAzMCkpXHJcblxyXG4gICAgICAgICMgTGluZSB0byByZXByZXNlbnQgdGhlIHBlbmR1bHVtXHJcbiAgICAgICAgQHBlbmR1bHVtID0gbmV3IExpbmUobmV3IFZlY3RvcjIoMCwgMCksIG5ldyBWZWN0b3IyKDAsIDEwMCkpXHJcbiAgICAgICAgXHJcbiAgICAgICAgIyBMZWZ0IGJhcnJpZXIgbGltaXQuXHJcbiAgICAgICAgQGJhcnJpZXJMZWZ0ID0gbmV3IExpbmUobmV3IFZlY3RvcjIoLUBiYXJyaWVyRGlzdGFuY2UsIC0xMDAwKSwgbmV3IFZlY3RvcjIoLUBiYXJyaWVyRGlzdGFuY2UsIDEwMDApKVxyXG4gICAgICAgIFxyXG4gICAgICAgICMgUmlnaHQgYmFycmllciBsaW1pdC5cclxuICAgICAgICBAYmFycmllclJpZ2h0ID0gbmV3IExpbmUobmV3IFZlY3RvcjIoQGJhcnJpZXJEaXN0YW5jZSwgLTEwMDApLCBuZXcgVmVjdG9yMihAYmFycmllckRpc3RhbmNlLCAxMDAwKSlcclxuICAgICAgICBAcmVzZXQoKVxyXG5cclxuICAgICMgUmVzZXQgdGhlIHNpbXVsYXRpb24gcGFyYW1ldGVycyBiYWNrIHRvIGEgaW5pdGlhbCBzdGF0ZS5cclxuICAgICMgXHJcbiAgICAjIFRoZSBpbml0aWFsIHZlbG9jaXR5IG9mIHRoZSBjYXJ0IGlzIHJhbmRvbWl6ZWQuXHJcbiAgICByZXNldDogKCkgLT5cclxuICAgICAgICBAZ2FtZU92ZXIgPSBmYWxzZVxyXG4gICAgICAgIEBzY29yZSA9IDBcclxuICAgICAgICBAcG9zaXRpb24gPSAwXHJcbiAgICAgICAgQGxlZnRQcmVzc2VkID0gZmFsc2VcclxuICAgICAgICBAcmlnaHRQcmVzc2VkID0gZmFsc2VcclxuICAgICAgICBAYWNjZWxlcmF0aW9uID0gMC4wXHJcbiAgICAgICAgQGZyaWN0aW9uID0gMC45OVxyXG4gICAgICAgIEB2ZWxvY2l0eSA9IChNYXRoLnJhbmRvbSgpICogIDIgLSAxLjApXHJcbiAgICAgICAgQHZlbG9jaXR5ICs9IEB2ZWxvY2l0eSA8IDAgPyAtMC4yIDogMC4yXHJcbiAgICAgICAgQGFuZ2xlID0gMFxyXG5cclxuXHJcbiAgICAjIERyYXcgdGhlIHNpbXVsYXRpb24gdG8gYSBjb250ZXh0IDJEIGZvciB2aXN1YWxpemF0aW9uLlxyXG4gICAgIyBcclxuICAgICMgQHBhcmFtIFtDYW52YXNSZW5kZXJpbmdDb250ZXh0MkRdIGNvbnRleHQgXHJcbiAgICBkcmF3OiAoY29udGV4dCkgLT5cclxuICAgICAgICBAYmFycmllckxlZnQuZHJhdyhjb250ZXh0KVxyXG4gICAgICAgIEBiYXJyaWVyUmlnaHQuZHJhdyhjb250ZXh0KVxyXG5cclxuICAgICAgICBjb250ZXh0LnRyYW5zbGF0ZShAcG9zaXRpb24sIDApXHJcblxyXG4gICAgICAgICMgR3VpZGVsaW5lc1xyXG4gICAgICAgIGNvbnRleHQuc3Ryb2tlU3R5bGUgPSBcIiNGRjAwMDBcIlxyXG4gICAgICAgIGNvbnRleHQubGluZVdpZHRoID0gMVxyXG4gICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKClcclxuICAgICAgICBjb250ZXh0Lm1vdmVUbyhNYXRoLnNpbigtQGxpbWl0QW5nbGUpICogMTAwLCBNYXRoLmNvcygtQGxpbWl0QW5nbGUpICogMTAwKVxyXG4gICAgICAgIGNvbnRleHQubGluZVRvKDAsIDApXHJcbiAgICAgICAgY29udGV4dC5saW5lVG8oTWF0aC5zaW4oQGxpbWl0QW5nbGUpICogMTAwLCBNYXRoLmNvcyhAbGltaXRBbmdsZSkgKiAgMTAwKVxyXG4gICAgICAgIGNvbnRleHQuc3Ryb2tlKClcclxuXHJcbiAgICAgICAgY29udGV4dC5zdHJva2VTdHlsZSA9IFwiIzAwMDAwMFwiXHJcbiAgICAgICAgY29udGV4dC5saW5lV2lkdGggPSAzXHJcbiAgICAgICAgQHBlbmR1bHVtLmVuZC54ID0gTWF0aC5zaW4oQGFuZ2xlKSAqIDEwMFxyXG4gICAgICAgIEBwZW5kdWx1bS5lbmQueSA9IE1hdGguY29zKEBhbmdsZSkgKiAxMDBcclxuICAgICAgICBAcGVuZHVsdW0uZHJhdyhjb250ZXh0KVxyXG4gICAgICAgIEBjYXJ0LmRyYXcoY29udGV4dClcclxuXHJcblxyXG4gICAgIyBVcGRhdGUgdGhlIGxvZ2ljIG9mIHRoZSBzaW11bGF0aW9uLlxyXG4gICAgIyBcclxuICAgICMgVGhlIGNhcnQgbW92ZXMgYWNjb3JkaW5nIHRvIGl0cyB2ZWxvY2l0eSwgdGhlIHN0aWNrIGlzIHVzZWQgYmFzZWQgb24gdmVsb2NpdHkgYW5kIGl0cyBjdXJyZW50IGFuZ2xlIChncmF2aXR5KS5cclxuICAgIHVwZGF0ZTogKCkgLT5cclxuICAgICAgICAjIElmIGdhbWUgb3ZlciByZXR1cm5cclxuICAgICAgICBpZiBAZ2FtZU92ZXJcclxuICAgICAgICAgICAgcmV0dXJuXHJcblxyXG4gICAgICAgICMgUHJvY2VzcyBrZXkgcHJlc3Nlc1xyXG4gICAgICAgIGlmIEBsZWZ0UHJlc3NlZFxyXG4gICAgICAgICAgICBAYWNjZWxlcmF0aW9uID0gLUBtb3ZlQWNjZWxlcmF0aW9uXHJcbiAgICAgICAgZWxzZSBpZiBAcmlnaHRQcmVzc2VkXHJcbiAgICAgICAgICAgIEBhY2NlbGVyYXRpb24gPSBAbW92ZUFjY2VsZXJhdGlvblxyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgQGFjY2VsZXJhdGlvbiA9IDAuMFxyXG5cclxuICAgICAgICAjIFVwZGF0ZSBwaHlzaWNzXHJcbiAgICAgICAgQHZlbG9jaXR5ICs9IEBhY2NlbGVyYXRpb25cclxuICAgICAgICBAdmVsb2NpdHkgKj0gQGZyaWN0aW9uXHJcbiAgICAgICAgQHBvc2l0aW9uICs9IEB2ZWxvY2l0eVxyXG5cclxuICAgICAgICBAYW5nbGUgKz0gKEBhbmdsZSAqIDNlLTIpICsgKC1AdmVsb2NpdHkgKiA1ZS0zKVxyXG4gICAgICAgIEBzY29yZSsrXHJcblxyXG4gICAgICAgICMgSWYgdGhlIGFuZ2xlIG9mIHRoZSBwZW5kdWx1bSBkcm9wIGJlbGxvdyB0aGUgbWluaXVtIGVuZCB0aGUgZ2FtZVxyXG4gICAgICAgIGlmIEBhbmdsZSA+IEBsaW1pdEFuZ2xlIG9yIEBhbmdsZSA8IC1AbGltaXRBbmdsZVxyXG4gICAgICAgICAgICBAZ2FtZU92ZXIgPSB0cnVlXHJcblxyXG4gICAgICAgICMgSWYgdGhlIGNhcnQgaGl0cyB0aGUgYmFycmllZCBlbmQgdGhlIGdhbWVcclxuICAgICAgICBpZiBAcG9zaXRpb24gKyBAYm94SGFsZlNpemUgPiBAYmFycmllckRpc3RhbmNlIG9yIEBwb3NpdGlvbiAtIEBib3hIYWxmU2l6ZSA8IC1AYmFycmllckRpc3RhbmNlXHJcbiAgICAgICAgICAgIEBnYW1lT3ZlciA9IHRydWVcclxuXHJcbmV4cG9ydCB7Q2FydH0iLCJcclxuIyBMaW5lYXIgcmVncmVzc2lvbiBpcyByZXByZXNlbnRlZCBieSB0d28gcGFyYW1ldGVyczogdGhlIG9yaWdpbiBhbmQgc2xvcGUgb2YgdGhlIGxpbmUuXHJcbiMgXHJcbiMgQHBhcmFtIFtudW1iZXJdIG9yaSBPcmlnaW4gb2YgdGhlIGxpbmUuXHJcbiMgQHBhcmFtIFtudW1iZXJdIGRlY2wgU2xvcGUgb2YgdGhlIGxpbmUuXHJcbmNsYXNzIExpbmVhclJlZ3Jlc3Npb25cclxuICAgIGNvbnN0cnVjdG9yOiAob3JpLCBkZWNsKSAtPlxyXG4gICAgICAgIEBvcmkgPSBvcmlcclxuICAgICAgICBAZGVjbCA9IGRlY2xcclxuXHJcblxyXG4gICAgIyBKaXR0ZXIgdGhlIHZhbHVlcyBpbiB0aGUgcmVncmVzc2lvbiByYW5kb21seS5cclxuICAgICMgXHJcbiAgICAjIFVzZWZ1bGwgZm9yIHRyYWluaW5nIHB1cnBvc2VzLlxyXG4gICAgIyBcclxuICAgICMgQHBhcmFtIFtudW1iZXJdIHNjYWxlIFNjYWxlIG9mIHRoZSBqaXR0ZXJpbmcuIFxyXG4gICAgaml0dGVyOiAoc2NhbGUpIC0+XHJcbiAgICAgICAgQG9yaSArPSAoTWF0aC5yYW5kb20oKSAtIDAuNSkgKiBzY2FsZVxyXG4gICAgICAgIEBkZWNsICs9IChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIHNjYWxlXHJcblxyXG5cclxuICAgICMgQ3JlYXRlIGEgY29weSBvZiB0aGUgbGluZWFyIHJlZ3Jlc3Npb24gb2JqZWN0LlxyXG4gICAgIyBcclxuICAgICMgQHJldHVybnMgQ2xvbmUgb2YgdGhlIGxpbmVhciByZWdyZXNzaW9uIG9iamVjdC5cclxuICAgIGNsb25lOiAoKSAtPlxyXG4gICAgICAgIHJldHVybiBuZXcgTGluZWFyUmVncmVzc2lvbihAb3JpLCBAZGVjbClcclxuXHJcbmV4cG9ydCB7TGluZWFyUmVncmVzc2lvbn0iLCJpbXBvcnQge0xpbmVhclJlZ3Jlc3Npb259IGZyb20gXCIuL0xpbmVhclJlZ3Jlc3Npb25cIlxyXG5cclxuIyBNb2RlbCB0byBjb250cm9sIHRoZSBjYXJ0LCBpdHMgcGFyYW1ldGVycyBjYW4gYmUgc2V0IGFuZCB1c2VkIHRvIGNvbnRyb2wgdGhlIGNhcnQuXHJcbiMgXHJcbiMgVGhlIG1vZGVsIGlzIGNvbXBvc2VkIG9mIDMgbGluZWFyIHJlZ3Jlc3Npb25zIGZvciB3aWNoIHRoZWlyIHBhcmFtZXRlcnMgY2FuIGJlIHRyYWluZWQgYW5kIHVzZWQgdG8gY29udHJvbCB0aGUgY2FydCBvYmplY3QuXHJcbmNsYXNzIExpbmVhck1vZGVsXHJcblx0Y29uc3RydWN0b3I6ICgpIC0+XHJcblx0XHRAdmVsID0gbmV3IExpbmVhclJlZ3Jlc3Npb24oMCwgMC4wKVxyXG5cdFx0QGFuZ2xlID0gbmV3IExpbmVhclJlZ3Jlc3Npb24oMCwgMC4wKVxyXG5cdFx0QHBvcyA9IG5ldyBMaW5lYXJSZWdyZXNzaW9uKDAsIDAuMClcclxuXHRcdEBlID0gMC4wXHJcblxyXG5cdCMgSml0dGVyIGFsbCB2YWx1ZXMgb2YgdGhlIG1vZGVsXHJcblx0I1xyXG5cdCMgQ2FuIGJlIHVzZWQgZHVyaW5nIHRyYWluaW5nIHRvIHByb2R1Y2UgdmFyaWF0aW9ucyBvZiB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgbW9kZWwuXHJcblx0I1xyXG5cdCMgQHBhcmFtIFtudW1iZXJdIHNjYWxlIFNjYWxlIG9mIHRoZSBqaXR0ZXJpbmcgdGhlIHZhbHVlcyB3aWxsIHZhcmlhdGUgaGFsZiBvZiB0aGUgc2NhbGUgdXAgYW5kIGRvd24uXHJcblx0aml0dGVyOiAoc2NhbGUpIC0+XHJcblx0XHRAdmVsLmppdHRlcihzY2FsZSlcclxuXHRcdEBhbmdsZS5qaXR0ZXIoc2NhbGUpXHJcblx0XHRAcG9zLmppdHRlcihzY2FsZSlcclxuXHJcblx0XHRAZSArPSAoTWF0aC5yYW5kb20oKSAtIDAuNSkgKiBzY2FsZVxyXG5cclxuXHQjIENyZWF0ZSBhIG5ldyBvYmplY3Qgd2l0aCBhIGNvcHkgb2YgdGhlIHZhbHVlcyBzdG9yZWQgaW4gdGhpcyBvbmUuXHJcblx0Y2xvbmU6ICgpIC0+XHJcblx0XHRtID0gbmV3IExpbmVhck1vZGVsKClcclxuXHRcdFxyXG5cdFx0bS52ZWwgPSBAcG9zLmNsb25lKClcclxuXHRcdG0uYW5nbGUgPSBAcG9zLmNsb25lKClcclxuXHRcdG0ucG9zID0gQHBvcy5jbG9uZSgpXHJcblx0XHRtLmUgPSBAZVxyXG5cclxuXHRcdHJldHVybiBtXHJcblxyXG5cdCMgQ29udHJvbCB0aGUgc2ltdWxhdGlvbiB1c2luZyB0aGUgcGFyYW1ldGVycyBzdG9yZWQgaW4gdGhpcyBtb2RlbC5cclxuXHRjb250cm9sOiAoY2FydCkgLT5cclxuXHRcdHYgPSBAdmVsLmRlY2wgKiBjYXJ0LnZlbG9jaXR5ICsgQHZlbC5vcmlcclxuXHRcdGEgPSBAYW5nbGUuZGVjbCAqIGNhcnQuYW5nbGUgKyBAYW5nbGUub3JpXHJcblx0XHRwID0gQHBvcy5kZWNsICogY2FydC5wb3NpdGlvbiArIEBwb3Mub3JpXHJcblxyXG5cdFx0dmFsdWUgPSBhICsgdiArIHBcclxuXHJcblx0XHRjYXJ0LmxlZnRQcmVzc2VkID0gdmFsdWUgPCBAZVxyXG5cdFx0Y2FydC5yaWdodFByZXNzZWQgPSB2YWx1ZSA+IEBlXHJcblxyXG5leHBvcnQge0xpbmVhck1vZGVsfSIsImltcG9ydCB7Q2FydH0gZnJvbSBcIi4vQ2FydFwiXHJcblxyXG4jIE1ldGhvZHMgdG8gcnVuIHRoZSBzaW11bGF0aW9uIGluIGhlYWRsZXNzIG1vZGUgKHRlcm1pbmFsIG9ubHkpLCBvciBhdHRhY2hlZCB0byBhIGNhbnZhcyAoR3JhcGhpY2FsKS5cclxuY2xhc3MgUnVubmVyXHJcbiAgICAjIFJ1biB0aGUgc2ltdWxhdGlvbiBoZWFkbGVzc2x5IChpbiB0ZXJtaW5hbCkuXHJcbiAgICAjIFxyXG4gICAgIyBUaGUgc2ltdWxhdGlvbiBpcyBydW4gdW50aWwgdGhlIHN0aWNrIGlzIGRyb3BwZWQgb2ZmLlxyXG4gICAgIyBcclxuICAgICMgQHBhcmFtIFtGdW5jdGlvbl0gbG9naWNDYWxsYmFjayBDYWxsYmFjayBtZXRob2QgdG8gcHJvY2VzcyB0aGUgY2FydCBsb2dpYy5cclxuICAgICMgQHBhcmFtIFtudW1iZXJdIHBvaW50TGltaXQgSG93IG11Y2ggdGltZSB0byBzaW11bGF0ZSBpbiB0aGUgbGltaXQgKHByZXZlbnQgaW5maW5pdGUgcnVuKS5cclxuICAgICMgQHBhcmFtIFtib29sZWFuXSBsb2dQZXJmb3JtYW5jZSBJZiB0cnVlIGNvbnNvbGUgbG9ncyB3aXRoIHBlcmZvcm1hbmNlIG9mIHRoZSBzaW11bGF0aW9uIGFyZSBwcmludGVkIG91dC5cclxuICAgICMgQHJldHVybnMgUmV0dXJucyB0aGUgYW1tb3VudCBvZiBwb2ludHMgYWNjdW11bGF0ZWQgZHVyaW5nIHRoZSBzaW11bGF0aW9uLlxyXG4gICAgQHJ1bkhlYWRsZXNzOiAobG9naWNDYWxsYmFjaywgcG9pbnRMaW1pdCwgbG9nUGVyZm9ybWFuY2UpIC0+XHJcbiAgICAgICAgcG9pbnRMaW1pdCA9IGlmIHBvaW50TGltaXQgIT0gdW5kZWZpbmVkIHRoZW4gcG9pbnRMaW1pdCBlbHNlIEluZmluaXR5XHJcblxyXG4gICAgICAgIGNhcnQgPSBuZXcgQ2FydCgpXHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgbG9nUGVyZm9ybWFuY2VcclxuICAgICAgICAgICAgdGltZSA9IHBlcmZvcm1hbmNlLm5vdygpXHJcblxyXG4gICAgICAgIHdoaWxlICFjYXJ0LmdhbWVPdmVyIGFuZCBjYXJ0LnNjb3JlIDwgcG9pbnRMaW1pdFxyXG4gICAgICAgICAgICBpZiBsb2dpY0NhbGxiYWNrICE9IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgbG9naWNDYWxsYmFjayhjYXJ0KVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY2FydC51cGRhdGUoKVxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIGxvZ1BlcmZvcm1hbmNlXHJcbiAgICAgICAgICAgIGVuZCA9IHBlcmZvcm1hbmNlLm5vdygpXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiIC0gU2ltdWxhdGlvbiBlbmRlZCB3aXRoIFwiICsgY2FydC5zY29yZSArIFwiIHBvaW50cywgdG9vayBcIiArIChlbmQgLSB0aW1lKSArIFwiLlwiKVxyXG5cclxuICAgICAgICByZXR1cm4gY2FydC5zY29yZVxyXG5cclxuICAgICMgUnVuIHRoZSBzaW11bGF0aW9uIHdpdGggdmlzdWFsaXphdGlvbiwgKGF0dGFjaGVkIHRvIGEgY2FudmFzKS5cclxuICAgICMgXHJcbiAgICAjIFJ1bnMgYXQgcmVhbCB0aW1lIHNwZWVkIGZvciB2aXN1YWxpemF0aW9uIHB1cnBvc2VzLlxyXG4gICAgIyBcclxuICAgICMgQHBhcmFtIFtFbGVtZW50XSBjYW52YXMgQ2FudmFzIGVsZW1lbnQgd2hlcmUgdGhlIGludGVyZmFjZSBpcyBkcmF3bi5cclxuICAgICMgQHBhcmFtIFtGdW5jdGlvbl0gb25JdGVyYXRpb24gTWV0aG9kIGNhbGxlZCBldmVyeSBpdGVyYXRpb24gb2YgdGhlIHNpbXVsYXRpb24gdG8gY29udHJvbCB0aGUgY2FydC5cclxuICAgICMgQHBhcmFtIFtGdW5jdGlvbl0gb25HYW1lT3ZlciBNZXRob2QgY2FsbGVkIHdoZW4gdGhlIHNpbXVsYXRpb24gZW5kcy5cclxuICAgIEBydW5HcmFwaGljYWw6IChjYW52YXMsIG9uSXRlcmF0aW9uLCBvbkdhbWVPdmVyKSAtPlxyXG4gICAgICAgIGNhcnQgPSBuZXcgQ2FydCgpXHJcbiAgICAgICAgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIilcclxuICAgICAgICBtYXhQb2ludHMgPSAwXHJcblxyXG4gICAgICAgIHVwZGF0ZSA9ICgpIC0+XHJcbiAgICAgICAgICAgIGlmIG9uSXRlcmF0aW9uICE9IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgb25JdGVyYXRpb24oY2FydClcclxuXHJcbiAgICAgICAgICAgIGNhcnQudXBkYXRlKClcclxuXHJcbiAgICAgICAgICAgIGlmIGNhcnQuZ2FtZU92ZXJcclxuICAgICAgICAgICAgICAgIGlmIG9uR2FtZU92ZXIgIT0gdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICAgICAgb25HYW1lT3ZlcihjYXJ0LCBtYXhQb2ludHMpXHJcblxyXG4gICAgICAgICAgICAgICAgaWYgY2FydC5zY29yZSA+IG1heFBvaW50cyBcclxuICAgICAgICAgICAgICAgICAgICBtYXhQb2ludHMgPSBjYXJ0LnNjb3JlXHJcblxyXG4gICAgICAgICAgICAgICAgY2FydC5yZXNldCgpXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAjIFJlbmRlclxyXG4gICAgICAgICAgICBjb250ZXh0LnNhdmUoKVxyXG4gICAgICAgICAgICBjb250ZXh0LmNsZWFyUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAjIFRleHQgaW4gdGhlIGNhbnZhc1xyXG4gICAgICAgICAgICBjb250ZXh0LmZvbnQgPSBcIjE1cHggQXJpYWxcIlxyXG4gICAgICAgICAgICBjb250ZXh0LnRleHRBbGlnbiA9IFwibGVmdFwiXHJcbiAgICAgICAgICAgIGNvbnRleHQuZmlsbFRleHQoXCJQb2ludHM6IFwiICsgY2FydC5zY29yZSwgMTAsIDIwKVxyXG4gICAgICAgICAgICBjb250ZXh0LmZpbGxUZXh0KFwiTWF4OiBcIiArIG1heFBvaW50cywgMTAsIDQwKVxyXG5cclxuICAgICAgICAgICAgIyBUcmFuc2Zvcm1cclxuICAgICAgICAgICAgY29udGV4dC50cmFuc2Zvcm0oMSwgMCwgMCwgLTEsIDAsIGNhbnZhcy5oZWlnaHQpXHJcbiAgICAgICAgICAgIGNvbnRleHQudHJhbnNsYXRlKGNhbnZhcy53aWR0aCAvIDIsIGNhbnZhcy5oZWlnaHQgLyAyKVxyXG4gICAgICAgICAgICBjYXJ0LmRyYXcoY29udGV4dClcclxuXHJcbiAgICAgICAgICAgIGNvbnRleHQucmVzdG9yZSgpXHJcbiAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSh1cGRhdGUpXHJcblxyXG4gICAgICAgIHVwZGF0ZSgpXHJcblxyXG5leHBvcnQge1J1bm5lcn1cclxuIiwiaW1wb3J0IHtSdW5uZXJ9IGZyb20gXCIuL1J1bm5lclwiXHJcbmltcG9ydCB7TGluZWFyTW9kZWx9IGZyb20gXCIuL0xpbmVhck1vZGVsXCJcclxuXHJcbiMgTWV0aG9kcyBmb3IgdHJhaW5pbmcgb2YgdGhlIGNhcnQgbW9kZWwuXHJcbiNcclxuIyBUcmFpbmluZyBwcm9kdWNlcyBhIGxpbmVhciBtb2RlbCBvZiB0aGUgY2FydCwgdGhhdCBjYW4gYmUgdXNlZCB0byBjb250cm9sIHRoZSBzaW11bGF0aW9uLlxyXG5jbGFzcyBMaW5lYXJNb2RlbFRyYWluXHJcblx0IyBUcmFpbiB0aGUgbW9kZWwgb2YgdGhlIGNhcnQgaXRlcmF0aXZlbGx5LlxyXG5cdCMgXHJcblx0IyBVc2VzIGEgc2Vhc29uYWwgdHJhaW5pbmcgYXBwcm9hY2ggZm9yIHdpY2ggbWFueSBlcG9jaHMgYXJlIGV4ZWN1dGVkIGFuZCB0aGUgYmVzdCBmcm9tIGVhY2ggZXBvY2ggaXMgc2VsZWN0ZWQgYXMgYmFzZWQgZm9yIHRoZSBuZXh0LlxyXG5cdCMgXHJcblx0IyBAcGFyYW0gW251bWJlcl0gZXBvY2hzIE51bWJlciBvZiBpdGVyYXRpb25zL2Vwb2NocyB0byBzaW11bGF0ZS5cclxuXHQjIEBwYXJhbSBbbnVtYmVyXSBpdGVyYXRpb25zIE51bWJlciBvZiB2YXJpYXRpb25zIHRlc3RlZCBpbiBlYWNoIGVwb2NoLlxyXG5cdCMgQHBhcmFtIFtudW1iZXJdIHJ1bnMgSG93IG1hbnkgdGltZXMgdG8gcnVuIGVhY2ggdmFyaWF0aW9uIHRvIGdldCBhbiBhdmVyYWdlIHBlcmZvcm1hbmNlLlxyXG5cdCMgQHJldHVybnMge0xpbmVhck1vZGVsfSBUcmFpbmVkIG1vZGVsIHRoYXQgY2FuIGJlIHVzZWQgdG8gY29udHJvbCB0aGUgc2ltdWxhdGlvbi5cclxuXHRAdHJhaW5JdGVyYXRpdmU6IChlcG9jaHMsIGl0ZXJhdGlvbnMsIHJ1bnMsIHNjb3JlTGltaXQpIC0+XHJcblx0XHRlcG9jaHMgPSBpZiBlcG9jaHMgIT0gdW5kZWZpbmVkIHRoZW4gZXBvY2hzIGVsc2UgNTAwXHJcblx0XHRpdGVyYXRpb25zID0gaWYgaXRlcmF0aW9ucyAhPSB1bmRlZmluZWQgdGhlbiBpdGVyYXRpb25zIGVsc2UgMTAwXHJcblx0XHRydW5zID0gaWYgcnVucyAhPSB1bmRlZmluZWQgdGhlbiBydW5zIGVsc2UgNVxyXG5cclxuXHRcdCMgSWYgdGhlIG1vZGVsIHJlYWNoZXMgdGhpcyBsZXZlbCBvZiBwZXJmb3JtYW5jZSB0aGUgdHJhaW5pbmcgaXMgc3RvcHBlZC5cclxuXHRcdHNjb3JlTGltaXQgPSBpZiBzY29yZUxpbWl0ICE9IHVuZGVmaW5lZCB0aGVuIHNjb3JlTGltaXQgZWxzZSAyMDAwLjBcclxuXHJcblx0XHRjb25zb2xlLmxvZyhcIiAtIFRyYWluaW5nIHByb2Nlc3Mgc3RhcnRpbmcuIFwiLCB7ZXBvY2hzLCBpdGVyYXRpb25zLCBydW5zfSlcclxuXHJcblx0XHRiZXN0TW9kZWwgPSBuZXcgTGluZWFyTW9kZWwoKVxyXG5cdFx0YmVzdFNjb3JlID0gTGluZWFyTW9kZWxUcmFpbi50ZXN0TW9kZWwoYmVzdE1vZGVsLCBydW5zLCBzY29yZUxpbWl0KVxyXG5cclxuXHRcdGppdHRlciA9IDEuMFxyXG5cdFx0XHJcblx0XHQjIEVwb2NoXHJcblx0XHRlID0gMFxyXG5cdFx0d2hpbGUgZSA8IGVwb2Noc1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcIiAtIFJ1bm5pbmcgZXBvY2ggXCIsIGUsIFwiIHNjb3JlIFwiLCBiZXN0U2NvcmUpXHJcblxyXG5cdFx0XHRlcG9jaE1vZGVsID0gbnVsbFxyXG5cdFx0XHRlcG9jaFNjb3JlID0gMFxyXG5cclxuXHRcdFx0IyBOdW1iZXIgb2YgaXRlcmF0aW9ucyBwZXIgZXBvY2hcclxuXHRcdFx0aSA9IDBcclxuXHRcdFx0d2hpbGUgaSA8IGl0ZXJhdGlvbnNcclxuXHRcdFx0XHRtb2RlbCA9IGJlc3RNb2RlbC5jbG9uZSgpXHJcblx0XHRcdFx0bW9kZWwuaml0dGVyKGppdHRlcilcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRwb2ludHMgPSBMaW5lYXJNb2RlbFRyYWluLnRlc3RNb2RlbChtb2RlbCwgcnVucywgc2NvcmVMaW1pdClcclxuXHRcdFx0XHRpZiBwb2ludHMgPiBlcG9jaFNjb3JlXHJcblx0XHRcdFx0XHRlcG9jaE1vZGVsID0gbW9kZWxcclxuXHRcdFx0XHRcdGVwb2NoU2NvcmUgPSBwb2ludHNcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRpKytcclxuXHJcblx0XHRcdGlmIGVwb2NoU2NvcmUgPj0gYmVzdFNjb3JlXHJcblx0XHRcdFx0YmVzdE1vZGVsID0gZXBvY2hNb2RlbFxyXG5cdFx0XHRcdGJlc3RTY29yZSA9IGVwb2NoU2NvcmVcclxuXHJcblx0XHRcdGlmIGJlc3RTY29yZSA+PSBzY29yZUxpbWl0XHJcblx0XHRcdFx0YnJlYWtcclxuXHRcdFx0ZSsrXHJcblxyXG5cdFx0Y29uc29sZS5sb2coXCIgLSBUcmFpbmluZyBmaW5pc2hlZCB3aXRoIHNjb3JlIFwiLCBiZXN0U2NvcmUsIFwiIG1vZGVsIFwiLCBiZXN0TW9kZWwpXHJcblx0XHRyZXR1cm4gYmVzdE1vZGVsXHJcblxyXG5cdCMgRnVsbHkgcmFuZG9taXplZCB0cmFpbmluZywgdGVzdCBtYW55IHBhcmFtZXRlcnMgYW5kIHNlbGVjdCB0aGUgYmVzdCBmcm9tIGFsbC5cclxuXHQjIFxyXG5cdCMgQHBhcmFtIFtudW1iZXJdIGl0ZXJhdGlvbnMgTnVtYmVyIG9mIHZhcmlhdGlvbnMgdGVzdGVkIGluIGVhY2ggZXBvY2guXHJcblx0IyBAcGFyYW0gW251bWJlcl0gcnVucyBIb3cgbWFueSB0aW1lcyB0byBydW4gZWFjaCB2YXJpYXRpb24gdG8gZ2V0IGFuIGF2ZXJhZ2UgcGVyZm9ybWFuY2UuXHJcblx0IyBAcmV0dXJucyB7TGluZWFyTW9kZWx9IFRyYWluZWQgbW9kZWwgdGhhdCBjYW4gYmUgdXNlZCB0byBjb250cm9sIHRoZSBzaW11bGF0aW9uLlxyXG5cdEB0cmFpblJhbmRvbTogKGl0ZXJhdGlvbnMsIHJ1bnMsIHNjb3JlTGltaXQpIC0+XHJcblx0XHRpdGVyYXRpb25zID0gaWYgaXRlcmF0aW9ucyAhPSB1bmRlZmluZWQgdGhlbiBpdGVyYXRpb25zIGVsc2UgMWU1XHJcblx0XHRydW5zID0gaWYgcnVucyAhPSB1bmRlZmluZWQgdGhlbiBydW5zIGVsc2UgNVxyXG5cclxuXHRcdCMgSWYgdGhlIG1vZGVsIHJlYWNoZXMgdGhpcyBsZXZlbCBvZiBwZXJmb3JtYW5jZSB0aGUgdHJhaW5pbmcgaXMgc3RvcHBlZC5cclxuXHRcdHNjb3JlTGltaXQgPSBpZiBzY29yZUxpbWl0ICE9IHVuZGVmaW5lZCB0aGVuIHNjb3JlTGltaXQgZWxzZSAyMDAwLjBcclxuXHJcblx0XHRjb25zb2xlLmxvZyhcIiAtIFRyYWluaW5nIHByb2Nlc3Mgc3RhcnRpbmcuIFwiLCB7aXRlcmF0aW9ucywgcnVuc30pXHJcblxyXG5cdFx0YmVzdE1vZGVsID0gbnVsbFxyXG5cdFx0YmVzdFNjb3JlID0gMFxyXG5cdFx0XHJcblx0XHRqaXR0ZXIgPSAyLjBcclxuXHJcblx0XHQjIFRlc3RzIHBlciBlcG9jaFxyXG5cdFx0aSA9IDBcclxuXHRcdHdoaWxlIGkgPCBpdGVyYXRpb25zXHJcblx0XHRcdG1vZGVsID0gbmV3IExpbmVhck1vZGVsKClcclxuXHRcdFx0bW9kZWwuaml0dGVyKGppdHRlcilcclxuXHRcdFx0XHJcblx0XHRcdHNjb3JlID0gTGluZWFyTW9kZWxUcmFpbi50ZXN0TW9kZWwobW9kZWwsIHJ1bnMsIHNjb3JlTGltaXQpXHJcblx0XHRcdGlmIHNjb3JlID4gYmVzdFNjb3JlXHJcblx0XHRcdFx0YmVzdE1vZGVsID0gbW9kZWxcclxuXHRcdFx0XHRiZXN0U2NvcmUgPSBzY29yZVxyXG5cclxuXHRcdFx0Y29uc29sZS5sb2coXCIgLSBJdGVyYXRpb24gXCIsIGksIFwiIHNjb3JlIFwiLCBiZXN0U2NvcmUpXHJcblxyXG5cdFx0XHRpZiBiZXN0U2NvcmUgPj0gc2NvcmVMaW1pdFxyXG5cdFx0XHRcdGJyZWFrXHJcblx0XHRcdFxyXG5cdFx0XHRpKytcclxuXHJcblx0XHRjb25zb2xlLmxvZyhcIiAtIFRyYWluaW5nIGZpbmlzaGVkIHdpdGggc2NvcmUgXCIsIGJlc3RTY29yZSwgXCIgbW9kZWwgXCIsIGJlc3RNb2RlbClcclxuXHJcblx0XHRyZXR1cm4gYmVzdE1vZGVsXHJcblxyXG5cdCMgUnVuIHRoZSBtb2RlbCwgbXVsdGlwbGUgdGltZXMgYW5kIGF2ZXJhZ2UgdGhlIHBvbnR1YXRpb24gb2YgdGhlIHJ1bnMuXHJcblx0IyBcclxuXHQjIEBwYXJhbSBbTGluZWFyTW9kZWxdIG1vZGVsIE1vZGVsIHRvIGJlIHRlc3RlZC5cclxuXHQjIEBwYXJhbSBbbnVtYmVyXSBydW5zIE51bWJlciBvZiBpdGVyYXRpb25zIHRvIHRlc3QgdGhlIG1vZGVsLlxyXG5cdCMgQHBhcmFtIFtudW1iZXJdIHNjb3JlTGltaXQgSWYgdGhlIHNjb3JlIG9mIHRoZSBtb2RlbCBnZXRzIGJldHRlciB0aGFuIHRoZSBsaW1pdCB0aGUgc2ltdWxhdGlvbiBzdG9wcy5cclxuXHQjIEByZXR1cm4ge251bWJlcn0gVGhlIGF2ZXJhZ2UgcGVyZm9ybWFuY2Ugc2NvcmUgb2YgdGhlIG1vZGVsLlxyXG5cdEB0ZXN0TW9kZWw6IChtb2RlbCwgcnVucywgc2NvcmVMaW1pdCkgLT5cclxuXHRcdHNjb3JlID0gMFxyXG5cdFx0ciA9IDBcclxuXHRcdHdoaWxlIHIgPCBydW5zXHJcblx0XHRcdGNvbnRyb2wgPSAoY2FydCkgLT5cclxuXHRcdFx0XHRtb2RlbC5jb250cm9sKGNhcnQpXHJcblx0XHRcdFx0cmV0dXJuXHJcblx0XHRcdFx0XHJcblx0XHRcdHNjb3JlICs9IFJ1bm5lci5ydW5IZWFkbGVzcyhjb250cm9sLCBzY29yZUxpbWl0KVxyXG5cdFx0XHRyKytcclxuXHRcdFxyXG5cdFx0cmV0dXJuIHNjb3JlIC8gcnVuc1xyXG5cclxuZXhwb3J0IHtMaW5lYXJNb2RlbFRyYWlufVxyXG4iLCIjIEF1eGlsaWFyIG1ldGhvZHMgZm9yIGZpbGUgbWFuaXB1bGF0aW9uLCBuZXR3b3JraW5nLCBldGNcclxuY2xhc3MgVXRpbHNcclxuXHQjIFdyaXRlIGRhdGEgaW50byBhIGZpbGUuIFVzZWZ1bCB0byBleHBvcnQgSlNPTiBkYXRhLlxyXG5cdCMgXHJcblx0IyBAcGFyYW0gW3N0cmluZyB8IG9iamVjdF0gZGF0YSBEYXRhIHRvIGJlIHdyaXR0ZW4gdG8gZmlsZS4gXHJcblx0IyBAcGFyYW0gW3N0cmluZ10gZm5hbWUgTmFtZSBvZiB0aGUgZmlsZSB0byBiZSB3cml0dGVuLlxyXG5cdEB3cml0ZUZpbGU6IChkYXRhLCBmbmFtZSkgLT5cclxuXHRcdGlmIHR5cGVvZiBkYXRhID09ICdvYmplY3QnXHJcblx0XHRcdGRhdGEgPSBKU09OLnN0cmluZ2lmeShkYXRhLCBudWxsLCAnXFx0JylcclxuXHJcblx0XHRibG9iID0gbmV3IEJsb2IoW2RhdGFdLCB7dHlwZTogJ29jdGV0L3N0cmVhbSd9KVxyXG5cdFx0XHJcblx0XHRkb3dubG9hZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKVxyXG5cdFx0ZG93bmxvYWQuZG93bmxvYWQgPSBmbmFtZVxyXG5cdFx0ZG93bmxvYWQuaHJlZiA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpXHJcblx0XHRkb3dubG9hZC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnXHJcblxyXG5cdFx0ZG93bmxvYWQub25jbGljayA9ICgpIC0+XHJcblx0XHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQodGhpcylcclxuXHRcdFx0cmV0dXJuXHJcblx0XHRcclxuXHRcdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZG93bmxvYWQpXHJcblx0XHRcclxuXHRcdGRvd25sb2FkLmNsaWNrKClcclxuXHRcdHJldHVyblxyXG5cclxuXHJcblx0IyBDaG9vc2UgZmlsZSBhbmQgcmVhZCBkYXRhIGZyb20gaXQuXHJcblx0QHJlYWRGaWxlOiAob25Mb2FkKSAtPlxyXG5cdFx0Y2hvb3NlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKVxyXG5cdFx0Y2hvb3Nlci50eXBlID0gXCJmaWxlXCJcclxuXHRcdGNob29zZXIuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiXHJcblx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGNob29zZXIpXHJcblxyXG5cdFx0Y2hvb3Nlci5vbmNoYW5nZSA9ICgpIC0+XHJcblx0XHRcdGZpbGVzID0gY2hvb3Nlci5maWxlc1xyXG5cdFx0XHRpZiBmaWxlcy5sZW5ndGggPT0gMFxyXG5cdFx0XHRcdHJldHVyblxyXG5cclxuXHRcdFx0cmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKVxyXG5cdFx0XHRyZWFkZXIub25sb2FkID0gKCkgLT5cclxuXHRcdFx0XHR0ZXh0ID0gcmVhZGVyLnJlc3VsdFxyXG5cdFx0XHRcdG9uTG9hZCh0ZXh0KVxyXG5cdFx0XHRcclxuXHRcdFx0cmVhZGVyLnJlYWRBc1RleHQoZmlsZXNbMF0pXHJcblx0XHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoY2hvb3NlcilcclxuXHJcblx0XHRjaG9vc2VyLmNsaWNrKClcclxuXHJcbmV4cG9ydCB7VXRpbHN9IiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyJdLCJuYW1lcyI6WyJyb290IiwiZmFjdG9yeSIsImV4cG9ydHMiLCJtb2R1bGUiLCJkZWZpbmUiLCJhbWQiLCJzZWxmIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJWZWN0b3IyIiwiY29uc3RydWN0b3IiLCJ4IiwieSIsIkJveCIsIm1pbiIsIm1heCIsImdldFNpemUiLCJkcmF3IiwiY29udGV4dCIsInNpemUiLCJsaW5lV2lkdGgiLCJzdHJva2VSZWN0IiwiTGluZSIsIm9yaWdpbiIsImVuZCIsIk1hdGgiLCJzcXJ0IiwicG93IiwiYmVnaW5QYXRoIiwibW92ZVRvIiwibGluZVRvIiwic3Ryb2tlIiwiQ2FydCIsImJhcnJpZXJEaXN0YW5jZSIsImJveEhhbGZTaXplIiwibW92ZUFjY2VsZXJhdGlvbiIsImxpbWl0QW5nbGUiLCJjYXJ0IiwicGVuZHVsdW0iLCJiYXJyaWVyTGVmdCIsImJhcnJpZXJSaWdodCIsInJlc2V0IiwiZ2FtZU92ZXIiLCJzY29yZSIsInBvc2l0aW9uIiwibGVmdFByZXNzZWQiLCJyaWdodFByZXNzZWQiLCJhY2NlbGVyYXRpb24iLCJmcmljdGlvbiIsInZlbG9jaXR5IiwicmFuZG9tIiwiYW5nbGUiLCJ0cmFuc2xhdGUiLCJzdHJva2VTdHlsZSIsInNpbiIsImNvcyIsInVwZGF0ZSIsIkxpbmVhck1vZGVsIiwidmVsIiwiTGluZWFyUmVncmVzc2lvbiIsInBvcyIsImUiLCJqaXR0ZXIiLCJzY2FsZSIsImNsb25lIiwibSIsImNvbnRyb2wiLCJ2IiwiZGVjbCIsIm9yaSIsIlJ1bm5lciIsImxvZ2ljQ2FsbGJhY2siLCJwb2ludExpbWl0IiwibG9nUGVyZm9ybWFuY2UiLCJ0aW1lIiwicGVyZm9ybWFuY2UiLCJub3ciLCJjb25zb2xlIiwibG9nIiwiY2FudmFzIiwib25JdGVyYXRpb24iLCJvbkdhbWVPdmVyIiwiZ2V0Q29udGV4dCIsIm1heFBvaW50cyIsInNhdmUiLCJjbGVhclJlY3QiLCJ3aWR0aCIsImhlaWdodCIsImZvbnQiLCJ0ZXh0QWxpZ24iLCJmaWxsVGV4dCIsInRyYW5zZm9ybSIsInJlc3RvcmUiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJMaW5lYXJNb2RlbFRyYWluIiwiZXBvY2hzIiwiaXRlcmF0aW9ucyIsInJ1bnMiLCJzY29yZUxpbWl0IiwiYmVzdE1vZGVsIiwiYmVzdFNjb3JlIiwidGVzdE1vZGVsIiwiZXBvY2hNb2RlbCIsImVwb2NoU2NvcmUiLCJpIiwibW9kZWwiLCJwb2ludHMiLCJyIiwicnVuSGVhZGxlc3MiLCJVdGlscyIsImRhdGEiLCJmbmFtZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJibG9iIiwiQmxvYiIsInR5cGUiLCJkb3dubG9hZCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImhyZWYiLCJ3aW5kb3ciLCJVUkwiLCJjcmVhdGVPYmplY3RVUkwiLCJzdHlsZSIsImRpc3BsYXkiLCJvbmNsaWNrIiwiYm9keSIsInJlbW92ZUNoaWxkIiwidGhpcyIsImFwcGVuZENoaWxkIiwiY2xpY2siLCJvbkxvYWQiLCJjaG9vc2VyIiwib25jaGFuZ2UiLCJmaWxlcyIsImxlbmd0aCIsInJlYWRlciIsIkZpbGVSZWFkZXIiLCJvbmxvYWQiLCJ0ZXh0IiwicmVzdWx0IiwicmVhZEFzVGV4dCJdLCJzb3VyY2VSb290IjoiIn0=