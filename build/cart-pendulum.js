!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CP=t():e.CP=t()}(self,(function(){return(()=>{"use strict";var e,t,i,r,s,n,o,a,l,h={d:(e,t)=>{for(var i in t)h.o(t,i)&&!h.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},c={};return h.r(c),h.d(c,{Box:()=>t,Cart:()=>r,Line:()=>i,LinearModel:()=>n,LinearRegression:()=>s,Runner:()=>o,Training:()=>a,Utils:()=>l,Vector2:()=>e}),e=class{constructor(e,t){this.x=e,this.y=t}},t=class{constructor(e,t){this.min=e,this.max=t}getSize(){return new e(this.max.x-this.min.x,this.max.y-this.min.y)}draw(e){var t;return t=this.getSize(),e.lineWidth=3,e.strokeRect(this.min.x,this.min.y,t.x,t.y)}},i=class{constructor(e,t){this.origin=e,this.end=t}size(){return Math.sqrt(Math.pow(this.origin.x-this.end.x,2)+Math.pow(this.origin.y-this.end.y,2))}draw(e){return e.lineWidth=3,e.beginPath(),e.moveTo(this.origin.x,this.origin.y),e.lineTo(this.end.x,this.end.y),e.stroke()}},r=class{constructor(){this.barrierDistance=400,this.boxHalfSize=50,this.moveAcceleration=.2,this.limitAngle=.7,this.cart=new t(new e(-this.boxHalfSize,-30),new e(this.boxHalfSize,30)),this.pendulum=new i(new e(0,0),new e(0,100)),this.barrierLeft=new i(new e(-this.barrierDistance,-1e3),new e(-this.barrierDistance,1e3)),this.barrierRight=new i(new e(this.barrierDistance,-1e3),new e(this.barrierDistance,1e3)),this.reset()}reset(){var e;return this.gameOver=!1,this.score=0,this.position=0,this.leftPressed=!1,this.rightPressed=!1,this.acceleration=0,this.friction=.99,this.velocity=2*Math.random()-1,this.velocity+=null!=(e=this.velocity<0)?e:-{.2:.2},this.angle=0}draw(e){return this.barrierLeft.draw(e),this.barrierRight.draw(e),e.translate(this.position,0),e.strokeStyle="#FF0000",e.lineWidth=1,e.beginPath(),e.moveTo(100*Math.sin(-this.limitAngle),100*Math.cos(-this.limitAngle)),e.lineTo(0,0),e.lineTo(100*Math.sin(this.limitAngle),100*Math.cos(this.limitAngle)),e.stroke(),e.strokeStyle="#000000",e.lineWidth=3,this.pendulum.end.x=100*Math.sin(this.angle),this.pendulum.end.y=100*Math.cos(this.angle),this.pendulum.draw(e),this.cart.draw(e)}update(){if(!this.gameOver)return this.leftPressed?this.acceleration=-this.moveAcceleration:this.rightPressed?this.acceleration=this.moveAcceleration:this.acceleration=0,this.velocity+=this.acceleration,this.velocity*=this.friction,this.position+=this.velocity,this.angle+=.03*this.angle+.005*-this.velocity,this.score++,(this.angle>this.limitAngle||this.angle<-this.limitAngle)&&(this.gameOver=!0),this.position+this.boxHalfSize>this.barrierDistance||this.position-this.boxHalfSize<-this.barrierDistance?this.gameOver=!0:void 0}},s=class e{constructor(e,t){this.ori=e,this.decl=t}jitter(e){return this.ori+=(Math.random()-.5)*e,this.decl+=(Math.random()-.5)*e}clone(){return new e(this.ori,this.decl)}},n=class e{constructor(){this.vel=new s(0,0),this.angle=new s(0,0),this.pos=new s(0,0),this.e=0}jitter(e){return this.vel.jitter(e),this.angle.jitter(e),this.pos.jitter(e),this.e+=(Math.random()-.5)*e}clone(){var t;return(t=new e).vel=this.pos.clone(),t.angle=this.pos.clone(),t.pos=this.pos.clone(),t.e=this.e,t}control(e){var t,i;return t=this.vel.decl*e.velocity+this.vel.ori,i=this.angle.decl*e.angle+this.angle.ori+t+(this.pos.decl*e.position+this.pos.ori),e.leftPressed=i<this.e,e.rightPressed=i>this.e}},o=class{static runHeadless(e,t,i){var s,n,o;for(t=void 0!==t?t:Infinity,s=new r,i&&(o=performance.now());!s.gameOver&&s.score<t;)void 0!==e&&e(s),s.update();return i&&(n=performance.now(),console.log(" - Simulation ended with "+s.score+" points, took "+(n-o)+".")),s.score}runGraphical(e,t,i){var s,n,o,a;return s=new r,n=e.getContext("2d"),o=0,(a=function(){return void 0!==t&&t(s),s.update(),s.gameOver&&(void 0!==i&&i(s,o),s.score>o&&(o=s.score),s.reset()),n.save(),n.clearRect(0,0,e.width,e.height),n.font="15px Arial",n.textAlign="left",n.fillText("Points: "+s.score,10,20),n.fillText("Max: "+o,10,40),n.transform(1,0,0,-1,0,e.height),n.translate(e.width/2,e.height/2),s.draw(n),n.restore(),requestAnimationFrame(a)})()}},a=class e{static trainIterative(t,i,r,s){var o,a,l,h,c,d,u,g;for(t=void 0!==t?t:500,i=void 0!==i?i:100,r=void 0!==r?r:5,s=void 0!==s?s:2e3,console.log(" - Training process starting. ",{epochs:t,iterations:i,runs:r}),o=new n,a=e.testModel(o,r,s),l=0;l<t;){for(console.log(" - Running epoch ",l," score ",a),h=null,c=0,d=0;d<i;)(u=o.clone()).jitter(1),(g=e.testModel(u,r,s))>c&&(h=u,c=g),d++;if(c>=a&&(o=h,a=c),a>=s)break;l++}return console.log(" - Training finished with score ",a," model ",o),o}static trainRandom(t,i,r){var s,o,a,l,h;for(t=void 0!==t?t:1e5,i=void 0!==i?i:5,r=void 0!==r?r:2e3,console.log(" - Training process starting. ",{iterations:t,runs:i}),s=null,o=0,a=0;a<t&&((l=new n).jitter(2),(h=e.testModel(l,i,r))>o&&(s=l,o=h),console.log(" - Iteration ",a," score ",o),!(o>=r));)a++;return console.log(" - Training finished with score ",o," model ",s),s}static testModel(e,t,i){var r,s,n;for(n=0,s=0;s<t;)r=function(t){e.control(t)},n+=o.runHeadless(r,i),s++;return n/t}},l=class{static writeFile(e,t){var i,r;"object"==typeof e&&(e=JSON.stringify(e,null,"\t")),i=new Blob([e],{type:"octet/stream"}),(r=document.createElement("a")).download=t,r.href=window.URL.createObjectURL(i),r.style.display="none",r.onclick=function(){document.body.removeChild(this)},document.body.appendChild(r),r.click()}static readFile(e){var t;return(t=document.createElement("input")).type="file",t.style.display="none",document.body.appendChild(t),t.onchange=function(){var i,r;if(0!==(i=t.files).length)return(r=new FileReader).onload=function(){var t;return t=r.result,e(t)},r.readAsText(i[0]),document.body.removeChild(t)},t.click()}},c})()}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q3JCLFFBQ0csR0FBbUIsS0FEbkJDLEVBQVFGLEVBQVFFLE9BQ1BDLE8sT0FHVEMsRUFBUyxJQUFJQyxZQUNOQyxPQUFTLFdBQ25CLE0sT0FBSUMsRUFBT0gsRUFBT0ksT0FDZFQsRUFBT1EsSUFFUkgsRUFBT0ssV0FBV1AsRUFBTSxJQUN4QmpCLFNBQVNTLEtBQUtDLFlBQVlLLElBRTNCQSxFQUFRRixVIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vQ1Avd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovL0NQL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL0NQLy4vc291cmNlL1ZlY3RvcjIuY29mZmVlIiwid2VicGFjazovL0NQLy4vc291cmNlL0JveC5jb2ZmZWUiLCJ3ZWJwYWNrOi8vQ1AvLi9zb3VyY2UvTGluZS5jb2ZmZWUiLCJ3ZWJwYWNrOi8vQ1AvLi9zb3VyY2UvQ2FydC5jb2ZmZWUiLCJ3ZWJwYWNrOi8vQ1AvLi9zb3VyY2UvTGluZWFyUmVncmVzc2lvbi5jb2ZmZWUiLCJ3ZWJwYWNrOi8vQ1AvLi9zb3VyY2UvTGluZWFyTW9kZWwuY29mZmVlIiwid2VicGFjazovL0NQLy4vc291cmNlL1J1bm5lci5jb2ZmZWUiLCJ3ZWJwYWNrOi8vQ1AvLi9zb3VyY2UvVHJhaW5pbmcuY29mZmVlIiwid2VicGFjazovL0NQLy4vc291cmNlL1V0aWxzLmNvZmZlZSIsIndlYnBhY2s6Ly9DUC93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vQ1Avd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9DUC93ZWJwYWNrL3J1bnRpbWUvbWFrZSBuYW1lc3BhY2Ugb2JqZWN0Il0sInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFtdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcIkNQXCJdID0gZmFjdG9yeSgpO1xuXHRlbHNlXG5cdFx0cm9vdFtcIkNQXCJdID0gZmFjdG9yeSgpO1xufSkoc2VsZiwgZnVuY3Rpb24oKSB7XG5yZXR1cm4gIiwiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsImNsYXNzIFZlY3RvcjJcclxuICAgICMgMkQgVmVjdG9yIG9iamVjdCByZXByZXNlbnRlZCBieSB4IGFuZCB5IGNvb3JkaW5hdGVzLlxyXG4gICAgIyBcclxuICAgICMgQHBhcmFtIFtudW1iZXJdIHggXHJcbiAgICAjIEBwYXJhbSBbbnVtYmVyXSB5IFxyXG4gICAgY29uc3RydWN0b3I6ICh4LCB5KSAtPiBcclxuICAgICAgICBAeCA9IHhcclxuICAgICAgICBAeSA9IHlcclxuXHJcbmV4cG9ydCB7VmVjdG9yMn0iLCJpbXBvcnQge1ZlY3RvcjJ9IGZyb20gXCIuL1ZlY3RvcjJcIlxyXG5cclxuXHJcbiMgQm94IGlzIHJlcHJlc2VudGVkIGZyb20gYSBtaW5pbXVtIGFuZCBhIG1heGltdW0gcG9pbnRzLlxyXG5jbGFzcyBCb3hcclxuICAgICMgQHBhcmFtIFtWZWN0b3IyXSBtaW4gXHJcbiAgICAjIEBwYXJhbSBbVmVjdG9yMl0gbWF4IFxyXG4gICAgY29uc3RydWN0b3I6IChtaW4sIG1heCkgLT5cclxuICAgICAgICBAbWluID0gbWluXHJcbiAgICAgICAgQG1heCA9IG1heFxyXG5cclxuICAgICMgR2V0IHRoZSBzaXplIG9mIHRoZSBib3ggaW4gYSBWZWN0b3IuXHJcbiAgICAjIFxyXG4gICAgIyBAcmV0dXJucyBbVmVjdG9yMl0gU2l6ZSBvZiB0aGUgYm94LiBcclxuICAgIGdldFNpemU6ICgpIC0+XHJcbiAgICAgICAgcmV0dXJuIG5ldyBWZWN0b3IyKEBtYXgueCAtIEBtaW4ueCwgQG1heC55IC0gQG1pbi55KVxyXG5cclxuICAgICMgRHJhdyB0aGUgYm94IGludG8gYSBjb250ZXh0IGZvciB2aXN1YWxpemF0aW9uLlxyXG4gICAgIyBcclxuICAgICMgQHBhcmFtIFtDYW52YXNSZW5kZXJpbmdDb250ZXh0MkRdIGNvbnRleHQgXHJcbiAgICBkcmF3OiAoY29udGV4dCkgLT5cclxuICAgICAgICBzaXplID0gQGdldFNpemUoKVxyXG4gICAgICAgIGNvbnRleHQubGluZVdpZHRoID0gM1xyXG4gICAgICAgIGNvbnRleHQuc3Ryb2tlUmVjdChAbWluLngsIEBtaW4ueSwgc2l6ZS54LCBzaXplLnkpXHJcblxyXG5leHBvcnQge0JveH0iLCJpbXBvcnQge1ZlY3RvcjJ9IGZyb20gXCIuL1ZlY3RvcjJcIlxyXG5cclxuIyBMaW5lIGJldHdlZW4gdHdvIHBvaW50cyAob3JpZ2luIHRvIGVuZCkuXHJcbiNcclxuIyBAcGFyYW0gW1ZlY3RvcjJdIG9yaWdpbiBcclxuIyBAcGFyYW0gW1ZlY3RvcjJdIGVuZFxyXG5jbGFzcyBMaW5lXHJcbiAgICBjb25zdHJ1Y3RvcjogKG9yaWdpbiwgZW5kKSAtPlxyXG4gICAgICAgIEBvcmlnaW4gPSBvcmlnaW5cclxuICAgICAgICBAZW5kID0gZW5kXHJcbiAgICBcclxuICAgICMgQ2FsY3VsYXRlIHRoZSBkaXN0YW5jZSBiZXR3ZWVuIHRoZSBvcmlnaW4gYW5kIGVuZCBwb2ludHMuXHJcbiAgICAjIFxyXG4gICAgIyBAcmV0dXJucyB7bnVtYmVyfSBTaXplIG9mIHRoZSBsaW5lLlxyXG4gICAgc2l6ZTogKCkgLT5cclxuICAgICAgICByZXR1cm4gTWF0aC5zcXJ0KE1hdGgucG93KEBvcmlnaW4ueCAtIEBlbmQueCwgMikgKyBNYXRoLnBvdyhAb3JpZ2luLnkgLSBAZW5kLnksIDIpKVxyXG5cclxuICAgICMgRHJhdyB0aGUgbGluZSBpbnRvIGEgY2FudmFzIDJEIGNvbnRleHQuXHJcbiAgICAjIFxyXG4gICAgIyBAcGFyYW0gW0NhbnZhc1JlbmRlcmluZ0NvbnRleHQyRF0gY29udGV4dCBcclxuICAgIGRyYXc6IChjb250ZXh0KSAtPlxyXG4gICAgICAgIGNvbnRleHQubGluZVdpZHRoID0gM1xyXG4gICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKClcclxuICAgICAgICBjb250ZXh0Lm1vdmVUbyhAb3JpZ2luLngsIEBvcmlnaW4ueSlcclxuICAgICAgICBjb250ZXh0LmxpbmVUbyhAZW5kLngsIEBlbmQueSlcclxuICAgICAgICBjb250ZXh0LnN0cm9rZSgpXHJcblxyXG5cclxuZXhwb3J0IHtMaW5lfSIsImltcG9ydCB7VmVjdG9yMn0gZnJvbSBcIi4vVmVjdG9yMlwiXHJcbmltcG9ydCB7TGluZX0gZnJvbSBcIi4vTGluZVwiXHJcbmltcG9ydCB7Qm94fSBmcm9tIFwiLi9Cb3hcIlxyXG5cclxuIyBDYXJ0IG9iamVjdCwgdGhhdCBjb250YWlucyB0aGUgZW50aXJlIGxvZ2ljIGZvciB0aGUgc2ltdWxhdGlvbi5cclxuIyBcclxuIyBUaGUgY2FydCBjYW4gYmUgY29uZmlndXJlZFxyXG5jbGFzcyBDYXJ0XHJcbiAgICBjb25zdHJ1Y3RvcjogKCkgLT5cclxuICAgICAgICAjIERpc3RhbmNlIG9mIHRoZSBiYXJyaWVycyByZWxhdGl2ZSB0byB0aGUgY2VudGVyLlxyXG4gICAgICAgIEBiYXJyaWVyRGlzdGFuY2UgPSA0MDBcclxuXHJcbiAgICAgICAgIyBIYWxmIHRoZSBzaXplIG9mIHRoZSBjYXJ0IGJveC5cclxuICAgICAgICBAYm94SGFsZlNpemUgPSA1MFxyXG5cclxuICAgICAgICAjIEFjY2VsZXJhdGlvbiB1c2VkIGZvciBtb3ZlbWVudCBvZiB0aGUgY2FydCBvbiBrZXkgcHJlc3MuXHJcbiAgICAgICAgQG1vdmVBY2NlbGVyYXRpb24gPSAwLjJcclxuXHJcbiAgICAgICAgIyBMaW1pdCBhbmdsZSB0aGF0IHRoZSBwZW5kdWx1bSBjYW4gcmVhY2guXHJcbiAgICAgICAgQGxpbWl0QW5nbGUgPSAwLjdcclxuXHJcbiAgICAgICAgIyBCb3ggdGhhdCByZXByZXNlbnRzIHRoZSBjYXJ0LlxyXG4gICAgICAgIEBjYXJ0ID0gbmV3IEJveChuZXcgVmVjdG9yMigtQGJveEhhbGZTaXplLCAtMzApLCBuZXcgVmVjdG9yMihAYm94SGFsZlNpemUsIDMwKSlcclxuXHJcbiAgICAgICAgIyBMaW5lIHRvIHJlcHJlc2VudCB0aGUgcGVuZHVsdW1cclxuICAgICAgICBAcGVuZHVsdW0gPSBuZXcgTGluZShuZXcgVmVjdG9yMigwLCAwKSwgbmV3IFZlY3RvcjIoMCwgMTAwKSlcclxuICAgICAgICBcclxuICAgICAgICAjIExlZnQgYmFycmllciBsaW1pdC5cclxuICAgICAgICBAYmFycmllckxlZnQgPSBuZXcgTGluZShuZXcgVmVjdG9yMigtQGJhcnJpZXJEaXN0YW5jZSwgLTEwMDApLCBuZXcgVmVjdG9yMigtQGJhcnJpZXJEaXN0YW5jZSwgMTAwMCkpXHJcbiAgICAgICAgXHJcbiAgICAgICAgIyBSaWdodCBiYXJyaWVyIGxpbWl0LlxyXG4gICAgICAgIEBiYXJyaWVyUmlnaHQgPSBuZXcgTGluZShuZXcgVmVjdG9yMihAYmFycmllckRpc3RhbmNlLCAtMTAwMCksIG5ldyBWZWN0b3IyKEBiYXJyaWVyRGlzdGFuY2UsIDEwMDApKVxyXG4gICAgICAgIEByZXNldCgpXHJcblxyXG4gICAgIyBSZXNldCB0aGUgc2ltdWxhdGlvbiBwYXJhbWV0ZXJzIGJhY2sgdG8gYSBpbml0aWFsIHN0YXRlLlxyXG4gICAgIyBcclxuICAgICMgVGhlIGluaXRpYWwgdmVsb2NpdHkgb2YgdGhlIGNhcnQgaXMgcmFuZG9taXplZC5cclxuICAgIHJlc2V0OiAoKSAtPlxyXG4gICAgICAgIEBnYW1lT3ZlciA9IGZhbHNlXHJcbiAgICAgICAgQHNjb3JlID0gMFxyXG4gICAgICAgIEBwb3NpdGlvbiA9IDBcclxuICAgICAgICBAbGVmdFByZXNzZWQgPSBmYWxzZVxyXG4gICAgICAgIEByaWdodFByZXNzZWQgPSBmYWxzZVxyXG4gICAgICAgIEBhY2NlbGVyYXRpb24gPSAwLjBcclxuICAgICAgICBAZnJpY3Rpb24gPSAwLjk5XHJcbiAgICAgICAgQHZlbG9jaXR5ID0gKE1hdGgucmFuZG9tKCkgKiAgMiAtIDEuMClcclxuICAgICAgICBAdmVsb2NpdHkgKz0gQHZlbG9jaXR5IDwgMCA/IC0wLjIgOiAwLjJcclxuICAgICAgICBAYW5nbGUgPSAwXHJcblxyXG5cclxuICAgICMgRHJhdyB0aGUgc2ltdWxhdGlvbiB0byBhIGNvbnRleHQgMkQgZm9yIHZpc3VhbGl6YXRpb24uXHJcbiAgICAjIFxyXG4gICAgIyBAcGFyYW0gW0NhbnZhc1JlbmRlcmluZ0NvbnRleHQyRF0gY29udGV4dCBcclxuICAgIGRyYXc6IChjb250ZXh0KSAtPlxyXG4gICAgICAgIEBiYXJyaWVyTGVmdC5kcmF3KGNvbnRleHQpXHJcbiAgICAgICAgQGJhcnJpZXJSaWdodC5kcmF3KGNvbnRleHQpXHJcblxyXG4gICAgICAgIGNvbnRleHQudHJhbnNsYXRlKEBwb3NpdGlvbiwgMClcclxuXHJcbiAgICAgICAgIyBHdWlkZWxpbmVzXHJcbiAgICAgICAgY29udGV4dC5zdHJva2VTdHlsZSA9IFwiI0ZGMDAwMFwiXHJcbiAgICAgICAgY29udGV4dC5saW5lV2lkdGggPSAxXHJcbiAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKVxyXG4gICAgICAgIGNvbnRleHQubW92ZVRvKE1hdGguc2luKC1AbGltaXRBbmdsZSkgKiAxMDAsIE1hdGguY29zKC1AbGltaXRBbmdsZSkgKiAxMDApXHJcbiAgICAgICAgY29udGV4dC5saW5lVG8oMCwgMClcclxuICAgICAgICBjb250ZXh0LmxpbmVUbyhNYXRoLnNpbihAbGltaXRBbmdsZSkgKiAxMDAsIE1hdGguY29zKEBsaW1pdEFuZ2xlKSAqICAxMDApXHJcbiAgICAgICAgY29udGV4dC5zdHJva2UoKVxyXG5cclxuICAgICAgICBjb250ZXh0LnN0cm9rZVN0eWxlID0gXCIjMDAwMDAwXCJcclxuICAgICAgICBjb250ZXh0LmxpbmVXaWR0aCA9IDNcclxuICAgICAgICBAcGVuZHVsdW0uZW5kLnggPSBNYXRoLnNpbihAYW5nbGUpICogMTAwXHJcbiAgICAgICAgQHBlbmR1bHVtLmVuZC55ID0gTWF0aC5jb3MoQGFuZ2xlKSAqIDEwMFxyXG4gICAgICAgIEBwZW5kdWx1bS5kcmF3KGNvbnRleHQpXHJcbiAgICAgICAgQGNhcnQuZHJhdyhjb250ZXh0KVxyXG5cclxuXHJcbiAgICAjIFVwZGF0ZSB0aGUgbG9naWMgb2YgdGhlIHNpbXVsYXRpb24uXHJcbiAgICAjIFxyXG4gICAgIyBUaGUgY2FydCBtb3ZlcyBhY2NvcmRpbmcgdG8gaXRzIHZlbG9jaXR5LCB0aGUgc3RpY2sgaXMgdXNlZCBiYXNlZCBvbiB2ZWxvY2l0eSBhbmQgaXRzIGN1cnJlbnQgYW5nbGUgKGdyYXZpdHkpLlxyXG4gICAgdXBkYXRlOiAoKSAtPlxyXG4gICAgICAgICMgSWYgZ2FtZSBvdmVyIHJldHVyblxyXG4gICAgICAgIGlmIEBnYW1lT3ZlclxyXG4gICAgICAgICAgICByZXR1cm5cclxuXHJcbiAgICAgICAgIyBQcm9jZXNzIGtleSBwcmVzc2VzXHJcbiAgICAgICAgaWYgQGxlZnRQcmVzc2VkXHJcbiAgICAgICAgICAgIEBhY2NlbGVyYXRpb24gPSAtQG1vdmVBY2NlbGVyYXRpb25cclxuICAgICAgICBlbHNlIGlmIEByaWdodFByZXNzZWRcclxuICAgICAgICAgICAgQGFjY2VsZXJhdGlvbiA9IEBtb3ZlQWNjZWxlcmF0aW9uXHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICBAYWNjZWxlcmF0aW9uID0gMC4wXHJcblxyXG4gICAgICAgICMgVXBkYXRlIHBoeXNpY3NcclxuICAgICAgICBAdmVsb2NpdHkgKz0gQGFjY2VsZXJhdGlvblxyXG4gICAgICAgIEB2ZWxvY2l0eSAqPSBAZnJpY3Rpb25cclxuICAgICAgICBAcG9zaXRpb24gKz0gQHZlbG9jaXR5XHJcblxyXG4gICAgICAgIEBhbmdsZSArPSAoQGFuZ2xlICogM2UtMikgKyAoLUB2ZWxvY2l0eSAqIDVlLTMpXHJcbiAgICAgICAgQHNjb3JlKytcclxuXHJcbiAgICAgICAgIyBJZiB0aGUgYW5nbGUgb2YgdGhlIHBlbmR1bHVtIGRyb3AgYmVsbG93IHRoZSBtaW5pdW0gZW5kIHRoZSBnYW1lXHJcbiAgICAgICAgaWYgQGFuZ2xlID4gQGxpbWl0QW5nbGUgb3IgQGFuZ2xlIDwgLUBsaW1pdEFuZ2xlXHJcbiAgICAgICAgICAgIEBnYW1lT3ZlciA9IHRydWVcclxuXHJcbiAgICAgICAgIyBJZiB0aGUgY2FydCBoaXRzIHRoZSBiYXJyaWVkIGVuZCB0aGUgZ2FtZVxyXG4gICAgICAgIGlmIEBwb3NpdGlvbiArIEBib3hIYWxmU2l6ZSA+IEBiYXJyaWVyRGlzdGFuY2Ugb3IgQHBvc2l0aW9uIC0gQGJveEhhbGZTaXplIDwgLUBiYXJyaWVyRGlzdGFuY2VcclxuICAgICAgICAgICAgQGdhbWVPdmVyID0gdHJ1ZVxyXG5cclxuZXhwb3J0IHtDYXJ0fSIsIlxyXG4jIExpbmVhciByZWdyZXNzaW9uIGlzIHJlcHJlc2VudGVkIGJ5IHR3byBwYXJhbWV0ZXJzOiB0aGUgb3JpZ2luIGFuZCBzbG9wZSBvZiB0aGUgbGluZS5cclxuIyBcclxuIyBAcGFyYW0gW251bWJlcl0gb3JpIE9yaWdpbiBvZiB0aGUgbGluZS5cclxuIyBAcGFyYW0gW251bWJlcl0gZGVjbCBTbG9wZSBvZiB0aGUgbGluZS5cclxuY2xhc3MgTGluZWFyUmVncmVzc2lvblxyXG4gICAgY29uc3RydWN0b3I6IChvcmksIGRlY2wpIC0+XHJcbiAgICAgICAgQG9yaSA9IG9yaVxyXG4gICAgICAgIEBkZWNsID0gZGVjbFxyXG5cclxuXHJcbiAgICAjIEppdHRlciB0aGUgdmFsdWVzIGluIHRoZSByZWdyZXNzaW9uIHJhbmRvbWx5LlxyXG4gICAgIyBcclxuICAgICMgVXNlZnVsbCBmb3IgdHJhaW5pbmcgcHVycG9zZXMuXHJcbiAgICAjIFxyXG4gICAgIyBAcGFyYW0gW251bWJlcl0gc2NhbGUgU2NhbGUgb2YgdGhlIGppdHRlcmluZy4gXHJcbiAgICBqaXR0ZXI6IChzY2FsZSkgLT5cclxuICAgICAgICBAb3JpICs9IChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIHNjYWxlXHJcbiAgICAgICAgQGRlY2wgKz0gKE1hdGgucmFuZG9tKCkgLSAwLjUpICogc2NhbGVcclxuXHJcblxyXG4gICAgIyBDcmVhdGUgYSBjb3B5IG9mIHRoZSBsaW5lYXIgcmVncmVzc2lvbiBvYmplY3QuXHJcbiAgICAjIFxyXG4gICAgIyBAcmV0dXJucyBDbG9uZSBvZiB0aGUgbGluZWFyIHJlZ3Jlc3Npb24gb2JqZWN0LlxyXG4gICAgY2xvbmU6ICgpIC0+XHJcbiAgICAgICAgcmV0dXJuIG5ldyBMaW5lYXJSZWdyZXNzaW9uKEBvcmksIEBkZWNsKVxyXG5cclxuZXhwb3J0IHtMaW5lYXJSZWdyZXNzaW9ufSIsImltcG9ydCB7TGluZWFyUmVncmVzc2lvbn0gZnJvbSBcIi4vTGluZWFyUmVncmVzc2lvblwiXHJcblxyXG4jIE1vZGVsIHRvIGNvbnRyb2wgdGhlIGNhcnQsIGl0cyBwYXJhbWV0ZXJzIGNhbiBiZSBzZXQgYW5kIHVzZWQgdG8gY29udHJvbCB0aGUgY2FydC5cclxuIyBcclxuIyBUaGUgbW9kZWwgaXMgY29tcG9zZWQgb2YgMyBsaW5lYXIgcmVncmVzc2lvbnMgZm9yIHdpY2ggdGhlaXIgcGFyYW1ldGVycyBjYW4gYmUgdHJhaW5lZCBhbmQgdXNlZCB0byBjb250cm9sIHRoZSBjYXJ0IG9iamVjdC5cclxuY2xhc3MgTGluZWFyTW9kZWxcclxuXHRjb25zdHJ1Y3RvcjogKCkgLT5cclxuXHRcdEB2ZWwgPSBuZXcgTGluZWFyUmVncmVzc2lvbigwLCAwLjApXHJcblx0XHRAYW5nbGUgPSBuZXcgTGluZWFyUmVncmVzc2lvbigwLCAwLjApXHJcblx0XHRAcG9zID0gbmV3IExpbmVhclJlZ3Jlc3Npb24oMCwgMC4wKVxyXG5cdFx0QGUgPSAwLjBcclxuXHJcblx0IyBKaXR0ZXIgYWxsIHZhbHVlcyBvZiB0aGUgbW9kZWxcclxuXHQjXHJcblx0IyBDYW4gYmUgdXNlZCBkdXJpbmcgdHJhaW5pbmcgdG8gcHJvZHVjZSB2YXJpYXRpb25zIG9mIHRoZSBjdXJyZW50IHN0YXRlIG9mIHRoZSBtb2RlbC5cclxuXHQjXHJcblx0IyBAcGFyYW0gW251bWJlcl0gc2NhbGUgU2NhbGUgb2YgdGhlIGppdHRlcmluZyB0aGUgdmFsdWVzIHdpbGwgdmFyaWF0ZSBoYWxmIG9mIHRoZSBzY2FsZSB1cCBhbmQgZG93bi5cclxuXHRqaXR0ZXI6IChzY2FsZSkgLT5cclxuXHRcdEB2ZWwuaml0dGVyKHNjYWxlKVxyXG5cdFx0QGFuZ2xlLmppdHRlcihzY2FsZSlcclxuXHRcdEBwb3Muaml0dGVyKHNjYWxlKVxyXG5cclxuXHRcdEBlICs9IChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIHNjYWxlXHJcblxyXG5cdCMgQ3JlYXRlIGEgbmV3IG9iamVjdCB3aXRoIGEgY29weSBvZiB0aGUgdmFsdWVzIHN0b3JlZCBpbiB0aGlzIG9uZS5cclxuXHRjbG9uZTogKCkgLT5cclxuXHRcdG0gPSBuZXcgTGluZWFyTW9kZWwoKVxyXG5cdFx0XHJcblx0XHRtLnZlbCA9IEBwb3MuY2xvbmUoKVxyXG5cdFx0bS5hbmdsZSA9IEBwb3MuY2xvbmUoKVxyXG5cdFx0bS5wb3MgPSBAcG9zLmNsb25lKClcclxuXHRcdG0uZSA9IEBlXHJcblxyXG5cdFx0cmV0dXJuIG1cclxuXHJcblx0IyBDb250cm9sIHRoZSBzaW11bGF0aW9uIHVzaW5nIHRoZSBwYXJhbWV0ZXJzIHN0b3JlZCBpbiB0aGlzIG1vZGVsLlxyXG5cdGNvbnRyb2w6IChjYXJ0KSAtPlxyXG5cdFx0diA9IEB2ZWwuZGVjbCAqIGNhcnQudmVsb2NpdHkgKyBAdmVsLm9yaVxyXG5cdFx0YSA9IEBhbmdsZS5kZWNsICogY2FydC5hbmdsZSArIEBhbmdsZS5vcmlcclxuXHRcdHAgPSBAcG9zLmRlY2wgKiBjYXJ0LnBvc2l0aW9uICsgQHBvcy5vcmlcclxuXHJcblx0XHR2YWx1ZSA9IGEgKyB2ICsgcFxyXG5cclxuXHRcdGNhcnQubGVmdFByZXNzZWQgPSB2YWx1ZSA8IEBlXHJcblx0XHRjYXJ0LnJpZ2h0UHJlc3NlZCA9IHZhbHVlID4gQGVcclxuXHJcbmV4cG9ydCB7TGluZWFyTW9kZWx9IiwiaW1wb3J0IHtDYXJ0fSBmcm9tIFwiLi9DYXJ0XCJcclxuXHJcbiMgTWV0aG9kcyB0byBydW4gdGhlIHNpbXVsYXRpb24gaW4gaGVhZGxlc3MgbW9kZSAodGVybWluYWwgb25seSksIG9yIGF0dGFjaGVkIHRvIGEgY2FudmFzIChHcmFwaGljYWwpLlxyXG5jbGFzcyBSdW5uZXJcclxuICAgICMgUnVuIHRoZSBzaW11bGF0aW9uIGhlYWRsZXNzbHkgKGluIHRlcm1pbmFsKS5cclxuICAgICMgXHJcbiAgICAjIFRoZSBzaW11bGF0aW9uIGlzIHJ1biB1bnRpbCB0aGUgc3RpY2sgaXMgZHJvcHBlZCBvZmYuXHJcbiAgICAjIFxyXG4gICAgIyBAcGFyYW0gW0Z1bmN0aW9uXSBsb2dpY0NhbGxiYWNrIENhbGxiYWNrIG1ldGhvZCB0byBwcm9jZXNzIHRoZSBjYXJ0IGxvZ2ljLlxyXG4gICAgIyBAcGFyYW0gW251bWJlcl0gcG9pbnRMaW1pdCBIb3cgbXVjaCB0aW1lIHRvIHNpbXVsYXRlIGluIHRoZSBsaW1pdCAocHJldmVudCBpbmZpbml0ZSBydW4pLlxyXG4gICAgIyBAcGFyYW0gW2Jvb2xlYW5dIGxvZ1BlcmZvcm1hbmNlIElmIHRydWUgY29uc29sZSBsb2dzIHdpdGggcGVyZm9ybWFuY2Ugb2YgdGhlIHNpbXVsYXRpb24gYXJlIHByaW50ZWQgb3V0LlxyXG4gICAgIyBAcmV0dXJucyBSZXR1cm5zIHRoZSBhbW1vdW50IG9mIHBvaW50cyBhY2N1bXVsYXRlZCBkdXJpbmcgdGhlIHNpbXVsYXRpb24uXHJcbiAgICBAcnVuSGVhZGxlc3M6IChsb2dpY0NhbGxiYWNrLCBwb2ludExpbWl0LCBsb2dQZXJmb3JtYW5jZSkgLT5cclxuICAgICAgICBwb2ludExpbWl0ID0gaWYgcG9pbnRMaW1pdCAhPSB1bmRlZmluZWQgdGhlbiBwb2ludExpbWl0IGVsc2UgSW5maW5pdHlcclxuXHJcbiAgICAgICAgY2FydCA9IG5ldyBDYXJ0KClcclxuICAgICAgICBcclxuICAgICAgICBpZiBsb2dQZXJmb3JtYW5jZVxyXG4gICAgICAgICAgICB0aW1lID0gcGVyZm9ybWFuY2Uubm93KClcclxuXHJcbiAgICAgICAgd2hpbGUgIWNhcnQuZ2FtZU92ZXIgYW5kIGNhcnQuc2NvcmUgPCBwb2ludExpbWl0XHJcbiAgICAgICAgICAgIGlmIGxvZ2ljQ2FsbGJhY2sgIT0gdW5kZWZpbmVkXHJcbiAgICAgICAgICAgICAgICBsb2dpY0NhbGxiYWNrKGNhcnQpXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjYXJ0LnVwZGF0ZSgpXHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgbG9nUGVyZm9ybWFuY2VcclxuICAgICAgICAgICAgZW5kID0gcGVyZm9ybWFuY2Uubm93KClcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCIgLSBTaW11bGF0aW9uIGVuZGVkIHdpdGggXCIgKyBjYXJ0LnNjb3JlICsgXCIgcG9pbnRzLCB0b29rIFwiICsgKGVuZCAtIHRpbWUpICsgXCIuXCIpXHJcblxyXG4gICAgICAgIHJldHVybiBjYXJ0LnNjb3JlXHJcblxyXG4gICAgIyBSdW4gdGhlIHNpbXVsYXRpb24gd2l0aCB2aXN1YWxpemF0aW9uLCAoYXR0YWNoZWQgdG8gYSBjYW52YXMpLlxyXG4gICAgIyBcclxuICAgICMgUnVucyBhdCByZWFsIHRpbWUgc3BlZWQgZm9yIHZpc3VhbGl6YXRpb24gcHVycG9zZXMuXHJcbiAgICAjIFxyXG4gICAgIyBAcGFyYW0gW0VsZW1lbnRdIGNhbnZhcyBDYW52YXMgZWxlbWVudCB3aGVyZSB0aGUgaW50ZXJmYWNlIGlzIGRyYXduLlxyXG4gICAgIyBAcGFyYW0gW0Z1bmN0aW9uXSBvbkl0ZXJhdGlvbiBNZXRob2QgY2FsbGVkIGV2ZXJ5IGl0ZXJhdGlvbiBvZiB0aGUgc2ltdWxhdGlvbiB0byBjb250cm9sIHRoZSBjYXJ0LlxyXG4gICAgIyBAcGFyYW0gW0Z1bmN0aW9uXSBvbkdhbWVPdmVyIE1ldGhvZCBjYWxsZWQgd2hlbiB0aGUgc2ltdWxhdGlvbiBlbmRzLlxyXG4gICAgcnVuR3JhcGhpY2FsOiAoY2FudmFzLCBvbkl0ZXJhdGlvbiwgb25HYW1lT3ZlcikgLT5cclxuICAgICAgICBjYXJ0ID0gbmV3IENhcnQoKVxyXG4gICAgICAgIGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpXHJcbiAgICAgICAgbWF4UG9pbnRzID0gMFxyXG5cclxuICAgICAgICB1cGRhdGUgPSAoKSAtPlxyXG4gICAgICAgICAgICBpZiBvbkl0ZXJhdGlvbiAhPSB1bmRlZmluZWRcclxuICAgICAgICAgICAgICAgIG9uSXRlcmF0aW9uKGNhcnQpXHJcblxyXG4gICAgICAgICAgICBjYXJ0LnVwZGF0ZSgpXHJcblxyXG4gICAgICAgICAgICBpZiBjYXJ0LmdhbWVPdmVyXHJcbiAgICAgICAgICAgICAgICBpZiBvbkdhbWVPdmVyICE9IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgICAgIG9uR2FtZU92ZXIoY2FydCwgbWF4UG9pbnRzKVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIGNhcnQuc2NvcmUgPiBtYXhQb2ludHMgXHJcbiAgICAgICAgICAgICAgICAgICAgbWF4UG9pbnRzID0gY2FydC5zY29yZVxyXG5cclxuICAgICAgICAgICAgICAgIGNhcnQucmVzZXQoKVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgIyBSZW5kZXJcclxuICAgICAgICAgICAgY29udGV4dC5zYXZlKClcclxuICAgICAgICAgICAgY29udGV4dC5jbGVhclJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgIyBUZXh0IGluIHRoZSBjYW52YXNcclxuICAgICAgICAgICAgY29udGV4dC5mb250ID0gXCIxNXB4IEFyaWFsXCJcclxuICAgICAgICAgICAgY29udGV4dC50ZXh0QWxpZ24gPSBcImxlZnRcIlxyXG4gICAgICAgICAgICBjb250ZXh0LmZpbGxUZXh0KFwiUG9pbnRzOiBcIiArIGNhcnQuc2NvcmUsIDEwLCAyMClcclxuICAgICAgICAgICAgY29udGV4dC5maWxsVGV4dChcIk1heDogXCIgKyBtYXhQb2ludHMsIDEwLCA0MClcclxuXHJcbiAgICAgICAgICAgICMgVHJhbnNmb3JtXHJcbiAgICAgICAgICAgIGNvbnRleHQudHJhbnNmb3JtKDEsIDAsIDAsIC0xLCAwLCBjYW52YXMuaGVpZ2h0KVxyXG4gICAgICAgICAgICBjb250ZXh0LnRyYW5zbGF0ZShjYW52YXMud2lkdGggLyAyLCBjYW52YXMuaGVpZ2h0IC8gMilcclxuICAgICAgICAgICAgY2FydC5kcmF3KGNvbnRleHQpXHJcblxyXG4gICAgICAgICAgICBjb250ZXh0LnJlc3RvcmUoKVxyXG4gICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodXBkYXRlKVxyXG5cclxuICAgICAgICB1cGRhdGUoKVxyXG5cclxuZXhwb3J0IHtSdW5uZXJ9XHJcbiIsImltcG9ydCB7UnVubmVyfSBmcm9tIFwiLi9SdW5uZXJcIlxyXG5pbXBvcnQge0xpbmVhck1vZGVsfSBmcm9tIFwiLi9MaW5lYXJNb2RlbFwiXHJcblxyXG4jIE1ldGhvZHMgZm9yIHRyYWluaW5nIG9mIHRoZSBjYXJ0IG1vZGVsLlxyXG4jXHJcbiMgVHJhaW5pbmcgcHJvZHVjZXMgYSBsaW5lYXIgbW9kZWwgb2YgdGhlIGNhcnQsIHRoYXQgY2FuIGJlIHVzZWQgdG8gY29udHJvbCB0aGUgc2ltdWxhdGlvbi5cclxuY2xhc3MgVHJhaW5pbmdcclxuXHQjIFRyYWluIHRoZSBtb2RlbCBvZiB0aGUgY2FydCBpdGVyYXRpdmVsbHkuXHJcblx0IyBcclxuXHQjIFVzZXMgYSBzZWFzb25hbCB0cmFpbmluZyBhcHByb2FjaCBmb3Igd2ljaCBtYW55IGVwb2NocyBhcmUgZXhlY3V0ZWQgYW5kIHRoZSBiZXN0IGZyb20gZWFjaCBlcG9jaCBpcyBzZWxlY3RlZCBhcyBiYXNlZCBmb3IgdGhlIG5leHQuXHJcblx0IyBcclxuXHQjIEBwYXJhbSBbbnVtYmVyXSBlcG9jaHMgTnVtYmVyIG9mIGl0ZXJhdGlvbnMvZXBvY2hzIHRvIHNpbXVsYXRlLlxyXG5cdCMgQHBhcmFtIFtudW1iZXJdIGl0ZXJhdGlvbnMgTnVtYmVyIG9mIHZhcmlhdGlvbnMgdGVzdGVkIGluIGVhY2ggZXBvY2guXHJcblx0IyBAcGFyYW0gW251bWJlcl0gcnVucyBIb3cgbWFueSB0aW1lcyB0byBydW4gZWFjaCB2YXJpYXRpb24gdG8gZ2V0IGFuIGF2ZXJhZ2UgcGVyZm9ybWFuY2UuXHJcblx0IyBAcmV0dXJucyB7TGluZWFyTW9kZWx9IFRyYWluZWQgbW9kZWwgdGhhdCBjYW4gYmUgdXNlZCB0byBjb250cm9sIHRoZSBzaW11bGF0aW9uLlxyXG5cdEB0cmFpbkl0ZXJhdGl2ZTogKGVwb2NocywgaXRlcmF0aW9ucywgcnVucywgc2NvcmVMaW1pdCkgLT5cclxuXHRcdGVwb2NocyA9IGlmIGVwb2NocyAhPSB1bmRlZmluZWQgdGhlbiBlcG9jaHMgZWxzZSA1MDBcclxuXHRcdGl0ZXJhdGlvbnMgPSBpZiBpdGVyYXRpb25zICE9IHVuZGVmaW5lZCB0aGVuIGl0ZXJhdGlvbnMgZWxzZSAxMDBcclxuXHRcdHJ1bnMgPSBpZiBydW5zICE9IHVuZGVmaW5lZCB0aGVuIHJ1bnMgZWxzZSA1XHJcblxyXG5cdFx0IyBJZiB0aGUgbW9kZWwgcmVhY2hlcyB0aGlzIGxldmVsIG9mIHBlcmZvcm1hbmNlIHRoZSB0cmFpbmluZyBpcyBzdG9wcGVkLlxyXG5cdFx0c2NvcmVMaW1pdCA9IGlmIHNjb3JlTGltaXQgIT0gdW5kZWZpbmVkIHRoZW4gc2NvcmVMaW1pdCBlbHNlIDIwMDAuMFxyXG5cclxuXHRcdGNvbnNvbGUubG9nKFwiIC0gVHJhaW5pbmcgcHJvY2VzcyBzdGFydGluZy4gXCIsIHtlcG9jaHMsIGl0ZXJhdGlvbnMsIHJ1bnN9KVxyXG5cclxuXHRcdGJlc3RNb2RlbCA9IG5ldyBMaW5lYXJNb2RlbCgpXHJcblx0XHRiZXN0U2NvcmUgPSBUcmFpbmluZy50ZXN0TW9kZWwoYmVzdE1vZGVsLCBydW5zLCBzY29yZUxpbWl0KVxyXG5cclxuXHRcdGppdHRlciA9IDEuMFxyXG5cdFx0XHJcblx0XHQjIEVwb2NoXHJcblx0XHRlID0gMFxyXG5cdFx0d2hpbGUgZSA8IGVwb2Noc1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcIiAtIFJ1bm5pbmcgZXBvY2ggXCIsIGUsIFwiIHNjb3JlIFwiLCBiZXN0U2NvcmUpXHJcblxyXG5cdFx0XHRlcG9jaE1vZGVsID0gbnVsbFxyXG5cdFx0XHRlcG9jaFNjb3JlID0gMFxyXG5cclxuXHRcdFx0IyBOdW1iZXIgb2YgaXRlcmF0aW9ucyBwZXIgZXBvY2hcclxuXHRcdFx0aSA9IDBcclxuXHRcdFx0d2hpbGUgaSA8IGl0ZXJhdGlvbnNcclxuXHRcdFx0XHRtb2RlbCA9IGJlc3RNb2RlbC5jbG9uZSgpXHJcblx0XHRcdFx0bW9kZWwuaml0dGVyKGppdHRlcilcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRwb2ludHMgPSBUcmFpbmluZy50ZXN0TW9kZWwobW9kZWwsIHJ1bnMsIHNjb3JlTGltaXQpXHJcblx0XHRcdFx0aWYgcG9pbnRzID4gZXBvY2hTY29yZVxyXG5cdFx0XHRcdFx0ZXBvY2hNb2RlbCA9IG1vZGVsXHJcblx0XHRcdFx0XHRlcG9jaFNjb3JlID0gcG9pbnRzXHJcblx0XHRcdFx0XHJcblx0XHRcdFx0aSsrXHJcblxyXG5cdFx0XHRpZiBlcG9jaFNjb3JlID49IGJlc3RTY29yZVxyXG5cdFx0XHRcdGJlc3RNb2RlbCA9IGVwb2NoTW9kZWxcclxuXHRcdFx0XHRiZXN0U2NvcmUgPSBlcG9jaFNjb3JlXHJcblxyXG5cdFx0XHRpZiBiZXN0U2NvcmUgPj0gc2NvcmVMaW1pdFxyXG5cdFx0XHRcdGJyZWFrXHJcblx0XHRcdGUrK1xyXG5cclxuXHRcdGNvbnNvbGUubG9nKFwiIC0gVHJhaW5pbmcgZmluaXNoZWQgd2l0aCBzY29yZSBcIiwgYmVzdFNjb3JlLCBcIiBtb2RlbCBcIiwgYmVzdE1vZGVsKVxyXG5cdFx0cmV0dXJuIGJlc3RNb2RlbFxyXG5cclxuXHQjIEZ1bGx5IHJhbmRvbWl6ZWQgdHJhaW5pbmcsIHRlc3QgbWFueSBwYXJhbWV0ZXJzIGFuZCBzZWxlY3QgdGhlIGJlc3QgZnJvbSBhbGwuXHJcblx0IyBcclxuXHQjIEBwYXJhbSBbbnVtYmVyXSBpdGVyYXRpb25zIE51bWJlciBvZiB2YXJpYXRpb25zIHRlc3RlZCBpbiBlYWNoIGVwb2NoLlxyXG5cdCMgQHBhcmFtIFtudW1iZXJdIHJ1bnMgSG93IG1hbnkgdGltZXMgdG8gcnVuIGVhY2ggdmFyaWF0aW9uIHRvIGdldCBhbiBhdmVyYWdlIHBlcmZvcm1hbmNlLlxyXG5cdCMgQHJldHVybnMge0xpbmVhck1vZGVsfSBUcmFpbmVkIG1vZGVsIHRoYXQgY2FuIGJlIHVzZWQgdG8gY29udHJvbCB0aGUgc2ltdWxhdGlvbi5cclxuXHRAdHJhaW5SYW5kb206IChpdGVyYXRpb25zLCBydW5zLCBzY29yZUxpbWl0KSAtPlxyXG5cdFx0aXRlcmF0aW9ucyA9IGlmIGl0ZXJhdGlvbnMgIT0gdW5kZWZpbmVkIHRoZW4gaXRlcmF0aW9ucyBlbHNlIDFlNVxyXG5cdFx0cnVucyA9IGlmIHJ1bnMgIT0gdW5kZWZpbmVkIHRoZW4gcnVucyBlbHNlIDVcclxuXHJcblx0XHQjIElmIHRoZSBtb2RlbCByZWFjaGVzIHRoaXMgbGV2ZWwgb2YgcGVyZm9ybWFuY2UgdGhlIHRyYWluaW5nIGlzIHN0b3BwZWQuXHJcblx0XHRzY29yZUxpbWl0ID0gaWYgc2NvcmVMaW1pdCAhPSB1bmRlZmluZWQgdGhlbiBzY29yZUxpbWl0IGVsc2UgMjAwMC4wXHJcblxyXG5cdFx0Y29uc29sZS5sb2coXCIgLSBUcmFpbmluZyBwcm9jZXNzIHN0YXJ0aW5nLiBcIiwge2l0ZXJhdGlvbnMsIHJ1bnN9KVxyXG5cclxuXHRcdGJlc3RNb2RlbCA9IG51bGxcclxuXHRcdGJlc3RTY29yZSA9IDBcclxuXHRcdFxyXG5cdFx0aml0dGVyID0gMi4wXHJcblxyXG5cdFx0IyBUZXN0cyBwZXIgZXBvY2hcclxuXHRcdGkgPSAwXHJcblx0XHR3aGlsZSBpIDwgaXRlcmF0aW9uc1xyXG5cdFx0XHRtb2RlbCA9IG5ldyBMaW5lYXJNb2RlbCgpXHJcblx0XHRcdG1vZGVsLmppdHRlcihqaXR0ZXIpXHJcblx0XHRcdFxyXG5cdFx0XHRzY29yZSA9IFRyYWluaW5nLnRlc3RNb2RlbChtb2RlbCwgcnVucywgc2NvcmVMaW1pdClcclxuXHRcdFx0aWYgc2NvcmUgPiBiZXN0U2NvcmVcclxuXHRcdFx0XHRiZXN0TW9kZWwgPSBtb2RlbFxyXG5cdFx0XHRcdGJlc3RTY29yZSA9IHNjb3JlXHJcblxyXG5cdFx0XHRjb25zb2xlLmxvZyhcIiAtIEl0ZXJhdGlvbiBcIiwgaSwgXCIgc2NvcmUgXCIsIGJlc3RTY29yZSlcclxuXHJcblx0XHRcdGlmIGJlc3RTY29yZSA+PSBzY29yZUxpbWl0XHJcblx0XHRcdFx0YnJlYWtcclxuXHRcdFx0XHJcblx0XHRcdGkrK1xyXG5cclxuXHRcdGNvbnNvbGUubG9nKFwiIC0gVHJhaW5pbmcgZmluaXNoZWQgd2l0aCBzY29yZSBcIiwgYmVzdFNjb3JlLCBcIiBtb2RlbCBcIiwgYmVzdE1vZGVsKVxyXG5cclxuXHRcdHJldHVybiBiZXN0TW9kZWxcclxuXHJcblx0IyBSdW4gdGhlIG1vZGVsLCBtdWx0aXBsZSB0aW1lcyBhbmQgYXZlcmFnZSB0aGUgcG9udHVhdGlvbiBvZiB0aGUgcnVucy5cclxuXHQjIFxyXG5cdCMgQHBhcmFtIFtMaW5lYXJNb2RlbF0gbW9kZWwgTW9kZWwgdG8gYmUgdGVzdGVkLlxyXG5cdCMgQHBhcmFtIFtudW1iZXJdIHJ1bnMgTnVtYmVyIG9mIGl0ZXJhdGlvbnMgdG8gdGVzdCB0aGUgbW9kZWwuXHJcblx0IyBAcGFyYW0gW251bWJlcl0gc2NvcmVMaW1pdCBJZiB0aGUgc2NvcmUgb2YgdGhlIG1vZGVsIGdldHMgYmV0dGVyIHRoYW4gdGhlIGxpbWl0IHRoZSBzaW11bGF0aW9uIHN0b3BzLlxyXG5cdCMgQHJldHVybiB7bnVtYmVyfSBUaGUgYXZlcmFnZSBwZXJmb3JtYW5jZSBzY29yZSBvZiB0aGUgbW9kZWwuXHJcblx0QHRlc3RNb2RlbDogKG1vZGVsLCBydW5zLCBzY29yZUxpbWl0KSAtPlxyXG5cdFx0c2NvcmUgPSAwXHJcblx0XHRyID0gMFxyXG5cdFx0d2hpbGUgciA8IHJ1bnNcclxuXHRcdFx0Y29udHJvbCA9IChjYXJ0KSAtPlxyXG5cdFx0XHRcdG1vZGVsLmNvbnRyb2woY2FydClcclxuXHRcdFx0XHRyZXR1cm5cclxuXHRcdFx0XHRcclxuXHRcdFx0c2NvcmUgKz0gUnVubmVyLnJ1bkhlYWRsZXNzKGNvbnRyb2wsIHNjb3JlTGltaXQpXHJcblx0XHRcdHIrK1xyXG5cdFx0XHJcblx0XHRyZXR1cm4gc2NvcmUgLyBydW5zXHJcblxyXG5leHBvcnQge1RyYWluaW5nfVxyXG4iLCIjIEF1eGlsaWFyIG1ldGhvZHMgZm9yIGZpbGUgbWFuaXB1bGF0aW9uLCBuZXR3b3JraW5nLCBldGNcclxuY2xhc3MgVXRpbHNcclxuXHQjIFdyaXRlIGRhdGEgaW50byBhIGZpbGUuIFVzZWZ1bCB0byBleHBvcnQgSlNPTiBkYXRhLlxyXG5cdCMgXHJcblx0IyBAcGFyYW0gW3N0cmluZyB8IG9iamVjdF0gZGF0YSBEYXRhIHRvIGJlIHdyaXR0ZW4gdG8gZmlsZS4gXHJcblx0IyBAcGFyYW0gW3N0cmluZ10gZm5hbWUgTmFtZSBvZiB0aGUgZmlsZSB0byBiZSB3cml0dGVuLlxyXG5cdEB3cml0ZUZpbGU6IChkYXRhLCBmbmFtZSkgLT5cclxuXHRcdGlmIHR5cGVvZiBkYXRhID09ICdvYmplY3QnXHJcblx0XHRcdGRhdGEgPSBKU09OLnN0cmluZ2lmeShkYXRhLCBudWxsLCAnXFx0JylcclxuXHJcblx0XHRibG9iID0gbmV3IEJsb2IoW2RhdGFdLCB7dHlwZTogJ29jdGV0L3N0cmVhbSd9KVxyXG5cdFx0XHJcblx0XHRkb3dubG9hZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKVxyXG5cdFx0ZG93bmxvYWQuZG93bmxvYWQgPSBmbmFtZVxyXG5cdFx0ZG93bmxvYWQuaHJlZiA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpXHJcblx0XHRkb3dubG9hZC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnXHJcblxyXG5cdFx0ZG93bmxvYWQub25jbGljayA9ICgpIC0+XHJcblx0XHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQodGhpcylcclxuXHRcdFx0cmV0dXJuXHJcblx0XHRcclxuXHRcdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZG93bmxvYWQpXHJcblx0XHRcclxuXHRcdGRvd25sb2FkLmNsaWNrKClcclxuXHRcdHJldHVyblxyXG5cclxuXHJcblx0IyBDaG9vc2UgZmlsZSBhbmQgcmVhZCBkYXRhIGZyb20gaXQuXHJcblx0QHJlYWRGaWxlOiAob25Mb2FkKSAtPlxyXG5cdFx0Y2hvb3NlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKVxyXG5cdFx0Y2hvb3Nlci50eXBlID0gXCJmaWxlXCJcclxuXHRcdGNob29zZXIuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiXHJcblx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGNob29zZXIpXHJcblxyXG5cdFx0Y2hvb3Nlci5vbmNoYW5nZSA9ICgpIC0+XHJcblx0XHRcdGZpbGVzID0gY2hvb3Nlci5maWxlc1xyXG5cdFx0XHRpZiBmaWxlcy5sZW5ndGggPT0gMFxyXG5cdFx0XHRcdHJldHVyblxyXG5cclxuXHRcdFx0cmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKVxyXG5cdFx0XHRyZWFkZXIub25sb2FkID0gKCkgLT5cclxuXHRcdFx0XHR0ZXh0ID0gcmVhZGVyLnJlc3VsdFxyXG5cdFx0XHRcdG9uTG9hZCh0ZXh0KVxyXG5cdFx0XHRcclxuXHRcdFx0cmVhZGVyLnJlYWRBc1RleHQoZmlsZXNbMF0pXHJcblx0XHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoY2hvb3NlcilcclxuXHJcblx0XHRjaG9vc2VyLmNsaWNrKClcclxuXHJcbmV4cG9ydCB7VXRpbHN9IiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyJdLCJuYW1lcyI6WyJyb290IiwiZmFjdG9yeSIsImV4cG9ydHMiLCJtb2R1bGUiLCJkZWZpbmUiLCJhbWQiLCJzZWxmIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJWZWN0b3IyIiwiY29uc3RydWN0b3IiLCJ4IiwieSIsIkJveCIsIm1pbiIsIm1heCIsImdldFNpemUiLCJkcmF3IiwiY29udGV4dCIsInNpemUiLCJsaW5lV2lkdGgiLCJzdHJva2VSZWN0IiwiTGluZSIsIm9yaWdpbiIsImVuZCIsIk1hdGgiLCJzcXJ0IiwicG93IiwiYmVnaW5QYXRoIiwibW92ZVRvIiwibGluZVRvIiwic3Ryb2tlIiwiQ2FydCIsImJhcnJpZXJEaXN0YW5jZSIsImJveEhhbGZTaXplIiwibW92ZUFjY2VsZXJhdGlvbiIsImxpbWl0QW5nbGUiLCJjYXJ0IiwicGVuZHVsdW0iLCJiYXJyaWVyTGVmdCIsImJhcnJpZXJSaWdodCIsInJlc2V0IiwiZ2FtZU92ZXIiLCJzY29yZSIsInBvc2l0aW9uIiwibGVmdFByZXNzZWQiLCJyaWdodFByZXNzZWQiLCJhY2NlbGVyYXRpb24iLCJmcmljdGlvbiIsInZlbG9jaXR5IiwicmFuZG9tIiwiYW5nbGUiLCJ0cmFuc2xhdGUiLCJzdHJva2VTdHlsZSIsInNpbiIsImNvcyIsInVwZGF0ZSIsIkxpbmVhck1vZGVsIiwidmVsIiwiTGluZWFyUmVncmVzc2lvbiIsInBvcyIsImUiLCJqaXR0ZXIiLCJzY2FsZSIsImNsb25lIiwibSIsImNvbnRyb2wiLCJ2IiwiZGVjbCIsIm9yaSIsIlJ1bm5lciIsImxvZ2ljQ2FsbGJhY2siLCJwb2ludExpbWl0IiwibG9nUGVyZm9ybWFuY2UiLCJ0aW1lIiwicGVyZm9ybWFuY2UiLCJub3ciLCJjb25zb2xlIiwibG9nIiwicnVuR3JhcGhpY2FsIiwiY2FudmFzIiwib25JdGVyYXRpb24iLCJvbkdhbWVPdmVyIiwiZ2V0Q29udGV4dCIsIm1heFBvaW50cyIsInNhdmUiLCJjbGVhclJlY3QiLCJ3aWR0aCIsImhlaWdodCIsImZvbnQiLCJ0ZXh0QWxpZ24iLCJmaWxsVGV4dCIsInRyYW5zZm9ybSIsInJlc3RvcmUiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJUcmFpbmluZyIsImVwb2NocyIsIml0ZXJhdGlvbnMiLCJydW5zIiwic2NvcmVMaW1pdCIsImJlc3RNb2RlbCIsImJlc3RTY29yZSIsInRlc3RNb2RlbCIsImVwb2NoTW9kZWwiLCJlcG9jaFNjb3JlIiwiaSIsIm1vZGVsIiwicG9pbnRzIiwiciIsInJ1bkhlYWRsZXNzIiwiVXRpbHMiLCJkYXRhIiwiZm5hbWUiLCJKU09OIiwic3RyaW5naWZ5IiwiYmxvYiIsIkJsb2IiLCJ0eXBlIiwiZG93bmxvYWQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJocmVmIiwid2luZG93IiwiVVJMIiwiY3JlYXRlT2JqZWN0VVJMIiwic3R5bGUiLCJkaXNwbGF5Iiwib25jbGljayIsImJvZHkiLCJyZW1vdmVDaGlsZCIsInRoaXMiLCJhcHBlbmRDaGlsZCIsImNsaWNrIiwib25Mb2FkIiwiY2hvb3NlciIsIm9uY2hhbmdlIiwiZmlsZXMiLCJsZW5ndGgiLCJyZWFkZXIiLCJGaWxlUmVhZGVyIiwib25sb2FkIiwidGV4dCIsInJlc3VsdCIsInJlYWRBc1RleHQiXSwic291cmNlUm9vdCI6IiJ9