!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CP=t():e.CP=t()}(self,(function(){return(()=>{"use strict";var e,t,i,r,s,n,o,a,l,h={d:(e,t)=>{for(var i in t)h.o(t,i)&&!h.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},c={};return h.r(c),h.d(c,{Box:()=>t,Cart:()=>r,Line:()=>i,LinearModel:()=>n,LinearRegression:()=>s,Runner:()=>o,Training:()=>a,Utils:()=>l,Vector2:()=>e}),e=class{constructor(e,t){this.x=e,this.y=t}},t=class{constructor(e,t){this.min=e,this.max=t}getSize(){return new e(this.max.x-this.min.x,this.max.y-this.min.y)}draw(e){var t;return t=this.getSize(),e.lineWidth=3,e.strokeRect(this.min.x,this.min.y,t.x,t.y)}},i=class{constructor(e,t){this.origin=e,this.end=t}size(){return Math.sqrt(Math.pow(this.origin.x-this.end.x,2)+Math.pow(this.origin.y-this.end.y,2))}draw(e){return e.lineWidth=3,e.beginPath(),e.moveTo(this.origin.x,this.origin.y),e.lineTo(this.end.x,this.end.y),e.stroke()}},r=class{constructor(){this.barrierDistance=400,this.boxHalfSize=50,this.moveAcceleration=.2,this.limitAngle=.7,this.cart=new t(new e(-this.boxHalfSize,-30),new e(this.boxHalfSize,30)),this.pendulum=new i(new e(0,0),new e(0,100)),this.barrierLeft=new i(new e(-this.barrierDistance,-1e3),new e(-this.barrierDistance,1e3)),this.barrierRight=new i(new e(this.barrierDistance,-1e3),new e(this.barrierDistance,1e3)),this.reset()}reset(){var e;return this.gameOver=!1,this.score=0,this.position=0,this.leftPressed=!1,this.rightPressed=!1,this.acceleration=0,this.friction=.99,this.velocity=2*Math.random()-1,this.velocity+=null!=(e=this.velocity<0)?e:-{.2:.2},this.angle=0}draw(e){return this.barrierLeft.draw(e),this.barrierRight.draw(e),e.translate(this.position,0),e.strokeStyle="#FF0000",e.lineWidth=1,e.beginPath(),e.moveTo(100*Math.sin(-this.limitAngle),100*Math.cos(-this.limitAngle)),e.lineTo(0,0),e.lineTo(100*Math.sin(this.limitAngle),100*Math.cos(this.limitAngle)),e.stroke(),e.strokeStyle="#000000",e.lineWidth=3,this.pendulum.end.x=100*Math.sin(this.angle),this.pendulum.end.y=100*Math.cos(this.angle),this.pendulum.draw(e),this.cart.draw(e)}update(){if(!this.gameOver)return this.leftPressed?this.acceleration=-this.moveAcceleration:this.rightPressed?this.acceleration=this.moveAcceleration:this.acceleration=0,this.velocity+=this.acceleration,this.velocity*=this.friction,this.position+=this.velocity,this.angle+=.03*this.angle+.005*-this.velocity,this.score++,(this.angle>this.limitAngle||this.angle<-this.limitAngle)&&(this.gameOver=!0),this.position+this.boxHalfSize>this.barrierDistance||this.position-this.boxHalfSize<-this.barrierDistance?this.gameOver=!0:void 0}},s=class e{constructor(e,t){this.ori=e,this.decl=t}jitter(e){return this.ori+=(Math.random()-.5)*e,this.decl+=(Math.random()-.5)*e}clone(){return new e(this.ori,this.decl)}},n=class e{constructor(){this.vel=new s(0,0),this.angle=new s(0,0),this.pos=new s(0,0),this.e=0}jitter(e){return this.vel.jitter(e),this.angle.jitter(e),this.pos.jitter(e),this.e+=(Math.random()-.5)*e}clone(){var t;return(t=new e).vel=this.pos.clone(),t.angle=this.pos.clone(),t.pos=this.pos.clone(),t.e=this.e,t}control(e){var t,i;return t=this.vel.decl*e.velocity+this.vel.ori,i=this.angle.decl*e.angle+this.angle.ori+t+(this.pos.decl*e.position+this.pos.ori),e.leftPressed=i<this.e,e.rightPressed=i>this.e}},o=class{static runHeadless(e,t,i){var s,n,o;for(t=void 0!==t?t:Infinity,s=new r,i&&(o=performance.now());!s.gameOver&&s.score<t;)void 0!==e&&e(s),s.update();return i&&(n=performance.now(),console.log(" - Simulation ended with "+s.score+" points, took "+(n-o)+".")),s.score}static runGraphical(e,t,i){var s,n,o,a;return s=new r,n=e.getContext("2d"),o=0,(a=function(){return void 0!==t&&t(s),s.update(),s.gameOver&&(void 0!==i&&i(s,o),s.score>o&&(o=s.score),s.reset()),n.save(),n.clearRect(0,0,e.width,e.height),n.font="15px Arial",n.textAlign="left",n.fillText("Points: "+s.score,10,20),n.fillText("Max: "+o,10,40),n.transform(1,0,0,-1,0,e.height),n.translate(e.width/2,e.height/2),s.draw(n),n.restore(),requestAnimationFrame(a)})()}},a=class e{static trainIterative(t,i,r,s){var o,a,l,h,c,d,u,g;for(t=void 0!==t?t:500,i=void 0!==i?i:100,r=void 0!==r?r:5,s=void 0!==s?s:2e3,console.log(" - Training process starting. ",{epochs:t,iterations:i,runs:r}),o=new n,a=e.testModel(o,r,s),l=0;l<t;){for(console.log(" - Running epoch ",l," score ",a),h=null,c=0,d=0;d<i;)(u=o.clone()).jitter(1),(g=e.testModel(u,r,s))>c&&(h=u,c=g),d++;if(c>=a&&(o=h,a=c),a>=s)break;l++}return console.log(" - Training finished with score ",a," model ",o),o}static trainRandom(t,i,r){var s,o,a,l,h;for(t=void 0!==t?t:1e5,i=void 0!==i?i:5,r=void 0!==r?r:2e3,console.log(" - Training process starting. ",{iterations:t,runs:i}),s=null,o=0,a=0;a<t&&((l=new n).jitter(2),(h=e.testModel(l,i,r))>o&&(s=l,o=h),console.log(" - Iteration ",a," score ",o),!(o>=r));)a++;return console.log(" - Training finished with score ",o," model ",s),s}static testModel(e,t,i){var r,s,n;for(n=0,s=0;s<t;)r=function(t){e.control(t)},n+=o.runHeadless(r,i),s++;return n/t}},l=class{static writeFile(e,t){var i,r;"object"==typeof e&&(e=JSON.stringify(e,null,"\t")),i=new Blob([e],{type:"octet/stream"}),(r=document.createElement("a")).download=t,r.href=window.URL.createObjectURL(i),r.style.display="none",r.onclick=function(){document.body.removeChild(this)},document.body.appendChild(r),r.click()}static readFile(e){var t;return(t=document.createElement("input")).type="file",t.style.display="none",document.body.appendChild(t),t.onchange=function(){var i,r;if(0!==(i=t.files).length)return(r=new FileReader).onload=function(){var t;return t=r.result,e(t)},r.readAsText(i[0]),document.body.removeChild(t)},t.click()}},c})()}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ckIsUUFDRyxHQUFtQixLQURuQkMsRUFBUUYsRUFBUUUsT0FDUEMsTyxPQUdUQyxFQUFTLElBQUlDLFlBQ05DLE9BQVMsV0FDbkIsTSxPQUFJQyxFQUFPSCxFQUFPSSxPQUNkVCxFQUFPUSxJQUVSSCxFQUFPSyxXQUFXUCxFQUFNLElBQ3hCakIsU0FBU1MsS0FBS0MsWUFBWUssSUFFM0JBLEVBQVFGLFUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9DUC93ZWJwYWNrL3VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24iLCJ3ZWJwYWNrOi8vQ1Avd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vQ1AvLi9zb3VyY2UvVmVjdG9yMi5jb2ZmZWUiLCJ3ZWJwYWNrOi8vQ1AvLi9zb3VyY2UvQm94LmNvZmZlZSIsIndlYnBhY2s6Ly9DUC8uL3NvdXJjZS9MaW5lLmNvZmZlZSIsIndlYnBhY2s6Ly9DUC8uL3NvdXJjZS9DYXJ0LmNvZmZlZSIsIndlYnBhY2s6Ly9DUC8uL3NvdXJjZS9MaW5lYXJSZWdyZXNzaW9uLmNvZmZlZSIsIndlYnBhY2s6Ly9DUC8uL3NvdXJjZS9MaW5lYXJNb2RlbC5jb2ZmZWUiLCJ3ZWJwYWNrOi8vQ1AvLi9zb3VyY2UvUnVubmVyLmNvZmZlZSIsIndlYnBhY2s6Ly9DUC8uL3NvdXJjZS9UcmFpbmluZy5jb2ZmZWUiLCJ3ZWJwYWNrOi8vQ1AvLi9zb3VyY2UvVXRpbHMuY29mZmVlIiwid2VicGFjazovL0NQL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9DUC93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL0NQL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiXSwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoW10sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wiQ1BcIl0gPSBmYWN0b3J5KCk7XG5cdGVsc2Vcblx0XHRyb290W1wiQ1BcIl0gPSBmYWN0b3J5KCk7XG59KShzZWxmLCBmdW5jdGlvbigpIHtcbnJldHVybiAiLCIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiY2xhc3MgVmVjdG9yMlxyXG4gICAgIyAyRCBWZWN0b3Igb2JqZWN0IHJlcHJlc2VudGVkIGJ5IHggYW5kIHkgY29vcmRpbmF0ZXMuXHJcbiAgICAjIFxyXG4gICAgIyBAcGFyYW0gW251bWJlcl0geCBcclxuICAgICMgQHBhcmFtIFtudW1iZXJdIHkgXHJcbiAgICBjb25zdHJ1Y3RvcjogKHgsIHkpIC0+IFxyXG4gICAgICAgIEB4ID0geFxyXG4gICAgICAgIEB5ID0geVxyXG5cclxuZXhwb3J0IHtWZWN0b3IyfSIsImltcG9ydCB7VmVjdG9yMn0gZnJvbSBcIi4vVmVjdG9yMlwiXHJcblxyXG5cclxuIyBCb3ggaXMgcmVwcmVzZW50ZWQgZnJvbSBhIG1pbmltdW0gYW5kIGEgbWF4aW11bSBwb2ludHMuXHJcbmNsYXNzIEJveFxyXG4gICAgIyBAcGFyYW0gW1ZlY3RvcjJdIG1pbiBcclxuICAgICMgQHBhcmFtIFtWZWN0b3IyXSBtYXggXHJcbiAgICBjb25zdHJ1Y3RvcjogKG1pbiwgbWF4KSAtPlxyXG4gICAgICAgIEBtaW4gPSBtaW5cclxuICAgICAgICBAbWF4ID0gbWF4XHJcblxyXG4gICAgIyBHZXQgdGhlIHNpemUgb2YgdGhlIGJveCBpbiBhIFZlY3Rvci5cclxuICAgICMgXHJcbiAgICAjIEByZXR1cm5zIFtWZWN0b3IyXSBTaXplIG9mIHRoZSBib3guIFxyXG4gICAgZ2V0U2l6ZTogKCkgLT5cclxuICAgICAgICByZXR1cm4gbmV3IFZlY3RvcjIoQG1heC54IC0gQG1pbi54LCBAbWF4LnkgLSBAbWluLnkpXHJcblxyXG4gICAgIyBEcmF3IHRoZSBib3ggaW50byBhIGNvbnRleHQgZm9yIHZpc3VhbGl6YXRpb24uXHJcbiAgICAjIFxyXG4gICAgIyBAcGFyYW0gW0NhbnZhc1JlbmRlcmluZ0NvbnRleHQyRF0gY29udGV4dCBcclxuICAgIGRyYXc6IChjb250ZXh0KSAtPlxyXG4gICAgICAgIHNpemUgPSBAZ2V0U2l6ZSgpXHJcbiAgICAgICAgY29udGV4dC5saW5lV2lkdGggPSAzXHJcbiAgICAgICAgY29udGV4dC5zdHJva2VSZWN0KEBtaW4ueCwgQG1pbi55LCBzaXplLngsIHNpemUueSlcclxuXHJcbmV4cG9ydCB7Qm94fSIsImltcG9ydCB7VmVjdG9yMn0gZnJvbSBcIi4vVmVjdG9yMlwiXHJcblxyXG4jIExpbmUgYmV0d2VlbiB0d28gcG9pbnRzIChvcmlnaW4gdG8gZW5kKS5cclxuI1xyXG4jIEBwYXJhbSBbVmVjdG9yMl0gb3JpZ2luIFxyXG4jIEBwYXJhbSBbVmVjdG9yMl0gZW5kXHJcbmNsYXNzIExpbmVcclxuICAgIGNvbnN0cnVjdG9yOiAob3JpZ2luLCBlbmQpIC0+XHJcbiAgICAgICAgQG9yaWdpbiA9IG9yaWdpblxyXG4gICAgICAgIEBlbmQgPSBlbmRcclxuICAgIFxyXG4gICAgIyBDYWxjdWxhdGUgdGhlIGRpc3RhbmNlIGJldHdlZW4gdGhlIG9yaWdpbiBhbmQgZW5kIHBvaW50cy5cclxuICAgICMgXHJcbiAgICAjIEByZXR1cm5zIHtudW1iZXJ9IFNpemUgb2YgdGhlIGxpbmUuXHJcbiAgICBzaXplOiAoKSAtPlxyXG4gICAgICAgIHJldHVybiBNYXRoLnNxcnQoTWF0aC5wb3coQG9yaWdpbi54IC0gQGVuZC54LCAyKSArIE1hdGgucG93KEBvcmlnaW4ueSAtIEBlbmQueSwgMikpXHJcblxyXG4gICAgIyBEcmF3IHRoZSBsaW5lIGludG8gYSBjYW52YXMgMkQgY29udGV4dC5cclxuICAgICMgXHJcbiAgICAjIEBwYXJhbSBbQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEXSBjb250ZXh0IFxyXG4gICAgZHJhdzogKGNvbnRleHQpIC0+XHJcbiAgICAgICAgY29udGV4dC5saW5lV2lkdGggPSAzXHJcbiAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKVxyXG4gICAgICAgIGNvbnRleHQubW92ZVRvKEBvcmlnaW4ueCwgQG9yaWdpbi55KVxyXG4gICAgICAgIGNvbnRleHQubGluZVRvKEBlbmQueCwgQGVuZC55KVxyXG4gICAgICAgIGNvbnRleHQuc3Ryb2tlKClcclxuXHJcblxyXG5leHBvcnQge0xpbmV9IiwiaW1wb3J0IHtWZWN0b3IyfSBmcm9tIFwiLi9WZWN0b3IyXCJcclxuaW1wb3J0IHtMaW5lfSBmcm9tIFwiLi9MaW5lXCJcclxuaW1wb3J0IHtCb3h9IGZyb20gXCIuL0JveFwiXHJcblxyXG4jIENhcnQgb2JqZWN0LCB0aGF0IGNvbnRhaW5zIHRoZSBlbnRpcmUgbG9naWMgZm9yIHRoZSBzaW11bGF0aW9uLlxyXG4jIFxyXG4jIFRoZSBjYXJ0IGNhbiBiZSBjb25maWd1cmVkXHJcbmNsYXNzIENhcnRcclxuICAgIGNvbnN0cnVjdG9yOiAoKSAtPlxyXG4gICAgICAgICMgRGlzdGFuY2Ugb2YgdGhlIGJhcnJpZXJzIHJlbGF0aXZlIHRvIHRoZSBjZW50ZXIuXHJcbiAgICAgICAgQGJhcnJpZXJEaXN0YW5jZSA9IDQwMFxyXG5cclxuICAgICAgICAjIEhhbGYgdGhlIHNpemUgb2YgdGhlIGNhcnQgYm94LlxyXG4gICAgICAgIEBib3hIYWxmU2l6ZSA9IDUwXHJcblxyXG4gICAgICAgICMgQWNjZWxlcmF0aW9uIHVzZWQgZm9yIG1vdmVtZW50IG9mIHRoZSBjYXJ0IG9uIGtleSBwcmVzcy5cclxuICAgICAgICBAbW92ZUFjY2VsZXJhdGlvbiA9IDAuMlxyXG5cclxuICAgICAgICAjIExpbWl0IGFuZ2xlIHRoYXQgdGhlIHBlbmR1bHVtIGNhbiByZWFjaC5cclxuICAgICAgICBAbGltaXRBbmdsZSA9IDAuN1xyXG5cclxuICAgICAgICAjIEJveCB0aGF0IHJlcHJlc2VudHMgdGhlIGNhcnQuXHJcbiAgICAgICAgQGNhcnQgPSBuZXcgQm94KG5ldyBWZWN0b3IyKC1AYm94SGFsZlNpemUsIC0zMCksIG5ldyBWZWN0b3IyKEBib3hIYWxmU2l6ZSwgMzApKVxyXG5cclxuICAgICAgICAjIExpbmUgdG8gcmVwcmVzZW50IHRoZSBwZW5kdWx1bVxyXG4gICAgICAgIEBwZW5kdWx1bSA9IG5ldyBMaW5lKG5ldyBWZWN0b3IyKDAsIDApLCBuZXcgVmVjdG9yMigwLCAxMDApKVxyXG4gICAgICAgIFxyXG4gICAgICAgICMgTGVmdCBiYXJyaWVyIGxpbWl0LlxyXG4gICAgICAgIEBiYXJyaWVyTGVmdCA9IG5ldyBMaW5lKG5ldyBWZWN0b3IyKC1AYmFycmllckRpc3RhbmNlLCAtMTAwMCksIG5ldyBWZWN0b3IyKC1AYmFycmllckRpc3RhbmNlLCAxMDAwKSlcclxuICAgICAgICBcclxuICAgICAgICAjIFJpZ2h0IGJhcnJpZXIgbGltaXQuXHJcbiAgICAgICAgQGJhcnJpZXJSaWdodCA9IG5ldyBMaW5lKG5ldyBWZWN0b3IyKEBiYXJyaWVyRGlzdGFuY2UsIC0xMDAwKSwgbmV3IFZlY3RvcjIoQGJhcnJpZXJEaXN0YW5jZSwgMTAwMCkpXHJcbiAgICAgICAgQHJlc2V0KClcclxuXHJcbiAgICAjIFJlc2V0IHRoZSBzaW11bGF0aW9uIHBhcmFtZXRlcnMgYmFjayB0byBhIGluaXRpYWwgc3RhdGUuXHJcbiAgICAjIFxyXG4gICAgIyBUaGUgaW5pdGlhbCB2ZWxvY2l0eSBvZiB0aGUgY2FydCBpcyByYW5kb21pemVkLlxyXG4gICAgcmVzZXQ6ICgpIC0+XHJcbiAgICAgICAgQGdhbWVPdmVyID0gZmFsc2VcclxuICAgICAgICBAc2NvcmUgPSAwXHJcbiAgICAgICAgQHBvc2l0aW9uID0gMFxyXG4gICAgICAgIEBsZWZ0UHJlc3NlZCA9IGZhbHNlXHJcbiAgICAgICAgQHJpZ2h0UHJlc3NlZCA9IGZhbHNlXHJcbiAgICAgICAgQGFjY2VsZXJhdGlvbiA9IDAuMFxyXG4gICAgICAgIEBmcmljdGlvbiA9IDAuOTlcclxuICAgICAgICBAdmVsb2NpdHkgPSAoTWF0aC5yYW5kb20oKSAqICAyIC0gMS4wKVxyXG4gICAgICAgIEB2ZWxvY2l0eSArPSBAdmVsb2NpdHkgPCAwID8gLTAuMiA6IDAuMlxyXG4gICAgICAgIEBhbmdsZSA9IDBcclxuXHJcblxyXG4gICAgIyBEcmF3IHRoZSBzaW11bGF0aW9uIHRvIGEgY29udGV4dCAyRCBmb3IgdmlzdWFsaXphdGlvbi5cclxuICAgICMgXHJcbiAgICAjIEBwYXJhbSBbQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEXSBjb250ZXh0IFxyXG4gICAgZHJhdzogKGNvbnRleHQpIC0+XHJcbiAgICAgICAgQGJhcnJpZXJMZWZ0LmRyYXcoY29udGV4dClcclxuICAgICAgICBAYmFycmllclJpZ2h0LmRyYXcoY29udGV4dClcclxuXHJcbiAgICAgICAgY29udGV4dC50cmFuc2xhdGUoQHBvc2l0aW9uLCAwKVxyXG5cclxuICAgICAgICAjIEd1aWRlbGluZXNcclxuICAgICAgICBjb250ZXh0LnN0cm9rZVN0eWxlID0gXCIjRkYwMDAwXCJcclxuICAgICAgICBjb250ZXh0LmxpbmVXaWR0aCA9IDFcclxuICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpXHJcbiAgICAgICAgY29udGV4dC5tb3ZlVG8oTWF0aC5zaW4oLUBsaW1pdEFuZ2xlKSAqIDEwMCwgTWF0aC5jb3MoLUBsaW1pdEFuZ2xlKSAqIDEwMClcclxuICAgICAgICBjb250ZXh0LmxpbmVUbygwLCAwKVxyXG4gICAgICAgIGNvbnRleHQubGluZVRvKE1hdGguc2luKEBsaW1pdEFuZ2xlKSAqIDEwMCwgTWF0aC5jb3MoQGxpbWl0QW5nbGUpICogIDEwMClcclxuICAgICAgICBjb250ZXh0LnN0cm9rZSgpXHJcblxyXG4gICAgICAgIGNvbnRleHQuc3Ryb2tlU3R5bGUgPSBcIiMwMDAwMDBcIlxyXG4gICAgICAgIGNvbnRleHQubGluZVdpZHRoID0gM1xyXG4gICAgICAgIEBwZW5kdWx1bS5lbmQueCA9IE1hdGguc2luKEBhbmdsZSkgKiAxMDBcclxuICAgICAgICBAcGVuZHVsdW0uZW5kLnkgPSBNYXRoLmNvcyhAYW5nbGUpICogMTAwXHJcbiAgICAgICAgQHBlbmR1bHVtLmRyYXcoY29udGV4dClcclxuICAgICAgICBAY2FydC5kcmF3KGNvbnRleHQpXHJcblxyXG5cclxuICAgICMgVXBkYXRlIHRoZSBsb2dpYyBvZiB0aGUgc2ltdWxhdGlvbi5cclxuICAgICMgXHJcbiAgICAjIFRoZSBjYXJ0IG1vdmVzIGFjY29yZGluZyB0byBpdHMgdmVsb2NpdHksIHRoZSBzdGljayBpcyB1c2VkIGJhc2VkIG9uIHZlbG9jaXR5IGFuZCBpdHMgY3VycmVudCBhbmdsZSAoZ3Jhdml0eSkuXHJcbiAgICB1cGRhdGU6ICgpIC0+XHJcbiAgICAgICAgIyBJZiBnYW1lIG92ZXIgcmV0dXJuXHJcbiAgICAgICAgaWYgQGdhbWVPdmVyXHJcbiAgICAgICAgICAgIHJldHVyblxyXG5cclxuICAgICAgICAjIFByb2Nlc3Mga2V5IHByZXNzZXNcclxuICAgICAgICBpZiBAbGVmdFByZXNzZWRcclxuICAgICAgICAgICAgQGFjY2VsZXJhdGlvbiA9IC1AbW92ZUFjY2VsZXJhdGlvblxyXG4gICAgICAgIGVsc2UgaWYgQHJpZ2h0UHJlc3NlZFxyXG4gICAgICAgICAgICBAYWNjZWxlcmF0aW9uID0gQG1vdmVBY2NlbGVyYXRpb25cclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIEBhY2NlbGVyYXRpb24gPSAwLjBcclxuXHJcbiAgICAgICAgIyBVcGRhdGUgcGh5c2ljc1xyXG4gICAgICAgIEB2ZWxvY2l0eSArPSBAYWNjZWxlcmF0aW9uXHJcbiAgICAgICAgQHZlbG9jaXR5ICo9IEBmcmljdGlvblxyXG4gICAgICAgIEBwb3NpdGlvbiArPSBAdmVsb2NpdHlcclxuXHJcbiAgICAgICAgQGFuZ2xlICs9IChAYW5nbGUgKiAzZS0yKSArICgtQHZlbG9jaXR5ICogNWUtMylcclxuICAgICAgICBAc2NvcmUrK1xyXG5cclxuICAgICAgICAjIElmIHRoZSBhbmdsZSBvZiB0aGUgcGVuZHVsdW0gZHJvcCBiZWxsb3cgdGhlIG1pbml1bSBlbmQgdGhlIGdhbWVcclxuICAgICAgICBpZiBAYW5nbGUgPiBAbGltaXRBbmdsZSBvciBAYW5nbGUgPCAtQGxpbWl0QW5nbGVcclxuICAgICAgICAgICAgQGdhbWVPdmVyID0gdHJ1ZVxyXG5cclxuICAgICAgICAjIElmIHRoZSBjYXJ0IGhpdHMgdGhlIGJhcnJpZWQgZW5kIHRoZSBnYW1lXHJcbiAgICAgICAgaWYgQHBvc2l0aW9uICsgQGJveEhhbGZTaXplID4gQGJhcnJpZXJEaXN0YW5jZSBvciBAcG9zaXRpb24gLSBAYm94SGFsZlNpemUgPCAtQGJhcnJpZXJEaXN0YW5jZVxyXG4gICAgICAgICAgICBAZ2FtZU92ZXIgPSB0cnVlXHJcblxyXG5leHBvcnQge0NhcnR9IiwiXHJcbiMgTGluZWFyIHJlZ3Jlc3Npb24gaXMgcmVwcmVzZW50ZWQgYnkgdHdvIHBhcmFtZXRlcnM6IHRoZSBvcmlnaW4gYW5kIHNsb3BlIG9mIHRoZSBsaW5lLlxyXG4jIFxyXG4jIEBwYXJhbSBbbnVtYmVyXSBvcmkgT3JpZ2luIG9mIHRoZSBsaW5lLlxyXG4jIEBwYXJhbSBbbnVtYmVyXSBkZWNsIFNsb3BlIG9mIHRoZSBsaW5lLlxyXG5jbGFzcyBMaW5lYXJSZWdyZXNzaW9uXHJcbiAgICBjb25zdHJ1Y3RvcjogKG9yaSwgZGVjbCkgLT5cclxuICAgICAgICBAb3JpID0gb3JpXHJcbiAgICAgICAgQGRlY2wgPSBkZWNsXHJcblxyXG5cclxuICAgICMgSml0dGVyIHRoZSB2YWx1ZXMgaW4gdGhlIHJlZ3Jlc3Npb24gcmFuZG9tbHkuXHJcbiAgICAjIFxyXG4gICAgIyBVc2VmdWxsIGZvciB0cmFpbmluZyBwdXJwb3Nlcy5cclxuICAgICMgXHJcbiAgICAjIEBwYXJhbSBbbnVtYmVyXSBzY2FsZSBTY2FsZSBvZiB0aGUgaml0dGVyaW5nLiBcclxuICAgIGppdHRlcjogKHNjYWxlKSAtPlxyXG4gICAgICAgIEBvcmkgKz0gKE1hdGgucmFuZG9tKCkgLSAwLjUpICogc2NhbGVcclxuICAgICAgICBAZGVjbCArPSAoTWF0aC5yYW5kb20oKSAtIDAuNSkgKiBzY2FsZVxyXG5cclxuXHJcbiAgICAjIENyZWF0ZSBhIGNvcHkgb2YgdGhlIGxpbmVhciByZWdyZXNzaW9uIG9iamVjdC5cclxuICAgICMgXHJcbiAgICAjIEByZXR1cm5zIENsb25lIG9mIHRoZSBsaW5lYXIgcmVncmVzc2lvbiBvYmplY3QuXHJcbiAgICBjbG9uZTogKCkgLT5cclxuICAgICAgICByZXR1cm4gbmV3IExpbmVhclJlZ3Jlc3Npb24oQG9yaSwgQGRlY2wpXHJcblxyXG5leHBvcnQge0xpbmVhclJlZ3Jlc3Npb259IiwiaW1wb3J0IHtMaW5lYXJSZWdyZXNzaW9ufSBmcm9tIFwiLi9MaW5lYXJSZWdyZXNzaW9uXCJcclxuXHJcbiMgTW9kZWwgdG8gY29udHJvbCB0aGUgY2FydCwgaXRzIHBhcmFtZXRlcnMgY2FuIGJlIHNldCBhbmQgdXNlZCB0byBjb250cm9sIHRoZSBjYXJ0LlxyXG4jIFxyXG4jIFRoZSBtb2RlbCBpcyBjb21wb3NlZCBvZiAzIGxpbmVhciByZWdyZXNzaW9ucyBmb3Igd2ljaCB0aGVpciBwYXJhbWV0ZXJzIGNhbiBiZSB0cmFpbmVkIGFuZCB1c2VkIHRvIGNvbnRyb2wgdGhlIGNhcnQgb2JqZWN0LlxyXG5jbGFzcyBMaW5lYXJNb2RlbFxyXG5cdGNvbnN0cnVjdG9yOiAoKSAtPlxyXG5cdFx0QHZlbCA9IG5ldyBMaW5lYXJSZWdyZXNzaW9uKDAsIDAuMClcclxuXHRcdEBhbmdsZSA9IG5ldyBMaW5lYXJSZWdyZXNzaW9uKDAsIDAuMClcclxuXHRcdEBwb3MgPSBuZXcgTGluZWFyUmVncmVzc2lvbigwLCAwLjApXHJcblx0XHRAZSA9IDAuMFxyXG5cclxuXHQjIEppdHRlciBhbGwgdmFsdWVzIG9mIHRoZSBtb2RlbFxyXG5cdCNcclxuXHQjIENhbiBiZSB1c2VkIGR1cmluZyB0cmFpbmluZyB0byBwcm9kdWNlIHZhcmlhdGlvbnMgb2YgdGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlIG1vZGVsLlxyXG5cdCNcclxuXHQjIEBwYXJhbSBbbnVtYmVyXSBzY2FsZSBTY2FsZSBvZiB0aGUgaml0dGVyaW5nIHRoZSB2YWx1ZXMgd2lsbCB2YXJpYXRlIGhhbGYgb2YgdGhlIHNjYWxlIHVwIGFuZCBkb3duLlxyXG5cdGppdHRlcjogKHNjYWxlKSAtPlxyXG5cdFx0QHZlbC5qaXR0ZXIoc2NhbGUpXHJcblx0XHRAYW5nbGUuaml0dGVyKHNjYWxlKVxyXG5cdFx0QHBvcy5qaXR0ZXIoc2NhbGUpXHJcblxyXG5cdFx0QGUgKz0gKE1hdGgucmFuZG9tKCkgLSAwLjUpICogc2NhbGVcclxuXHJcblx0IyBDcmVhdGUgYSBuZXcgb2JqZWN0IHdpdGggYSBjb3B5IG9mIHRoZSB2YWx1ZXMgc3RvcmVkIGluIHRoaXMgb25lLlxyXG5cdGNsb25lOiAoKSAtPlxyXG5cdFx0bSA9IG5ldyBMaW5lYXJNb2RlbCgpXHJcblx0XHRcclxuXHRcdG0udmVsID0gQHBvcy5jbG9uZSgpXHJcblx0XHRtLmFuZ2xlID0gQHBvcy5jbG9uZSgpXHJcblx0XHRtLnBvcyA9IEBwb3MuY2xvbmUoKVxyXG5cdFx0bS5lID0gQGVcclxuXHJcblx0XHRyZXR1cm4gbVxyXG5cclxuXHQjIENvbnRyb2wgdGhlIHNpbXVsYXRpb24gdXNpbmcgdGhlIHBhcmFtZXRlcnMgc3RvcmVkIGluIHRoaXMgbW9kZWwuXHJcblx0Y29udHJvbDogKGNhcnQpIC0+XHJcblx0XHR2ID0gQHZlbC5kZWNsICogY2FydC52ZWxvY2l0eSArIEB2ZWwub3JpXHJcblx0XHRhID0gQGFuZ2xlLmRlY2wgKiBjYXJ0LmFuZ2xlICsgQGFuZ2xlLm9yaVxyXG5cdFx0cCA9IEBwb3MuZGVjbCAqIGNhcnQucG9zaXRpb24gKyBAcG9zLm9yaVxyXG5cclxuXHRcdHZhbHVlID0gYSArIHYgKyBwXHJcblxyXG5cdFx0Y2FydC5sZWZ0UHJlc3NlZCA9IHZhbHVlIDwgQGVcclxuXHRcdGNhcnQucmlnaHRQcmVzc2VkID0gdmFsdWUgPiBAZVxyXG5cclxuZXhwb3J0IHtMaW5lYXJNb2RlbH0iLCJpbXBvcnQge0NhcnR9IGZyb20gXCIuL0NhcnRcIlxyXG5cclxuIyBNZXRob2RzIHRvIHJ1biB0aGUgc2ltdWxhdGlvbiBpbiBoZWFkbGVzcyBtb2RlICh0ZXJtaW5hbCBvbmx5KSwgb3IgYXR0YWNoZWQgdG8gYSBjYW52YXMgKEdyYXBoaWNhbCkuXHJcbmNsYXNzIFJ1bm5lclxyXG4gICAgIyBSdW4gdGhlIHNpbXVsYXRpb24gaGVhZGxlc3NseSAoaW4gdGVybWluYWwpLlxyXG4gICAgIyBcclxuICAgICMgVGhlIHNpbXVsYXRpb24gaXMgcnVuIHVudGlsIHRoZSBzdGljayBpcyBkcm9wcGVkIG9mZi5cclxuICAgICMgXHJcbiAgICAjIEBwYXJhbSBbRnVuY3Rpb25dIGxvZ2ljQ2FsbGJhY2sgQ2FsbGJhY2sgbWV0aG9kIHRvIHByb2Nlc3MgdGhlIGNhcnQgbG9naWMuXHJcbiAgICAjIEBwYXJhbSBbbnVtYmVyXSBwb2ludExpbWl0IEhvdyBtdWNoIHRpbWUgdG8gc2ltdWxhdGUgaW4gdGhlIGxpbWl0IChwcmV2ZW50IGluZmluaXRlIHJ1bikuXHJcbiAgICAjIEBwYXJhbSBbYm9vbGVhbl0gbG9nUGVyZm9ybWFuY2UgSWYgdHJ1ZSBjb25zb2xlIGxvZ3Mgd2l0aCBwZXJmb3JtYW5jZSBvZiB0aGUgc2ltdWxhdGlvbiBhcmUgcHJpbnRlZCBvdXQuXHJcbiAgICAjIEByZXR1cm5zIFJldHVybnMgdGhlIGFtbW91bnQgb2YgcG9pbnRzIGFjY3VtdWxhdGVkIGR1cmluZyB0aGUgc2ltdWxhdGlvbi5cclxuICAgIEBydW5IZWFkbGVzczogKGxvZ2ljQ2FsbGJhY2ssIHBvaW50TGltaXQsIGxvZ1BlcmZvcm1hbmNlKSAtPlxyXG4gICAgICAgIHBvaW50TGltaXQgPSBpZiBwb2ludExpbWl0ICE9IHVuZGVmaW5lZCB0aGVuIHBvaW50TGltaXQgZWxzZSBJbmZpbml0eVxyXG5cclxuICAgICAgICBjYXJ0ID0gbmV3IENhcnQoKVxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIGxvZ1BlcmZvcm1hbmNlXHJcbiAgICAgICAgICAgIHRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKVxyXG5cclxuICAgICAgICB3aGlsZSAhY2FydC5nYW1lT3ZlciBhbmQgY2FydC5zY29yZSA8IHBvaW50TGltaXRcclxuICAgICAgICAgICAgaWYgbG9naWNDYWxsYmFjayAhPSB1bmRlZmluZWRcclxuICAgICAgICAgICAgICAgIGxvZ2ljQ2FsbGJhY2soY2FydClcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNhcnQudXBkYXRlKClcclxuICAgICAgICBcclxuICAgICAgICBpZiBsb2dQZXJmb3JtYW5jZVxyXG4gICAgICAgICAgICBlbmQgPSBwZXJmb3JtYW5jZS5ub3coKVxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIiAtIFNpbXVsYXRpb24gZW5kZWQgd2l0aCBcIiArIGNhcnQuc2NvcmUgKyBcIiBwb2ludHMsIHRvb2sgXCIgKyAoZW5kIC0gdGltZSkgKyBcIi5cIilcclxuXHJcbiAgICAgICAgcmV0dXJuIGNhcnQuc2NvcmVcclxuXHJcbiAgICAjIFJ1biB0aGUgc2ltdWxhdGlvbiB3aXRoIHZpc3VhbGl6YXRpb24sIChhdHRhY2hlZCB0byBhIGNhbnZhcykuXHJcbiAgICAjIFxyXG4gICAgIyBSdW5zIGF0IHJlYWwgdGltZSBzcGVlZCBmb3IgdmlzdWFsaXphdGlvbiBwdXJwb3Nlcy5cclxuICAgICMgXHJcbiAgICAjIEBwYXJhbSBbRWxlbWVudF0gY2FudmFzIENhbnZhcyBlbGVtZW50IHdoZXJlIHRoZSBpbnRlcmZhY2UgaXMgZHJhd24uXHJcbiAgICAjIEBwYXJhbSBbRnVuY3Rpb25dIG9uSXRlcmF0aW9uIE1ldGhvZCBjYWxsZWQgZXZlcnkgaXRlcmF0aW9uIG9mIHRoZSBzaW11bGF0aW9uIHRvIGNvbnRyb2wgdGhlIGNhcnQuXHJcbiAgICAjIEBwYXJhbSBbRnVuY3Rpb25dIG9uR2FtZU92ZXIgTWV0aG9kIGNhbGxlZCB3aGVuIHRoZSBzaW11bGF0aW9uIGVuZHMuXHJcbiAgICBAcnVuR3JhcGhpY2FsOiAoY2FudmFzLCBvbkl0ZXJhdGlvbiwgb25HYW1lT3ZlcikgLT5cclxuICAgICAgICBjYXJ0ID0gbmV3IENhcnQoKVxyXG4gICAgICAgIGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpXHJcbiAgICAgICAgbWF4UG9pbnRzID0gMFxyXG5cclxuICAgICAgICB1cGRhdGUgPSAoKSAtPlxyXG4gICAgICAgICAgICBpZiBvbkl0ZXJhdGlvbiAhPSB1bmRlZmluZWRcclxuICAgICAgICAgICAgICAgIG9uSXRlcmF0aW9uKGNhcnQpXHJcblxyXG4gICAgICAgICAgICBjYXJ0LnVwZGF0ZSgpXHJcblxyXG4gICAgICAgICAgICBpZiBjYXJ0LmdhbWVPdmVyXHJcbiAgICAgICAgICAgICAgICBpZiBvbkdhbWVPdmVyICE9IHVuZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgICAgIG9uR2FtZU92ZXIoY2FydCwgbWF4UG9pbnRzKVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIGNhcnQuc2NvcmUgPiBtYXhQb2ludHMgXHJcbiAgICAgICAgICAgICAgICAgICAgbWF4UG9pbnRzID0gY2FydC5zY29yZVxyXG5cclxuICAgICAgICAgICAgICAgIGNhcnQucmVzZXQoKVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgIyBSZW5kZXJcclxuICAgICAgICAgICAgY29udGV4dC5zYXZlKClcclxuICAgICAgICAgICAgY29udGV4dC5jbGVhclJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgIyBUZXh0IGluIHRoZSBjYW52YXNcclxuICAgICAgICAgICAgY29udGV4dC5mb250ID0gXCIxNXB4IEFyaWFsXCJcclxuICAgICAgICAgICAgY29udGV4dC50ZXh0QWxpZ24gPSBcImxlZnRcIlxyXG4gICAgICAgICAgICBjb250ZXh0LmZpbGxUZXh0KFwiUG9pbnRzOiBcIiArIGNhcnQuc2NvcmUsIDEwLCAyMClcclxuICAgICAgICAgICAgY29udGV4dC5maWxsVGV4dChcIk1heDogXCIgKyBtYXhQb2ludHMsIDEwLCA0MClcclxuXHJcbiAgICAgICAgICAgICMgVHJhbnNmb3JtXHJcbiAgICAgICAgICAgIGNvbnRleHQudHJhbnNmb3JtKDEsIDAsIDAsIC0xLCAwLCBjYW52YXMuaGVpZ2h0KVxyXG4gICAgICAgICAgICBjb250ZXh0LnRyYW5zbGF0ZShjYW52YXMud2lkdGggLyAyLCBjYW52YXMuaGVpZ2h0IC8gMilcclxuICAgICAgICAgICAgY2FydC5kcmF3KGNvbnRleHQpXHJcblxyXG4gICAgICAgICAgICBjb250ZXh0LnJlc3RvcmUoKVxyXG4gICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodXBkYXRlKVxyXG5cclxuICAgICAgICB1cGRhdGUoKVxyXG5cclxuZXhwb3J0IHtSdW5uZXJ9XHJcbiIsImltcG9ydCB7UnVubmVyfSBmcm9tIFwiLi9SdW5uZXJcIlxyXG5pbXBvcnQge0xpbmVhck1vZGVsfSBmcm9tIFwiLi9MaW5lYXJNb2RlbFwiXHJcblxyXG4jIE1ldGhvZHMgZm9yIHRyYWluaW5nIG9mIHRoZSBjYXJ0IG1vZGVsLlxyXG4jXHJcbiMgVHJhaW5pbmcgcHJvZHVjZXMgYSBsaW5lYXIgbW9kZWwgb2YgdGhlIGNhcnQsIHRoYXQgY2FuIGJlIHVzZWQgdG8gY29udHJvbCB0aGUgc2ltdWxhdGlvbi5cclxuY2xhc3MgVHJhaW5pbmdcclxuXHQjIFRyYWluIHRoZSBtb2RlbCBvZiB0aGUgY2FydCBpdGVyYXRpdmVsbHkuXHJcblx0IyBcclxuXHQjIFVzZXMgYSBzZWFzb25hbCB0cmFpbmluZyBhcHByb2FjaCBmb3Igd2ljaCBtYW55IGVwb2NocyBhcmUgZXhlY3V0ZWQgYW5kIHRoZSBiZXN0IGZyb20gZWFjaCBlcG9jaCBpcyBzZWxlY3RlZCBhcyBiYXNlZCBmb3IgdGhlIG5leHQuXHJcblx0IyBcclxuXHQjIEBwYXJhbSBbbnVtYmVyXSBlcG9jaHMgTnVtYmVyIG9mIGl0ZXJhdGlvbnMvZXBvY2hzIHRvIHNpbXVsYXRlLlxyXG5cdCMgQHBhcmFtIFtudW1iZXJdIGl0ZXJhdGlvbnMgTnVtYmVyIG9mIHZhcmlhdGlvbnMgdGVzdGVkIGluIGVhY2ggZXBvY2guXHJcblx0IyBAcGFyYW0gW251bWJlcl0gcnVucyBIb3cgbWFueSB0aW1lcyB0byBydW4gZWFjaCB2YXJpYXRpb24gdG8gZ2V0IGFuIGF2ZXJhZ2UgcGVyZm9ybWFuY2UuXHJcblx0IyBAcmV0dXJucyB7TGluZWFyTW9kZWx9IFRyYWluZWQgbW9kZWwgdGhhdCBjYW4gYmUgdXNlZCB0byBjb250cm9sIHRoZSBzaW11bGF0aW9uLlxyXG5cdEB0cmFpbkl0ZXJhdGl2ZTogKGVwb2NocywgaXRlcmF0aW9ucywgcnVucywgc2NvcmVMaW1pdCkgLT5cclxuXHRcdGVwb2NocyA9IGlmIGVwb2NocyAhPSB1bmRlZmluZWQgdGhlbiBlcG9jaHMgZWxzZSA1MDBcclxuXHRcdGl0ZXJhdGlvbnMgPSBpZiBpdGVyYXRpb25zICE9IHVuZGVmaW5lZCB0aGVuIGl0ZXJhdGlvbnMgZWxzZSAxMDBcclxuXHRcdHJ1bnMgPSBpZiBydW5zICE9IHVuZGVmaW5lZCB0aGVuIHJ1bnMgZWxzZSA1XHJcblxyXG5cdFx0IyBJZiB0aGUgbW9kZWwgcmVhY2hlcyB0aGlzIGxldmVsIG9mIHBlcmZvcm1hbmNlIHRoZSB0cmFpbmluZyBpcyBzdG9wcGVkLlxyXG5cdFx0c2NvcmVMaW1pdCA9IGlmIHNjb3JlTGltaXQgIT0gdW5kZWZpbmVkIHRoZW4gc2NvcmVMaW1pdCBlbHNlIDIwMDAuMFxyXG5cclxuXHRcdGNvbnNvbGUubG9nKFwiIC0gVHJhaW5pbmcgcHJvY2VzcyBzdGFydGluZy4gXCIsIHtlcG9jaHMsIGl0ZXJhdGlvbnMsIHJ1bnN9KVxyXG5cclxuXHRcdGJlc3RNb2RlbCA9IG5ldyBMaW5lYXJNb2RlbCgpXHJcblx0XHRiZXN0U2NvcmUgPSBUcmFpbmluZy50ZXN0TW9kZWwoYmVzdE1vZGVsLCBydW5zLCBzY29yZUxpbWl0KVxyXG5cclxuXHRcdGppdHRlciA9IDEuMFxyXG5cdFx0XHJcblx0XHQjIEVwb2NoXHJcblx0XHRlID0gMFxyXG5cdFx0d2hpbGUgZSA8IGVwb2Noc1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcIiAtIFJ1bm5pbmcgZXBvY2ggXCIsIGUsIFwiIHNjb3JlIFwiLCBiZXN0U2NvcmUpXHJcblxyXG5cdFx0XHRlcG9jaE1vZGVsID0gbnVsbFxyXG5cdFx0XHRlcG9jaFNjb3JlID0gMFxyXG5cclxuXHRcdFx0IyBOdW1iZXIgb2YgaXRlcmF0aW9ucyBwZXIgZXBvY2hcclxuXHRcdFx0aSA9IDBcclxuXHRcdFx0d2hpbGUgaSA8IGl0ZXJhdGlvbnNcclxuXHRcdFx0XHRtb2RlbCA9IGJlc3RNb2RlbC5jbG9uZSgpXHJcblx0XHRcdFx0bW9kZWwuaml0dGVyKGppdHRlcilcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRwb2ludHMgPSBUcmFpbmluZy50ZXN0TW9kZWwobW9kZWwsIHJ1bnMsIHNjb3JlTGltaXQpXHJcblx0XHRcdFx0aWYgcG9pbnRzID4gZXBvY2hTY29yZVxyXG5cdFx0XHRcdFx0ZXBvY2hNb2RlbCA9IG1vZGVsXHJcblx0XHRcdFx0XHRlcG9jaFNjb3JlID0gcG9pbnRzXHJcblx0XHRcdFx0XHJcblx0XHRcdFx0aSsrXHJcblxyXG5cdFx0XHRpZiBlcG9jaFNjb3JlID49IGJlc3RTY29yZVxyXG5cdFx0XHRcdGJlc3RNb2RlbCA9IGVwb2NoTW9kZWxcclxuXHRcdFx0XHRiZXN0U2NvcmUgPSBlcG9jaFNjb3JlXHJcblxyXG5cdFx0XHRpZiBiZXN0U2NvcmUgPj0gc2NvcmVMaW1pdFxyXG5cdFx0XHRcdGJyZWFrXHJcblx0XHRcdGUrK1xyXG5cclxuXHRcdGNvbnNvbGUubG9nKFwiIC0gVHJhaW5pbmcgZmluaXNoZWQgd2l0aCBzY29yZSBcIiwgYmVzdFNjb3JlLCBcIiBtb2RlbCBcIiwgYmVzdE1vZGVsKVxyXG5cdFx0cmV0dXJuIGJlc3RNb2RlbFxyXG5cclxuXHQjIEZ1bGx5IHJhbmRvbWl6ZWQgdHJhaW5pbmcsIHRlc3QgbWFueSBwYXJhbWV0ZXJzIGFuZCBzZWxlY3QgdGhlIGJlc3QgZnJvbSBhbGwuXHJcblx0IyBcclxuXHQjIEBwYXJhbSBbbnVtYmVyXSBpdGVyYXRpb25zIE51bWJlciBvZiB2YXJpYXRpb25zIHRlc3RlZCBpbiBlYWNoIGVwb2NoLlxyXG5cdCMgQHBhcmFtIFtudW1iZXJdIHJ1bnMgSG93IG1hbnkgdGltZXMgdG8gcnVuIGVhY2ggdmFyaWF0aW9uIHRvIGdldCBhbiBhdmVyYWdlIHBlcmZvcm1hbmNlLlxyXG5cdCMgQHJldHVybnMge0xpbmVhck1vZGVsfSBUcmFpbmVkIG1vZGVsIHRoYXQgY2FuIGJlIHVzZWQgdG8gY29udHJvbCB0aGUgc2ltdWxhdGlvbi5cclxuXHRAdHJhaW5SYW5kb206IChpdGVyYXRpb25zLCBydW5zLCBzY29yZUxpbWl0KSAtPlxyXG5cdFx0aXRlcmF0aW9ucyA9IGlmIGl0ZXJhdGlvbnMgIT0gdW5kZWZpbmVkIHRoZW4gaXRlcmF0aW9ucyBlbHNlIDFlNVxyXG5cdFx0cnVucyA9IGlmIHJ1bnMgIT0gdW5kZWZpbmVkIHRoZW4gcnVucyBlbHNlIDVcclxuXHJcblx0XHQjIElmIHRoZSBtb2RlbCByZWFjaGVzIHRoaXMgbGV2ZWwgb2YgcGVyZm9ybWFuY2UgdGhlIHRyYWluaW5nIGlzIHN0b3BwZWQuXHJcblx0XHRzY29yZUxpbWl0ID0gaWYgc2NvcmVMaW1pdCAhPSB1bmRlZmluZWQgdGhlbiBzY29yZUxpbWl0IGVsc2UgMjAwMC4wXHJcblxyXG5cdFx0Y29uc29sZS5sb2coXCIgLSBUcmFpbmluZyBwcm9jZXNzIHN0YXJ0aW5nLiBcIiwge2l0ZXJhdGlvbnMsIHJ1bnN9KVxyXG5cclxuXHRcdGJlc3RNb2RlbCA9IG51bGxcclxuXHRcdGJlc3RTY29yZSA9IDBcclxuXHRcdFxyXG5cdFx0aml0dGVyID0gMi4wXHJcblxyXG5cdFx0IyBUZXN0cyBwZXIgZXBvY2hcclxuXHRcdGkgPSAwXHJcblx0XHR3aGlsZSBpIDwgaXRlcmF0aW9uc1xyXG5cdFx0XHRtb2RlbCA9IG5ldyBMaW5lYXJNb2RlbCgpXHJcblx0XHRcdG1vZGVsLmppdHRlcihqaXR0ZXIpXHJcblx0XHRcdFxyXG5cdFx0XHRzY29yZSA9IFRyYWluaW5nLnRlc3RNb2RlbChtb2RlbCwgcnVucywgc2NvcmVMaW1pdClcclxuXHRcdFx0aWYgc2NvcmUgPiBiZXN0U2NvcmVcclxuXHRcdFx0XHRiZXN0TW9kZWwgPSBtb2RlbFxyXG5cdFx0XHRcdGJlc3RTY29yZSA9IHNjb3JlXHJcblxyXG5cdFx0XHRjb25zb2xlLmxvZyhcIiAtIEl0ZXJhdGlvbiBcIiwgaSwgXCIgc2NvcmUgXCIsIGJlc3RTY29yZSlcclxuXHJcblx0XHRcdGlmIGJlc3RTY29yZSA+PSBzY29yZUxpbWl0XHJcblx0XHRcdFx0YnJlYWtcclxuXHRcdFx0XHJcblx0XHRcdGkrK1xyXG5cclxuXHRcdGNvbnNvbGUubG9nKFwiIC0gVHJhaW5pbmcgZmluaXNoZWQgd2l0aCBzY29yZSBcIiwgYmVzdFNjb3JlLCBcIiBtb2RlbCBcIiwgYmVzdE1vZGVsKVxyXG5cclxuXHRcdHJldHVybiBiZXN0TW9kZWxcclxuXHJcblx0IyBSdW4gdGhlIG1vZGVsLCBtdWx0aXBsZSB0aW1lcyBhbmQgYXZlcmFnZSB0aGUgcG9udHVhdGlvbiBvZiB0aGUgcnVucy5cclxuXHQjIFxyXG5cdCMgQHBhcmFtIFtMaW5lYXJNb2RlbF0gbW9kZWwgTW9kZWwgdG8gYmUgdGVzdGVkLlxyXG5cdCMgQHBhcmFtIFtudW1iZXJdIHJ1bnMgTnVtYmVyIG9mIGl0ZXJhdGlvbnMgdG8gdGVzdCB0aGUgbW9kZWwuXHJcblx0IyBAcGFyYW0gW251bWJlcl0gc2NvcmVMaW1pdCBJZiB0aGUgc2NvcmUgb2YgdGhlIG1vZGVsIGdldHMgYmV0dGVyIHRoYW4gdGhlIGxpbWl0IHRoZSBzaW11bGF0aW9uIHN0b3BzLlxyXG5cdCMgQHJldHVybiB7bnVtYmVyfSBUaGUgYXZlcmFnZSBwZXJmb3JtYW5jZSBzY29yZSBvZiB0aGUgbW9kZWwuXHJcblx0QHRlc3RNb2RlbDogKG1vZGVsLCBydW5zLCBzY29yZUxpbWl0KSAtPlxyXG5cdFx0c2NvcmUgPSAwXHJcblx0XHRyID0gMFxyXG5cdFx0d2hpbGUgciA8IHJ1bnNcclxuXHRcdFx0Y29udHJvbCA9IChjYXJ0KSAtPlxyXG5cdFx0XHRcdG1vZGVsLmNvbnRyb2woY2FydClcclxuXHRcdFx0XHRyZXR1cm5cclxuXHRcdFx0XHRcclxuXHRcdFx0c2NvcmUgKz0gUnVubmVyLnJ1bkhlYWRsZXNzKGNvbnRyb2wsIHNjb3JlTGltaXQpXHJcblx0XHRcdHIrK1xyXG5cdFx0XHJcblx0XHRyZXR1cm4gc2NvcmUgLyBydW5zXHJcblxyXG5leHBvcnQge1RyYWluaW5nfVxyXG4iLCIjIEF1eGlsaWFyIG1ldGhvZHMgZm9yIGZpbGUgbWFuaXB1bGF0aW9uLCBuZXR3b3JraW5nLCBldGNcclxuY2xhc3MgVXRpbHNcclxuXHQjIFdyaXRlIGRhdGEgaW50byBhIGZpbGUuIFVzZWZ1bCB0byBleHBvcnQgSlNPTiBkYXRhLlxyXG5cdCMgXHJcblx0IyBAcGFyYW0gW3N0cmluZyB8IG9iamVjdF0gZGF0YSBEYXRhIHRvIGJlIHdyaXR0ZW4gdG8gZmlsZS4gXHJcblx0IyBAcGFyYW0gW3N0cmluZ10gZm5hbWUgTmFtZSBvZiB0aGUgZmlsZSB0byBiZSB3cml0dGVuLlxyXG5cdEB3cml0ZUZpbGU6IChkYXRhLCBmbmFtZSkgLT5cclxuXHRcdGlmIHR5cGVvZiBkYXRhID09ICdvYmplY3QnXHJcblx0XHRcdGRhdGEgPSBKU09OLnN0cmluZ2lmeShkYXRhLCBudWxsLCAnXFx0JylcclxuXHJcblx0XHRibG9iID0gbmV3IEJsb2IoW2RhdGFdLCB7dHlwZTogJ29jdGV0L3N0cmVhbSd9KVxyXG5cdFx0XHJcblx0XHRkb3dubG9hZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKVxyXG5cdFx0ZG93bmxvYWQuZG93bmxvYWQgPSBmbmFtZVxyXG5cdFx0ZG93bmxvYWQuaHJlZiA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpXHJcblx0XHRkb3dubG9hZC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnXHJcblxyXG5cdFx0ZG93bmxvYWQub25jbGljayA9ICgpIC0+XHJcblx0XHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQodGhpcylcclxuXHRcdFx0cmV0dXJuXHJcblx0XHRcclxuXHRcdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZG93bmxvYWQpXHJcblx0XHRcclxuXHRcdGRvd25sb2FkLmNsaWNrKClcclxuXHRcdHJldHVyblxyXG5cclxuXHJcblx0IyBDaG9vc2UgZmlsZSBhbmQgcmVhZCBkYXRhIGZyb20gaXQuXHJcblx0QHJlYWRGaWxlOiAob25Mb2FkKSAtPlxyXG5cdFx0Y2hvb3NlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKVxyXG5cdFx0Y2hvb3Nlci50eXBlID0gXCJmaWxlXCJcclxuXHRcdGNob29zZXIuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiXHJcblx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGNob29zZXIpXHJcblxyXG5cdFx0Y2hvb3Nlci5vbmNoYW5nZSA9ICgpIC0+XHJcblx0XHRcdGZpbGVzID0gY2hvb3Nlci5maWxlc1xyXG5cdFx0XHRpZiBmaWxlcy5sZW5ndGggPT0gMFxyXG5cdFx0XHRcdHJldHVyblxyXG5cclxuXHRcdFx0cmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKVxyXG5cdFx0XHRyZWFkZXIub25sb2FkID0gKCkgLT5cclxuXHRcdFx0XHR0ZXh0ID0gcmVhZGVyLnJlc3VsdFxyXG5cdFx0XHRcdG9uTG9hZCh0ZXh0KVxyXG5cdFx0XHRcclxuXHRcdFx0cmVhZGVyLnJlYWRBc1RleHQoZmlsZXNbMF0pXHJcblx0XHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoY2hvb3NlcilcclxuXHJcblx0XHRjaG9vc2VyLmNsaWNrKClcclxuXHJcbmV4cG9ydCB7VXRpbHN9IiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyJdLCJuYW1lcyI6WyJyb290IiwiZmFjdG9yeSIsImV4cG9ydHMiLCJtb2R1bGUiLCJkZWZpbmUiLCJhbWQiLCJzZWxmIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJWZWN0b3IyIiwiY29uc3RydWN0b3IiLCJ4IiwieSIsIkJveCIsIm1pbiIsIm1heCIsImdldFNpemUiLCJkcmF3IiwiY29udGV4dCIsInNpemUiLCJsaW5lV2lkdGgiLCJzdHJva2VSZWN0IiwiTGluZSIsIm9yaWdpbiIsImVuZCIsIk1hdGgiLCJzcXJ0IiwicG93IiwiYmVnaW5QYXRoIiwibW92ZVRvIiwibGluZVRvIiwic3Ryb2tlIiwiQ2FydCIsImJhcnJpZXJEaXN0YW5jZSIsImJveEhhbGZTaXplIiwibW92ZUFjY2VsZXJhdGlvbiIsImxpbWl0QW5nbGUiLCJjYXJ0IiwicGVuZHVsdW0iLCJiYXJyaWVyTGVmdCIsImJhcnJpZXJSaWdodCIsInJlc2V0IiwiZ2FtZU92ZXIiLCJzY29yZSIsInBvc2l0aW9uIiwibGVmdFByZXNzZWQiLCJyaWdodFByZXNzZWQiLCJhY2NlbGVyYXRpb24iLCJmcmljdGlvbiIsInZlbG9jaXR5IiwicmFuZG9tIiwiYW5nbGUiLCJ0cmFuc2xhdGUiLCJzdHJva2VTdHlsZSIsInNpbiIsImNvcyIsInVwZGF0ZSIsIkxpbmVhck1vZGVsIiwidmVsIiwiTGluZWFyUmVncmVzc2lvbiIsInBvcyIsImUiLCJqaXR0ZXIiLCJzY2FsZSIsImNsb25lIiwibSIsImNvbnRyb2wiLCJ2IiwiZGVjbCIsIm9yaSIsIlJ1bm5lciIsImxvZ2ljQ2FsbGJhY2siLCJwb2ludExpbWl0IiwibG9nUGVyZm9ybWFuY2UiLCJ0aW1lIiwicGVyZm9ybWFuY2UiLCJub3ciLCJjb25zb2xlIiwibG9nIiwiY2FudmFzIiwib25JdGVyYXRpb24iLCJvbkdhbWVPdmVyIiwiZ2V0Q29udGV4dCIsIm1heFBvaW50cyIsInNhdmUiLCJjbGVhclJlY3QiLCJ3aWR0aCIsImhlaWdodCIsImZvbnQiLCJ0ZXh0QWxpZ24iLCJmaWxsVGV4dCIsInRyYW5zZm9ybSIsInJlc3RvcmUiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJUcmFpbmluZyIsImVwb2NocyIsIml0ZXJhdGlvbnMiLCJydW5zIiwic2NvcmVMaW1pdCIsImJlc3RNb2RlbCIsImJlc3RTY29yZSIsInRlc3RNb2RlbCIsImVwb2NoTW9kZWwiLCJlcG9jaFNjb3JlIiwiaSIsIm1vZGVsIiwicG9pbnRzIiwiciIsInJ1bkhlYWRsZXNzIiwiVXRpbHMiLCJkYXRhIiwiZm5hbWUiLCJKU09OIiwic3RyaW5naWZ5IiwiYmxvYiIsIkJsb2IiLCJ0eXBlIiwiZG93bmxvYWQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJocmVmIiwid2luZG93IiwiVVJMIiwiY3JlYXRlT2JqZWN0VVJMIiwic3R5bGUiLCJkaXNwbGF5Iiwib25jbGljayIsImJvZHkiLCJyZW1vdmVDaGlsZCIsInRoaXMiLCJhcHBlbmRDaGlsZCIsImNsaWNrIiwib25Mb2FkIiwiY2hvb3NlciIsIm9uY2hhbmdlIiwiZmlsZXMiLCJsZW5ndGgiLCJyZWFkZXIiLCJGaWxlUmVhZGVyIiwib25sb2FkIiwidGV4dCIsInJlc3VsdCIsInJlYWRBc1RleHQiXSwic291cmNlUm9vdCI6IiJ9