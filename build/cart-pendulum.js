!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CP=t():e.CP=t()}(self,(function(){return(()=>{"use strict";var e,t,i,n={d:(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},o={};function r(e,t){this.min=e,this.max=t}function s(){this.barrierDistance=400,this.boxHalfSize=50,this.moveAcceleration=.2,this.limitAngle=.7,this.cart=new r(new e(-this.boxHalfSize,-30),new e(this.boxHalfSize,30)),this.pendulum=new t(new e(0,0),new e(0,100)),this.barrierLeft=new t(new e(-this.barrierDistance,-1e3),new e(-this.barrierDistance,1e3)),this.barrierRight=new t(new e(this.barrierDistance,-1e3),new e(this.barrierDistance,1e3)),this.reset()}function a(e,t){this.ori=e,this.decl=t}function h(){this.vel=new a(0,0),this.angle=new a(0,0),this.pos=new a(0,0),this.e=0}function l(){}function c(){}return n.r(o),n.d(o,{Box:()=>r,Cart:()=>s,Line:()=>t,LinearModel:()=>h,LinearRegression:()=>a,Runner:()=>l,Training:()=>c,Utils:()=>i,Vector2:()=>e}),e=class{constructor(e,t){this.x=e,this.y=t}},r.prototype.getSize=function(){return new e(this.max.x-this.min.x,this.max.y-this.min.y)},r.prototype.draw=function(e){var t=this.getSize();e.lineWidth=3,e.strokeRect(this.min.x,this.min.y,t.x,t.y)},t=class{constructor(e,t){this.origin=e,this.end=t}size(){return Math.sqrt(Math.pow(this.origin.x-this.end.x,2)+Math.pow(this.origin.y-this.end.y,2))}draw(e){return e.lineWidth=3,e.beginPath(),e.moveTo(this.origin.x,this.origin.y),e.lineTo(this.end.x,this.end.y),e.stroke()}},s.prototype.reset=function(){this.gameOver=!1,this.score=0,this.position=0,this.leftPressed=!1,this.rightPressed=!1,this.acceleration=0,this.friction=.99,this.velocity=2*Math.random()-1,this.velocity+=this.velocity<0?-.2:.2,this.angle=0},s.prototype.draw=function(e){this.barrierLeft.draw(e),this.barrierRight.draw(e),e.translate(this.position,0),e.strokeStyle="#FF0000",e.lineWidth=1,e.beginPath(),e.moveTo(100*Math.sin(-this.limitAngle),100*Math.cos(-this.limitAngle)),e.lineTo(0,0),e.lineTo(100*Math.sin(this.limitAngle),100*Math.cos(this.limitAngle)),e.stroke(),e.strokeStyle="#000000",e.lineWidth=3,this.pendulum.end.x=100*Math.sin(this.angle),this.pendulum.end.y=100*Math.cos(this.angle),this.pendulum.draw(e),this.cart.draw(e)},s.prototype.update=function(){this.gameOver||(this.leftPressed?this.acceleration=-this.moveAcceleration:this.rightPressed?this.acceleration=this.moveAcceleration:this.acceleration=0,this.velocity+=this.acceleration,this.velocity*=this.friction,this.position+=this.velocity,this.angle+=.03*this.angle+.005*-this.velocity,this.score++,(this.angle>this.limitAngle||this.angle<-this.limitAngle)&&(this.gameOver=!0),(this.position+this.boxHalfSize>this.barrierDistance||this.position-this.boxHalfSize<-this.barrierDistance)&&(this.gameOver=!0))},a.prototype.jitter=function(e){this.ori+=(Math.random()-.5)*e,this.decl+=(Math.random()-.5)*e},a.prototype.clone=function(){return new a(this.ori,this.decl)},h.prototype.jitter=function(e){this.vel.jitter(e),this.angle.jitter(e),this.pos.jitter(e),this.e+=(Math.random()-.5)*e},h.prototype.clone=function(){var e=new h;return e.vel=this.pos.clone(),e.angle=this.pos.clone(),e.pos=this.pos.clone(),e.e=this.e,e},h.prototype.control=function(e){var t=this.vel.decl*e.velocity+this.vel.ori,i=this.angle.decl*e.angle+this.angle.ori+t+(this.pos.decl*e.position+this.pos.ori);e.leftPressed=i<this.e,e.rightPressed=i>this.e},l.runHeadless=function(e,t,i){t=void 0!==t?t:1/0;var n=new s;if(i)var o=performance.now();for(;!n.gameOver&&n.score<t;)void 0!==e&&e(n),n.update();if(i){var r=performance.now();console.log(" - Simulation ended with "+n.score+" points, took "+(r-o)+".")}return n.score},l.runGraphical=function(e,t,i){var n=new s,o=e.getContext("2d"),r=0;!function s(){void 0!==t&&t(n),n.update(),n.gameOver&&(void 0!==i&&i(n,r),n.score>r&&(r=n.score),n.reset()),o.save(),o.clearRect(0,0,e.width,e.height),o.font="15px Arial",o.textAlign="left",o.fillText("Points: "+n.score,10,20),o.fillText("Max: "+r,10,40),o.transform(1,0,0,-1,0,e.height),o.translate(e.width/2,e.height/2),n.draw(o),o.restore(),requestAnimationFrame(s)}()},c.trainIterative=function(e,t,i,n){e=void 0!==e?e:500,t=void 0!==t?t:100,i=void 0!==i?i:5,n=void 0!==n?n:2e3,console.log(" - Training process starting. ",{epochs:e,iterations:t,runs:i});for(var o=new h,r=c.testModel(o,i,n),s=0;s<e;s++){console.log(" - Running epoch ",s," score ",r);for(var a=null,l=0,d=0;d<t;d++){var u=o.clone();u.jitter(1);var f=c.testModel(u,i,n);f>l&&(a=u,l=f)}if(l>=r&&(o=a,r=l),r>=n)break}return console.log(" - Training finished with score ",r," model ",o),o},c.trainRandom=function(e,t,i){e=void 0!==e?e:1e5,t=void 0!==t?t:5,i=void 0!==i?i:2e3,console.log(" - Training process starting. ",{iterations:e,runs:t});for(var n=null,o=0,r=0;r<e;r++){var s=new h;s.jitter(2);var a=c.testModel(s,t,i);if(a>o&&(n=s,o=a),console.log(" - Iteration ",r," score ",o),o>=i)break}return console.log(" - Training finished with score ",o," model ",n),n},c.testModel=function(e,t,i){for(var n=0,o=0;o<t;o++)n+=l.runHeadless((function(t){e.control(t)}),i);return n/t},i=class{static writeFile(e,t){var i,n;"object"==typeof e&&(e=JSON.stringify(e,null,"\t")),i=new Blob([e],{type:"octet/stream"}),(n=document.createElement("a")).download=t,n.href=window.URL.createObjectURL(i),n.style.display="none",n.onclick=function(){document.body.removeChild(this)},document.body.appendChild(n),n.click()}static readFile(e){var t;return(t=document.createElement("input")).type="file",t.style.display="none",document.body.appendChild(t),t.onchange=function(){var i,n;if(0!==(i=t.files).length)return(n=new FileReader).onload=function(){var t;return t=n.result,e(t)},n.readAsText(i[0]),document.body.removeChild(t)},t.click()}},o})()}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QSxJQUFJbkQsRUFBUSxFQUNKNkQsRUFBSSxFQUFHQSxFQUFJWCxFQUFNVyxJQUV4QjdELEdBQVNyQixFQUFPd0MsYUFBWSxTQUFTdkQsR0FFcEM4RixFQUFNekMsUUFBUXJELEtBQ1p1RixHQUVKLE9BQU9uRCxFQUFRa0QsR1R6SVZZLEVBQU4sTUFLYSxpQkFBQ0MsRUFBTUMsR0FDcEIsUUFBb0IsaUJBQVJELElBQ1RBLEVBQU9FLEtBQUtDLFVBQVVILEVBQU0sS0FBTSxPQUVuQ0ksRUFBTyxJQUFJQyxLQUFLLENBQUNMLEdBQU8sQ0FBQ00sS0FBTSxrQkFFL0JDLEVBQVdDLFNBQVNDLGNBQWMsTUFDekJGLFNBQVdOLEVBQ3BCTSxFQUFTRyxLQUFPQyxPQUFPQyxJQUFJQyxnQkFBZ0JULEdBQzNDRyxFQUFTTyxNQUFNQyxRQUFVLE9BRXpCUixFQUFTUyxRQUFVLFdBQ2xCUixTQUFTUyxLQUFLQyxZQUFZM0gsT0FHM0JpSCxTQUFTUyxLQUFLRSxZQUFZWixHQUUxQkEsRUFBU2EsUUFLQyxnQkFBQ0MsR0FDYixNLE9BQUVDLEVBQVVkLFNBQVNDLGNBQWMsVUFDekJILEtBQU8sT0FDZmdCLEVBQVFSLE1BQU1DLFFBQVUsT0FDeEJQLFNBQVNTLEtBQUtFLFlBQVlHLEdBRTFCQSxFQUFRQyxTQUFXLFdBQ3JCLFFBQ0csR0FBbUIsS0FEbkJDLEVBQVFGLEVBQVFFLE9BQ1BDLE8sT0FHVEMsRUFBUyxJQUFJQyxZQUNOQyxPQUFTLFdBQ25CLE0sT0FBSUMsRUFBT0gsRUFBT0ksT0FDZFQsRUFBT1EsSUFFUkgsRUFBT0ssV0FBV1AsRUFBTSxJQUN4QmhCLFNBQVNTLEtBQUtDLFlBQVlJLElBRTNCQSxFQUFRRixVIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vQ1Avd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovL0NQL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL0NQLy4vc291cmNlL1ZlY3RvcjIuY29mZmVlIiwid2VicGFjazovL0NQLy4vc291cmNlL0xpbmUuY29mZmVlIiwid2VicGFjazovL0NQLy4vc291cmNlL1V0aWxzLmNvZmZlZSIsIndlYnBhY2s6Ly9DUC93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vQ1Avd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9DUC93ZWJwYWNrL3J1bnRpbWUvbWFrZSBuYW1lc3BhY2Ugb2JqZWN0Iiwid2VicGFjazovL0NQLy4vc291cmNlL0JveC5qcyIsIndlYnBhY2s6Ly9DUC8uL3NvdXJjZS9DYXJ0LmpzIiwid2VicGFjazovL0NQLy4vc291cmNlL0xpbmVhclJlZ3Jlc3Npb24uanMiLCJ3ZWJwYWNrOi8vQ1AvLi9zb3VyY2UvTGluZWFyTW9kZWwuanMiLCJ3ZWJwYWNrOi8vQ1AvLi9zb3VyY2UvUnVubmVyLmpzIiwid2VicGFjazovL0NQLy4vc291cmNlL1RyYWluaW5nLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFtdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcIkNQXCJdID0gZmFjdG9yeSgpO1xuXHRlbHNlXG5cdFx0cm9vdFtcIkNQXCJdID0gZmFjdG9yeSgpO1xufSkoc2VsZiwgZnVuY3Rpb24oKSB7XG5yZXR1cm4gIiwiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsImNsYXNzIFZlY3RvcjJcclxuICAgICMgMkQgVmVjdG9yIG9iamVjdCByZXByZXNlbnRlZCBieSB4IGFuZCB5IGNvb3JkaW5hdGVzLlxyXG4gICAgIyBcclxuICAgICMgQHBhcmFtIFtudW1iZXJdIHggXHJcbiAgICAjIEBwYXJhbSBbbnVtYmVyXSB5IFxyXG4gICAgY29uc3RydWN0b3I6ICh4LCB5KSAtPiBcclxuICAgICAgICBAeCA9IHhcclxuICAgICAgICBAeSA9IHlcclxuXHJcbmV4cG9ydCB7VmVjdG9yMn0iLCJpbXBvcnQge1ZlY3RvcjJ9IGZyb20gXCIuL1ZlY3RvcjJcIlxyXG5cclxuIyBMaW5lIGJldHdlZW4gdHdvIHBvaW50cyAob3JpZ2luIHRvIGVuZCkuXHJcbiNcclxuIyBAcGFyYW0gW1ZlY3RvcjJdIG9yaWdpbiBcclxuIyBAcGFyYW0gW1ZlY3RvcjJdIGVuZFxyXG5jbGFzcyBMaW5lXHJcbiAgICBjb25zdHJ1Y3RvcjogKG9yaWdpbiwgZW5kKSAtPlxyXG4gICAgICAgIEBvcmlnaW4gPSBvcmlnaW5cclxuICAgICAgICBAZW5kID0gZW5kXHJcbiAgICBcclxuICAgICMgQ2FsY3VsYXRlIHRoZSBkaXN0YW5jZSBiZXR3ZWVuIHRoZSBvcmlnaW4gYW5kIGVuZCBwb2ludHMuXHJcbiAgICAjIFxyXG4gICAgIyBAcmV0dXJucyB7bnVtYmVyfSBTaXplIG9mIHRoZSBsaW5lLlxyXG4gICAgc2l6ZTogKCkgLT5cclxuICAgICAgICByZXR1cm4gTWF0aC5zcXJ0KE1hdGgucG93KEBvcmlnaW4ueCAtIEBlbmQueCwgMikgKyBNYXRoLnBvdyhAb3JpZ2luLnkgLSBAZW5kLnksIDIpKVxyXG5cclxuICAgICMgRHJhdyB0aGUgbGluZSBpbnRvIGEgY2FudmFzIDJEIGNvbnRleHQuXHJcbiAgICAjIFxyXG4gICAgIyBAcGFyYW0gW0NhbnZhc1JlbmRlcmluZ0NvbnRleHQyRF0gY29udGV4dCBcclxuICAgIGRyYXc6IChjb250ZXh0KSAtPlxyXG4gICAgICAgIGNvbnRleHQubGluZVdpZHRoID0gM1xyXG4gICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKClcclxuICAgICAgICBjb250ZXh0Lm1vdmVUbyhAb3JpZ2luLngsIEBvcmlnaW4ueSlcclxuICAgICAgICBjb250ZXh0LmxpbmVUbyhAZW5kLngsIEBlbmQueSlcclxuICAgICAgICBjb250ZXh0LnN0cm9rZSgpXHJcblxyXG5cclxuZXhwb3J0IHtMaW5lfSIsIiMgQXV4aWxpYXIgbWV0aG9kcyBmb3IgZmlsZSBtYW5pcHVsYXRpb24sIG5ldHdvcmtpbmcsIGV0Y1xyXG5jbGFzcyBVdGlsc1xyXG5cdCMgV3JpdGUgZGF0YSBpbnRvIGEgZmlsZS4gVXNlZnVsIHRvIGV4cG9ydCBKU09OIGRhdGEuXHJcblx0IyBcclxuXHQjIEBwYXJhbSBbc3RyaW5nIHwgb2JqZWN0XSBkYXRhIERhdGEgdG8gYmUgd3JpdHRlbiB0byBmaWxlLiBcclxuXHQjIEBwYXJhbSBbc3RyaW5nXSBmbmFtZSBOYW1lIG9mIHRoZSBmaWxlIHRvIGJlIHdyaXR0ZW4uXHJcblx0QHdyaXRlRmlsZTogKGRhdGEsIGZuYW1lKSAtPlxyXG5cdFx0aWYgdHlwZW9mIGRhdGEgPT0gJ29iamVjdCdcclxuXHRcdFx0ZGF0YSA9IEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsICdcXHQnKVxyXG5cclxuXHRcdGJsb2IgPSBuZXcgQmxvYihbZGF0YV0sIHt0eXBlOiAnb2N0ZXQvc3RyZWFtJ30pXHJcblx0XHRcclxuXHRcdGRvd25sb2FkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpXHJcblx0XHRkb3dubG9hZC5kb3dubG9hZCA9IGZuYW1lXHJcblx0XHRkb3dubG9hZC5ocmVmID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYilcclxuXHRcdGRvd25sb2FkLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSdcclxuXHJcblx0XHRkb3dubG9hZC5vbmNsaWNrID0gKCkgLT5cclxuXHRcdFx0ZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCh0aGlzKVxyXG5cdFx0XHRyZXR1cm5cclxuXHRcdFxyXG5cdFx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChkb3dubG9hZClcclxuXHRcdFxyXG5cdFx0ZG93bmxvYWQuY2xpY2soKVxyXG5cdFx0cmV0dXJuXHJcblxyXG5cclxuXHQjIENob29zZSBmaWxlIGFuZCByZWFkIGRhdGEgZnJvbSBpdC5cclxuXHRAcmVhZEZpbGU6IChvbkxvYWQpIC0+XHJcblx0XHRjaG9vc2VyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpXHJcblx0XHRjaG9vc2VyLnR5cGUgPSBcImZpbGVcIlxyXG5cdFx0Y2hvb3Nlci5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCJcclxuXHRcdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY2hvb3NlcilcclxuXHJcblx0XHRjaG9vc2VyLm9uY2hhbmdlID0gKCkgLT5cclxuXHRcdFx0ZmlsZXMgPSBjaG9vc2VyLmZpbGVzXHJcblx0XHRcdGlmIGZpbGVzLmxlbmd0aCA9PSAwXHJcblx0XHRcdFx0cmV0dXJuXHJcblxyXG5cdFx0XHRyZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpXHJcblx0XHRcdHJlYWRlci5vbmxvYWQgPSAoKSAtPlxyXG5cdFx0XHRcdHRleHQgPSByZWFkZXIucmVzdWx0XHJcblx0XHRcdFx0b25Mb2FkKHRleHQpXHJcblx0XHRcdFxyXG5cdFx0XHRyZWFkZXIucmVhZEFzVGV4dChmaWxlc1swXSlcclxuXHRcdFx0ZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChjaG9vc2VyKVxyXG5cclxuXHRcdGNob29zZXIuY2xpY2soKVxyXG5cclxuZXhwb3J0IHtVdGlsc31cclxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsImltcG9ydCB7VmVjdG9yMn0gZnJvbSBcIi4vVmVjdG9yMlwiO1xyXG5cclxuLyoqXHJcbiAqIEJveCBpcyByZXByZXNlbnRlZCBmcm9tIGEgbWluaW11bSBhbmQgYSBtYXhpbXVtIHBvaW50cy5cclxuICogXHJcbiAqIEBwYXJhbSBbVmVjdG9yMl0gbWluIFxyXG4gKiBAcGFyYW0gW1ZlY3RvcjJdIG1heCBcclxuICovXHJcbmZ1bmN0aW9uIEJveChtaW4sIG1heClcclxue1xyXG4gICAgdGhpcy5taW4gPSBtaW47XHJcbiAgICB0aGlzLm1heCA9IG1heDtcclxufVxyXG5cclxuLyoqXHJcbiAqIEdldCB0aGUgc2l6ZSBvZiB0aGUgYm94IGluIGEgVmVjdG9yLlxyXG4gKiBcclxuICogQHJldHVybnMge1ZlY3RvcjJ9IFNpemUgb2YgdGhlIGJveC4gXHJcbiAqL1xyXG5Cb3gucHJvdG90eXBlLmdldFNpemUgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIHJldHVybiBuZXcgVmVjdG9yMih0aGlzLm1heC54IC0gdGhpcy5taW4ueCwgdGhpcy5tYXgueSAtIHRoaXMubWluLnkpO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIERyYXcgdGhlIGJveCBpbnRvIGEgY29udGV4dCBmb3IgdmlzdWFsaXphdGlvbi5cclxuICogXHJcbiAqIEBwYXJhbSBbQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEXSBjb250ZXh0IFxyXG4gKi9cclxuQm94LnByb3RvdHlwZS5kcmF3ID0gZnVuY3Rpb24oY29udGV4dClcclxue1xyXG4gICAgdmFyIHNpemUgPSB0aGlzLmdldFNpemUoKTtcclxuICAgIGNvbnRleHQubGluZVdpZHRoID0gMztcclxuICAgIGNvbnRleHQuc3Ryb2tlUmVjdCh0aGlzLm1pbi54LCB0aGlzLm1pbi55LCBzaXplLngsIHNpemUueSk7XHJcbn07XHJcblxyXG5leHBvcnQge0JveH07IiwiaW1wb3J0IHtWZWN0b3IyfSBmcm9tIFwiLi9WZWN0b3IyXCI7XHJcbmltcG9ydCB7TGluZX0gZnJvbSBcIi4vTGluZVwiO1xyXG5pbXBvcnQge0JveH0gZnJvbSBcIi4vQm94XCI7XHJcblxyXG4vKipcclxuICogQ2FydCBvYmplY3QsIHRoYXQgY29udGFpbnMgdGhlIGVudGlyZSBsb2dpYyBmb3IgdGhlIHNpbXVsYXRpb24uXHJcbiAqIFxyXG4gKiBUaGUgY2FydCBjYW4gYmUgY29uZmlndXJlZFxyXG4gKi9cclxuZnVuY3Rpb24gQ2FydCgpXHJcbntcclxuICAgIC8qKlxyXG4gICAgICogRGlzdGFuY2Ugb2YgdGhlIGJhcnJpZXJzIHJlbGF0aXZlIHRvIHRoZSBjZW50ZXIuXHJcbiAgICAgKi9cclxuICAgIHRoaXMuYmFycmllckRpc3RhbmNlID0gNDAwO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogSGFsZiB0aGUgc2l6ZSBvZiB0aGUgY2FydCBib3guXHJcbiAgICAgKi9cclxuICAgIHRoaXMuYm94SGFsZlNpemUgPSA1MDtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEFjY2VsZXJhdGlvbiB1c2VkIGZvciBtb3ZlbWVudCBvZiB0aGUgY2FydCBvbiBrZXkgcHJlc3MuXHJcbiAgICAgKi9cclxuICAgIHRoaXMubW92ZUFjY2VsZXJhdGlvbiA9IDAuMjtcclxuXHJcbiAgICAvKipcclxuICAgICAqIExpbWl0IGFuZ2xlIHRoYXQgdGhlIHBlbmR1bHVtIGNhbiByZWFjaC5cclxuICAgICAqL1xyXG4gICAgdGhpcy5saW1pdEFuZ2xlID0gMC43O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQm94IHRoYXQgcmVwcmVzZW50cyB0aGUgY2FydC5cclxuICAgICAqL1xyXG4gICAgdGhpcy5jYXJ0ID0gbmV3IEJveChuZXcgVmVjdG9yMigtdGhpcy5ib3hIYWxmU2l6ZSwgLTMwKSwgbmV3IFZlY3RvcjIodGhpcy5ib3hIYWxmU2l6ZSwgMzApKTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIExpbmUgdG8gcmVwcmVzZW50IHRoZSBwZW5kdWx1bVxyXG4gICAgICovXHJcbiAgICB0aGlzLnBlbmR1bHVtID0gbmV3IExpbmUobmV3IFZlY3RvcjIoMCwgMCksIG5ldyBWZWN0b3IyKDAsIDEwMCkpO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIExlZnQgYmFycmllciBsaW1pdC5cclxuICAgICAqL1xyXG4gICAgdGhpcy5iYXJyaWVyTGVmdCA9IG5ldyBMaW5lKG5ldyBWZWN0b3IyKC10aGlzLmJhcnJpZXJEaXN0YW5jZSwgLTEwMDApLCBuZXcgVmVjdG9yMigtdGhpcy5iYXJyaWVyRGlzdGFuY2UsIDEwMDApKTtcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBSaWdodCBiYXJyaWVyIGxpbWl0LlxyXG4gICAgICovXHJcbiAgICB0aGlzLmJhcnJpZXJSaWdodCA9IG5ldyBMaW5lKG5ldyBWZWN0b3IyKHRoaXMuYmFycmllckRpc3RhbmNlLCAtMTAwMCksIG5ldyBWZWN0b3IyKHRoaXMuYmFycmllckRpc3RhbmNlLCAxMDAwKSk7XHJcbiAgICB0aGlzLnJlc2V0KCk7XHJcbn1cclxuXHJcblxyXG5cclxuLyoqXHJcbiAqIFJlc2V0IHRoZSBzaW11bGF0aW9uIHBhcmFtZXRlcnMgYmFjayB0byBhIGluaXRpYWwgc3RhdGUuXHJcbiAqIFxyXG4gKiBUaGUgaW5pdGlhbCB2ZWxvY2l0eSBvZiB0aGUgY2FydCBpcyByYW5kb21pemVkLlxyXG4gKi9cclxuQ2FydC5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbigpXHJcbntcclxuICAgIHRoaXMuZ2FtZU92ZXIgPSBmYWxzZTtcclxuICAgIHRoaXMuc2NvcmUgPSAwO1xyXG4gICAgdGhpcy5wb3NpdGlvbiA9IDA7XHJcbiAgICB0aGlzLmxlZnRQcmVzc2VkID0gZmFsc2U7XHJcbiAgICB0aGlzLnJpZ2h0UHJlc3NlZCA9IGZhbHNlO1xyXG4gICAgdGhpcy5hY2NlbGVyYXRpb24gPSAwLjA7XHJcbiAgICB0aGlzLmZyaWN0aW9uID0gMC45OTtcclxuICAgIHRoaXMudmVsb2NpdHkgPSAoTWF0aC5yYW5kb20oKSAqIDIgLSAxLjApO1xyXG4gICAgdGhpcy52ZWxvY2l0eSArPSB0aGlzLnZlbG9jaXR5IDwgMCA/IC0wLjIgOiAwLjI7XHJcbiAgICB0aGlzLmFuZ2xlID0gMDtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBEcmF3IHRoZSBzaW11bGF0aW9uIHRvIGEgY29udGV4dCAyRCBmb3IgdmlzdWFsaXphdGlvbi5cclxuICogXHJcbiAqIEBwYXJhbSBbQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEXSBjb250ZXh0IFxyXG4gKi9cclxuQ2FydC5wcm90b3R5cGUuZHJhdyA9IGZ1bmN0aW9uKGNvbnRleHQpXHJcbntcclxuICAgIHRoaXMuYmFycmllckxlZnQuZHJhdyhjb250ZXh0KTtcclxuICAgIHRoaXMuYmFycmllclJpZ2h0LmRyYXcoY29udGV4dCk7XHJcblxyXG4gICAgY29udGV4dC50cmFuc2xhdGUodGhpcy5wb3NpdGlvbiwgMCk7XHJcblxyXG4gICAgLy8gR3VpZGVsaW5lc1xyXG4gICAgY29udGV4dC5zdHJva2VTdHlsZSA9IFwiI0ZGMDAwMFwiO1xyXG4gICAgY29udGV4dC5saW5lV2lkdGggPSAxO1xyXG4gICAgY29udGV4dC5iZWdpblBhdGgoKTtcclxuICAgIGNvbnRleHQubW92ZVRvKE1hdGguc2luKC10aGlzLmxpbWl0QW5nbGUpICogMTAwLCBNYXRoLmNvcygtdGhpcy5saW1pdEFuZ2xlKSAqIDEwMCk7XHJcbiAgICBjb250ZXh0LmxpbmVUbygwLCAwKTtcclxuICAgIGNvbnRleHQubGluZVRvKE1hdGguc2luKHRoaXMubGltaXRBbmdsZSkgKiAxMDAsIE1hdGguY29zKHRoaXMubGltaXRBbmdsZSkgKiAxMDApO1xyXG4gICAgY29udGV4dC5zdHJva2UoKTtcclxuXHJcbiAgICBjb250ZXh0LnN0cm9rZVN0eWxlID0gXCIjMDAwMDAwXCI7XHJcbiAgICBjb250ZXh0LmxpbmVXaWR0aCA9IDM7XHJcbiAgICB0aGlzLnBlbmR1bHVtLmVuZC54ID0gTWF0aC5zaW4odGhpcy5hbmdsZSkgKiAxMDA7XHJcbiAgICB0aGlzLnBlbmR1bHVtLmVuZC55ID0gTWF0aC5jb3ModGhpcy5hbmdsZSkgKiAxMDA7XHJcbiAgICB0aGlzLnBlbmR1bHVtLmRyYXcoY29udGV4dCk7XHJcbiAgICB0aGlzLmNhcnQuZHJhdyhjb250ZXh0KTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBVcGRhdGUgdGhlIGxvZ2ljIG9mIHRoZSBzaW11bGF0aW9uLlxyXG4gKiBcclxuICogVGhlIGNhcnQgbW92ZXMgYWNjb3JkaW5nIHRvIGl0cyB2ZWxvY2l0eSwgdGhlIHN0aWNrIGlzIHVzZWQgYmFzZWQgb24gdmVsb2NpdHkgYW5kIGl0cyBjdXJyZW50IGFuZ2xlIChncmF2aXR5KS5cclxuICovXHJcbkNhcnQucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKClcclxue1xyXG4gICAgLy8gSWYgZ2FtZSBvdmVyIHJldHVyblxyXG4gICAgaWYodGhpcy5nYW1lT3ZlcilcclxuICAgIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUHJvY2VzcyBrZXkgcHJlc3Nlc1xyXG4gICAgaWYodGhpcy5sZWZ0UHJlc3NlZCl7dGhpcy5hY2NlbGVyYXRpb24gPSAtdGhpcy5tb3ZlQWNjZWxlcmF0aW9uO31cclxuICAgIGVsc2UgaWYodGhpcy5yaWdodFByZXNzZWQpe3RoaXMuYWNjZWxlcmF0aW9uID0gdGhpcy5tb3ZlQWNjZWxlcmF0aW9uO31cclxuICAgIGVsc2Uge3RoaXMuYWNjZWxlcmF0aW9uID0gMC4wO31cclxuXHJcbiAgICAvLyBVcGRhdGUgcGh5c2ljc1xyXG4gICAgdGhpcy52ZWxvY2l0eSArPSB0aGlzLmFjY2VsZXJhdGlvbjtcclxuICAgIHRoaXMudmVsb2NpdHkgKj0gdGhpcy5mcmljdGlvbjtcclxuICAgIHRoaXMucG9zaXRpb24gKz0gdGhpcy52ZWxvY2l0eTtcclxuXHJcbiAgICB0aGlzLmFuZ2xlICs9ICh0aGlzLmFuZ2xlICogM2UtMikgKyAoLXRoaXMudmVsb2NpdHkgKiA1ZS0zKTtcclxuICAgIHRoaXMuc2NvcmUrKztcclxuXHJcbiAgICAvLyBJZiB0aGUgYW5nbGUgb2YgdGhlIHBlbmR1bHVtIGRyb3AgYmVsbG93IHRoZSBtaW5pdW0gZW5kIHRoZSBnYW1lXHJcbiAgICBpZih0aGlzLmFuZ2xlID4gdGhpcy5saW1pdEFuZ2xlIHx8IHRoaXMuYW5nbGUgPCAtdGhpcy5saW1pdEFuZ2xlKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuZ2FtZU92ZXIgPSB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIElmIHRoZSBjYXJ0IGhpdHMgdGhlIGJhcnJpZWQgZW5kIHRoZSBnYW1lXHJcbiAgICBpZih0aGlzLnBvc2l0aW9uICsgdGhpcy5ib3hIYWxmU2l6ZSA+IHRoaXMuYmFycmllckRpc3RhbmNlIHx8IHRoaXMucG9zaXRpb24gLSB0aGlzLmJveEhhbGZTaXplIDwgLXRoaXMuYmFycmllckRpc3RhbmNlKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuZ2FtZU92ZXIgPSB0cnVlO1xyXG4gICAgfVxyXG59O1xyXG5cclxuZXhwb3J0IHtDYXJ0fTsiLCIvKipcclxuICogTGluZWFyIHJlZ3Jlc3Npb24gaXMgcmVwcmVzZW50ZWQgYnkgdHdvIHBhcmFtZXRlcnM6IHRoZSBvcmlnaW4gYW5kIHNsb3BlIG9mIHRoZSBsaW5lLlxyXG4gKiBcclxuICogQHBhcmFtIFtudW1iZXJdIG9yaSBPcmlnaW4gb2YgdGhlIGxpbmUuXHJcbiAqIEBwYXJhbSBbbnVtYmVyXSBkZWNsIFNsb3BlIG9mIHRoZSBsaW5lLlxyXG4gKi9cclxuZnVuY3Rpb24gTGluZWFyUmVncmVzc2lvbihvcmksIGRlY2wpXHJcbntcclxuICAgIHRoaXMub3JpID0gb3JpO1xyXG4gICAgdGhpcy5kZWNsID0gZGVjbDtcclxufVxyXG5cclxuLyoqXHJcbiAqIEppdHRlciB0aGUgdmFsdWVzIGluIHRoZSByZWdyZXNzaW9uIHJhbmRvbWx5LlxyXG4gKiBcclxuICogVXNlZnVsbCBmb3IgdHJhaW5pbmcgcHVycG9zZXMuXHJcbiAqIFxyXG4gKiBAcGFyYW0gW251bWJlcl0gc2NhbGUgU2NhbGUgb2YgdGhlIGppdHRlcmluZy4gXHJcbiAqL1xyXG5MaW5lYXJSZWdyZXNzaW9uLnByb3RvdHlwZS5qaXR0ZXIgPSBmdW5jdGlvbihzY2FsZSkge1xyXG4gICAgdGhpcy5vcmkgKz0gKE1hdGgucmFuZG9tKCkgLSAwLjUpICogc2NhbGU7XHJcbiAgICB0aGlzLmRlY2wgKz0gKE1hdGgucmFuZG9tKCkgLSAwLjUpICogc2NhbGU7XHJcbn07XHJcblxyXG4vKipcclxuICogQ3JlYXRlIGEgY29weSBvZiB0aGUgbGluZWFyIHJlZ3Jlc3Npb24gb2JqZWN0LlxyXG4gKiBcclxuICogQHJldHVybnMgQ2xvbmUgb2YgdGhlIGxpbmVhciByZWdyZXNzaW9uIG9iamVjdC5cclxuICovXHJcbkxpbmVhclJlZ3Jlc3Npb24ucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24oKVxyXG57XHJcbiAgICByZXR1cm4gbmV3IExpbmVhclJlZ3Jlc3Npb24odGhpcy5vcmksIHRoaXMuZGVjbCk7XHJcbn07XHJcblxyXG5leHBvcnQge0xpbmVhclJlZ3Jlc3Npb259OyIsImltcG9ydCB7TGluZWFyUmVncmVzc2lvbn0gZnJvbSBcIi4vTGluZWFyUmVncmVzc2lvblwiO1xyXG5cclxuLyoqXHJcbiAqIE1vZGVsIHRvIGNvbnRyb2wgdGhlIGNhcnQsIGl0cyBwYXJhbWV0ZXJzIGNhbiBiZSBzZXQgYW5kIHVzZWQgdG8gY29udHJvbCB0aGUgY2FydC5cclxuICogXHJcbiAqIFRoZSBtb2RlbCBpcyBjb21wb3NlZCBvZiAzIGxpbmVhciByZWdyZXNzaW9ucyBmb3Igd2ljaCB0aGVpciBwYXJhbWV0ZXJzIGNhbiBiZSB0cmFpbmVkIGFuZCB1c2VkIHRvIGNvbnRyb2wgdGhlIGNhcnQgb2JqZWN0LlxyXG4gKi9cclxuZnVuY3Rpb24gTGluZWFyTW9kZWwoKVxyXG57XHJcblx0dGhpcy52ZWwgPSBuZXcgTGluZWFyUmVncmVzc2lvbigwLCAwLjApO1xyXG5cclxuXHR0aGlzLmFuZ2xlID0gbmV3IExpbmVhclJlZ3Jlc3Npb24oMCwgMC4wKTtcclxuXHJcblx0dGhpcy5wb3MgPSBuZXcgTGluZWFyUmVncmVzc2lvbigwLCAwLjApO1xyXG5cclxuXHR0aGlzLmUgPSAwLjA7XHJcbn1cclxuXHJcbkxpbmVhck1vZGVsLnByb3RvdHlwZS5qaXR0ZXIgPSBmdW5jdGlvbihzY2FsZSlcclxue1xyXG5cdHRoaXMudmVsLmppdHRlcihzY2FsZSk7XHJcblx0dGhpcy5hbmdsZS5qaXR0ZXIoc2NhbGUpO1xyXG5cdHRoaXMucG9zLmppdHRlcihzY2FsZSk7XHJcblxyXG5cdHRoaXMuZSArPSAoTWF0aC5yYW5kb20oKSAtIDAuNSkgKiBzY2FsZTtcclxufTtcclxuXHJcbkxpbmVhck1vZGVsLnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uKClcclxue1xyXG5cdHZhciBtID0gbmV3IExpbmVhck1vZGVsKCk7XHJcblx0XHJcblx0bS52ZWwgPSB0aGlzLnBvcy5jbG9uZSgpO1xyXG5cdG0uYW5nbGUgPSB0aGlzLnBvcy5jbG9uZSgpO1xyXG5cdG0ucG9zID0gdGhpcy5wb3MuY2xvbmUoKTtcclxuXHRtLmUgPSB0aGlzLmU7XHJcblxyXG5cdHJldHVybiBtO1xyXG59XHJcblxyXG5MaW5lYXJNb2RlbC5wcm90b3R5cGUuY29udHJvbCA9IGZ1bmN0aW9uKGNhcnQpXHJcbntcclxuXHR2YXIgdiA9IHRoaXMudmVsLmRlY2wgKiBjYXJ0LnZlbG9jaXR5ICsgdGhpcy52ZWwub3JpO1xyXG5cdHZhciBhID0gdGhpcy5hbmdsZS5kZWNsICogY2FydC5hbmdsZSArIHRoaXMuYW5nbGUub3JpXHJcblx0dmFyIHAgPSB0aGlzLnBvcy5kZWNsICogY2FydC5wb3NpdGlvbiArIHRoaXMucG9zLm9yaTtcclxuXHJcblx0dmFyIHZhbHVlID0gYSArIHYgKyBwO1xyXG5cclxuXHRjYXJ0LmxlZnRQcmVzc2VkID0gdmFsdWUgPCB0aGlzLmU7XHJcblx0Y2FydC5yaWdodFByZXNzZWQgPSB2YWx1ZSA+IHRoaXMuZTtcclxufTtcclxuXHJcbmV4cG9ydCB7TGluZWFyTW9kZWx9OyIsImltcG9ydCB7Q2FydH0gZnJvbSBcIi4vQ2FydFwiO1xyXG5cclxuLyoqXHJcbiAqIE1ldGhvZHMgdG8gcnVuIHRoZSBzaW11bGF0aW9uIGluIGhlYWRsZXNzIG1vZGUgKHRlcm1pbmFsIG9ubHkpLCBvciBhdHRhY2hlZCB0byBhIGNhbnZhcyAoR3JhcGhpY2FsKS5cclxuICovXHJcbmZ1bmN0aW9uIFJ1bm5lcigpIHt9XHJcblxyXG4vKipcclxuICogUnVuIHRoZSBzaW11bGF0aW9uIGhlYWRsZXNzbHkgKGluIHRlcm1pbmFsKS5cclxuICogXHJcbiAqIFRoZSBzaW11bGF0aW9uIGlzIHJ1biB1bnRpbCB0aGUgc3RpY2sgaXMgZHJvcHBlZCBvZmYuXHJcbiAqIFxyXG4gKiBAcGFyYW0gW0Z1bmN0aW9uXSBsb2dpY0NhbGxiYWNrIENhbGxiYWNrIG1ldGhvZCB0byBwcm9jZXNzIHRoZSBjYXJ0IGxvZ2ljLlxyXG4gKiBAcGFyYW0gW251bWJlcl0gcG9pbnRMaW1pdCBIb3cgbXVjaCB0aW1lIHRvIHNpbXVsYXRlIGluIHRoZSBsaW1pdCAocHJldmVudCBpbmZpbml0ZSBydW4pLlxyXG4gKiBAcGFyYW0gW2Jvb2xlYW5dIGxvZ1BlcmZvcm1hbmNlIElmIHRydWUgY29uc29sZSBsb2dzIHdpdGggcGVyZm9ybWFuY2Ugb2YgdGhlIHNpbXVsYXRpb24gYXJlIHByaW50ZWQgb3V0LlxyXG4gKiBAcmV0dXJucyBSZXR1cm5zIHRoZSBhbW1vdW50IG9mIHBvaW50cyBhY2N1bXVsYXRlZCBkdXJpbmcgdGhlIHNpbXVsYXRpb24uXHJcbiAqL1xyXG5SdW5uZXIucnVuSGVhZGxlc3MgPSBmdW5jdGlvbihsb2dpY0NhbGxiYWNrLCBwb2ludExpbWl0LCBsb2dQZXJmb3JtYW5jZSlcclxue1xyXG4gICAgcG9pbnRMaW1pdCA9IHBvaW50TGltaXQgIT09IHVuZGVmaW5lZCA/IHBvaW50TGltaXQgOiBJbmZpbml0eTtcclxuXHJcbiAgICB2YXIgY2FydCA9IG5ldyBDYXJ0KCk7XHJcbiAgICBcclxuICAgIGlmKGxvZ1BlcmZvcm1hbmNlKVxyXG4gICAge1xyXG4gICAgICAgIHZhciB0aW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XHJcbiAgICB9XHJcblxyXG4gICAgd2hpbGUoIWNhcnQuZ2FtZU92ZXIgJiYgY2FydC5zY29yZSA8IHBvaW50TGltaXQpXHJcbiAgICB7XHRcclxuICAgICAgICBpZihsb2dpY0NhbGxiYWNrICE9PSB1bmRlZmluZWQpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBsb2dpY0NhbGxiYWNrKGNhcnQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2FydC51cGRhdGUoKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYobG9nUGVyZm9ybWFuY2UpXHJcbiAgICB7XHJcbiAgICAgICAgdmFyIGVuZCA9IHBlcmZvcm1hbmNlLm5vdygpO1xyXG5cclxuICAgICAgICBjb25zb2xlLmxvZyhcIiAtIFNpbXVsYXRpb24gZW5kZWQgd2l0aCBcIiArIGNhcnQuc2NvcmUgKyBcIiBwb2ludHMsIHRvb2sgXCIgKyAoZW5kIC0gdGltZSkgKyBcIi5cIik7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGNhcnQuc2NvcmU7XHJcbn07XHJcblxyXG4vKipcclxuICogUnVuIHRoZSBzaW11bGF0aW9uIHdpdGggdmlzdWFsaXphdGlvbiwgKGF0dGFjaGVkIHRvIGEgY2FudmFzKS5cclxuICogXHJcbiAqIFJ1bnMgYXQgcmVhbCB0aW1lIHNwZWVkIGZvciB2aXN1YWxpemF0aW9uIHB1cnBvc2VzLlxyXG4gKiBcclxuICogQHBhcmFtIFtFbGVtZW50XSBjYW52YXMgQ2FudmFzIGVsZW1lbnQgd2hlcmUgdGhlIGludGVyZmFjZSBpcyBkcmF3bi5cclxuICogQHBhcmFtIFtGdW5jdGlvbl0gb25JdGVyYXRpb24gTWV0aG9kIGNhbGxlZCBldmVyeSBpdGVyYXRpb24gb2YgdGhlIHNpbXVsYXRpb24gdG8gY29udHJvbCB0aGUgY2FydC5cclxuICogQHBhcmFtIFtGdW5jdGlvbl0gb25HYW1lT3ZlciBNZXRob2QgY2FsbGVkIHdoZW4gdGhlIHNpbXVsYXRpb24gZW5kcy5cclxuICovXHJcblJ1bm5lci5ydW5HcmFwaGljYWwgPSBmdW5jdGlvbihjYW52YXMsIG9uSXRlcmF0aW9uLCBvbkdhbWVPdmVyKVxyXG57XHJcbiAgICB2YXIgY2FydCA9IG5ldyBDYXJ0KCk7XHJcbiAgICB2YXIgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgICB2YXIgbWF4UG9pbnRzID0gMDtcclxuXHJcbiAgICBmdW5jdGlvbiBsb29wKClcclxuICAgIHtcclxuICAgICAgICBpZihvbkl0ZXJhdGlvbiAhPT0gdW5kZWZpbmVkKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgb25JdGVyYXRpb24oY2FydCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjYXJ0LnVwZGF0ZSgpO1xyXG5cclxuICAgICAgICBpZihjYXJ0LmdhbWVPdmVyKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYob25HYW1lT3ZlciAhPT0gdW5kZWZpbmVkKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBvbkdhbWVPdmVyKGNhcnQsIG1heFBvaW50cyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmKGNhcnQuc2NvcmUgPiBtYXhQb2ludHMpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG1heFBvaW50cyA9IGNhcnQuc2NvcmU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNhcnQucmVzZXQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFJlbmRlclxyXG4gICAgICAgIGNvbnRleHQuc2F2ZSgpO1xyXG4gICAgICAgIGNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gVGV4dCBpbiB0aGUgY2FudmFzXHJcbiAgICAgICAgY29udGV4dC5mb250ID0gXCIxNXB4IEFyaWFsXCI7XHJcbiAgICAgICAgY29udGV4dC50ZXh0QWxpZ24gPSBcImxlZnRcIjtcclxuICAgICAgICBjb250ZXh0LmZpbGxUZXh0KFwiUG9pbnRzOiBcIiArIGNhcnQuc2NvcmUsIDEwLCAyMCk7XHJcbiAgICAgICAgY29udGV4dC5maWxsVGV4dChcIk1heDogXCIgKyBtYXhQb2ludHMsIDEwLCA0MCk7XHJcblxyXG4gICAgICAgIC8vVHJhbnNmb3JtXHJcbiAgICAgICAgY29udGV4dC50cmFuc2Zvcm0oMSwgMCwgMCwgLTEsIDAsIGNhbnZhcy5oZWlnaHQpO1xyXG4gICAgICAgIGNvbnRleHQudHJhbnNsYXRlKGNhbnZhcy53aWR0aCAvIDIsIGNhbnZhcy5oZWlnaHQgLyAyKTtcclxuICAgICAgICBjYXJ0LmRyYXcoY29udGV4dCk7XHJcblxyXG4gICAgICAgIGNvbnRleHQucmVzdG9yZSgpO1xyXG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShsb29wKTtcclxuICAgIH1cclxuXHJcbiAgICBsb29wKCk7XHJcbn07XHJcblxyXG5leHBvcnQge1J1bm5lcn07IiwiaW1wb3J0IHtSdW5uZXJ9IGZyb20gXCIuL1J1bm5lclwiXHJcbmltcG9ydCB7TGluZWFyTW9kZWx9IGZyb20gXCIuL0xpbmVhck1vZGVsXCJcclxuXHJcbi8qKlxyXG4gKiBNZXRob2RzIGZvciB0cmFpbmluZyBvZiB0aGUgY2FydCBtb2RlbC5cclxuICovXHJcbmZ1bmN0aW9uIFRyYWluaW5nKCl7fVxyXG5cclxuLyoqXHJcbiAqIFRyYWluIHRoZSBtb2RlbCBvZiB0aGUgY2FydCBpdGVyYXRpdmVsbHkuXHJcbiAqIFxyXG4gKiBVc2VzIGEgc2Vhc29uYWwgdHJhaW5pbmcgYXBwcm9hY2ggZm9yIHdpY2ggbWFueSBlcG9jaHMgYXJlIGV4ZWN1dGVkIGFuZCB0aGUgYmVzdCBmcm9tIGVhY2ggZXBvY2ggaXMgc2VsZWN0ZWQgYXMgYmFzZWQgZm9yIHRoZSBuZXh0LlxyXG4gKiBcclxuICogQHBhcmFtIFtudW1iZXJdIGVwb2NocyBOdW1iZXIgb2YgaXRlcmF0aW9ucy9lcG9jaHMgdG8gc2ltdWxhdGUuXHJcbiAqIEBwYXJhbSBbbnVtYmVyXSBpdGVyYXRpb25zIE51bWJlciBvZiB2YXJpYXRpb25zIHRlc3RlZCBpbiBlYWNoIGVwb2NoLlxyXG4gKiBAcGFyYW0gW251bWJlcl0gcnVucyBIb3cgbWFueSB0aW1lcyB0byBydW4gZWFjaCB2YXJpYXRpb24gdG8gZ2V0IGFuIGF2ZXJhZ2UgcGVyZm9ybWFuY2UuXHJcbiAqIEByZXR1cm5zIHtMaW5lYXJNb2RlbH0gVHJhaW5lZCBtb2RlbCB0aGF0IGNhbiBiZSB1c2VkIHRvIGNvbnRyb2wgdGhlIHNpbXVsYXRpb24uXHJcbiAqL1xyXG4gVHJhaW5pbmcudHJhaW5JdGVyYXRpdmUgPSBmdW5jdGlvbihlcG9jaHMsIGl0ZXJhdGlvbnMsIHJ1bnMsIHNjb3JlTGltaXQpXHJcbiB7XHJcblx0ZXBvY2hzID0gZXBvY2hzICE9PSB1bmRlZmluZWQgPyBlcG9jaHMgOiA1MDA7XHJcblx0aXRlcmF0aW9ucyA9IGl0ZXJhdGlvbnMgIT09IHVuZGVmaW5lZCA/IGl0ZXJhdGlvbnMgOiAxMDA7XHJcblx0cnVucyA9IHJ1bnMgIT09IHVuZGVmaW5lZCA/IHJ1bnMgOiA1O1xyXG5cclxuXHQvLyBJZiB0aGUgbW9kZWwgcmVhY2hlcyB0aGlzIGxldmVsIG9mIHBlcmZvcm1hbmNlIHRoZSB0cmFpbmluZyBpcyBzdG9wcGVkLlxyXG5cdHNjb3JlTGltaXQgPSBzY29yZUxpbWl0ICE9PSB1bmRlZmluZWQgPyBzY29yZUxpbWl0IDogMjAwMC4wO1xyXG5cclxuXHRjb25zb2xlLmxvZyhcIiAtIFRyYWluaW5nIHByb2Nlc3Mgc3RhcnRpbmcuIFwiLCB7ZXBvY2hzLCBpdGVyYXRpb25zLCBydW5zfSk7XHJcblxyXG5cdHZhciBiZXN0TW9kZWwgPSBuZXcgTGluZWFyTW9kZWwoKTtcclxuXHR2YXIgYmVzdFNjb3JlID0gVHJhaW5pbmcudGVzdE1vZGVsKGJlc3RNb2RlbCwgcnVucywgc2NvcmVMaW1pdCk7XHJcblxyXG5cdHZhciBqaXR0ZXIgPSAxLjA7XHJcblx0XHJcblx0Ly8gRXBvY2hcclxuXHRmb3IodmFyIGUgPSAwOyBlIDwgZXBvY2hzOyBlKyspXHJcblx0e1xyXG5cdFx0Y29uc29sZS5sb2coXCIgLSBSdW5uaW5nIGVwb2NoIFwiLCBlLCBcIiBzY29yZSBcIiwgYmVzdFNjb3JlKTtcclxuXHJcblx0XHR2YXIgZXBvY2hNb2RlbCA9IG51bGw7XHJcblx0XHR2YXIgZXBvY2hTY29yZSA9IDA7XHJcblxyXG5cdFx0Ly8gTnVtYmVyIG9mIGl0ZXJhdGlvbnMgcGVyIGVwb2NoXHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgaXRlcmF0aW9uczsgaSsrKVxyXG5cdFx0e1xyXG5cdFx0XHR2YXIgbW9kZWwgPSBiZXN0TW9kZWwuY2xvbmUoKTtcclxuXHRcdFx0bW9kZWwuaml0dGVyKGppdHRlcik7XHJcblx0XHRcdFxyXG5cdFx0XHR2YXIgcG9pbnRzID0gVHJhaW5pbmcudGVzdE1vZGVsKG1vZGVsLCBydW5zLCBzY29yZUxpbWl0KTtcclxuXHRcdFx0aWYocG9pbnRzID4gZXBvY2hTY29yZSlcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGVwb2NoTW9kZWwgPSBtb2RlbDtcclxuXHRcdFx0XHRlcG9jaFNjb3JlID0gcG9pbnRzO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0aWYoZXBvY2hTY29yZSA+PSBiZXN0U2NvcmUpXHJcblx0XHR7XHJcblx0XHRcdGJlc3RNb2RlbCA9IGVwb2NoTW9kZWw7XHJcblx0XHRcdGJlc3RTY29yZSA9IGVwb2NoU2NvcmU7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKGJlc3RTY29yZSA+PSBzY29yZUxpbWl0KVxyXG5cdFx0e1xyXG5cdFx0XHRicmVhaztcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGNvbnNvbGUubG9nKFwiIC0gVHJhaW5pbmcgZmluaXNoZWQgd2l0aCBzY29yZSBcIiwgYmVzdFNjb3JlLCBcIiBtb2RlbCBcIiwgYmVzdE1vZGVsKTtcclxuXHRyZXR1cm4gYmVzdE1vZGVsO1xyXG4gfTtcclxuXHJcbi8qKlxyXG4gKiBGdWxseSByYW5kb21pemVkIHRyYWluaW5nLCB0ZXN0IG1hbnkgcGFyYW1ldGVycyBhbmQgc2VsZWN0IHRoZSBiZXN0IGZyb20gYWxsLlxyXG4gKiBcclxuICogQHBhcmFtIFtudW1iZXJdIGl0ZXJhdGlvbnMgTnVtYmVyIG9mIHZhcmlhdGlvbnMgdGVzdGVkIGluIGVhY2ggZXBvY2guXHJcbiAqIEBwYXJhbSBbbnVtYmVyXSBydW5zIEhvdyBtYW55IHRpbWVzIHRvIHJ1biBlYWNoIHZhcmlhdGlvbiB0byBnZXQgYW4gYXZlcmFnZSBwZXJmb3JtYW5jZS5cclxuICogQHJldHVybnMge0xpbmVhck1vZGVsfSBUcmFpbmVkIG1vZGVsIHRoYXQgY2FuIGJlIHVzZWQgdG8gY29udHJvbCB0aGUgc2ltdWxhdGlvbi5cclxuICovXHJcbiBUcmFpbmluZy50cmFpblJhbmRvbSA9IGZ1bmN0aW9uKGl0ZXJhdGlvbnMsIHJ1bnMsIHNjb3JlTGltaXQpXHJcbiB7XHJcblx0aXRlcmF0aW9ucyA9IGl0ZXJhdGlvbnMgIT09IHVuZGVmaW5lZCA/IGl0ZXJhdGlvbnMgOiAxZTU7XHJcblx0cnVucyA9IHJ1bnMgIT09IHVuZGVmaW5lZCA/IHJ1bnMgOiA1O1xyXG5cclxuXHQvLyBJZiB0aGUgbW9kZWwgcmVhY2hlcyB0aGlzIGxldmVsIG9mIHBlcmZvcm1hbmNlIHRoZSB0cmFpbmluZyBpcyBzdG9wcGVkLlxyXG5cdHNjb3JlTGltaXQgPSBzY29yZUxpbWl0ICE9PSB1bmRlZmluZWQgPyBzY29yZUxpbWl0IDogMjAwMC4wO1xyXG5cclxuXHRjb25zb2xlLmxvZyhcIiAtIFRyYWluaW5nIHByb2Nlc3Mgc3RhcnRpbmcuIFwiLCB7aXRlcmF0aW9ucywgcnVuc30pO1xyXG5cclxuXHR2YXIgYmVzdE1vZGVsID0gbnVsbDtcclxuXHR2YXIgYmVzdFNjb3JlID0gMDtcclxuXHRcclxuXHR2YXIgaml0dGVyID0gMi4wO1xyXG5cclxuXHQvLyBUZXN0cyBwZXIgZXBvY2hcclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgaXRlcmF0aW9uczsgaSsrKVxyXG5cdHtcclxuXHRcdHZhciBtb2RlbCA9IG5ldyBMaW5lYXJNb2RlbCgpO1xyXG5cdFx0bW9kZWwuaml0dGVyKGppdHRlcik7XHJcblx0XHRcclxuXHRcdHZhciBzY29yZSA9IFRyYWluaW5nLnRlc3RNb2RlbChtb2RlbCwgcnVucywgc2NvcmVMaW1pdCk7XHJcblx0XHRpZihzY29yZSA+IGJlc3RTY29yZSlcclxuXHRcdHtcclxuXHRcdFx0YmVzdE1vZGVsID0gbW9kZWw7XHJcblx0XHRcdGJlc3RTY29yZSA9IHNjb3JlO1xyXG5cdFx0fVxyXG5cclxuXHRcdGNvbnNvbGUubG9nKFwiIC0gSXRlcmF0aW9uIFwiLCBpLCBcIiBzY29yZSBcIiwgYmVzdFNjb3JlKTtcclxuXHJcblx0XHRpZiAoYmVzdFNjb3JlID49IHNjb3JlTGltaXQpXHJcblx0XHR7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0Y29uc29sZS5sb2coXCIgLSBUcmFpbmluZyBmaW5pc2hlZCB3aXRoIHNjb3JlIFwiLCBiZXN0U2NvcmUsIFwiIG1vZGVsIFwiLCBiZXN0TW9kZWwpO1xyXG5cclxuXHRyZXR1cm4gYmVzdE1vZGVsO1xyXG59XHJcblxyXG4vKipcclxuICogUnVuIHRoZSBtb2RlbCwgbXVsdGlwbGUgdGltZXMgYW5kIGF2ZXJhZ2UgdGhlIHBvbnR1YXRpb24gb2YgdGhlIHJ1bnMuXHJcbiAqIFxyXG4gKiBAcGFyYW0gW0xpbmVhck1vZGVsXSBtb2RlbCBNb2RlbCB0byBiZSB0ZXN0ZWQuXHJcbiAqIEBwYXJhbSBbbnVtYmVyXSBydW5zIE51bWJlciBvZiBpdGVyYXRpb25zIHRvIHRlc3QgdGhlIG1vZGVsLlxyXG4gKiBAcGFyYW0gW251bWJlcl0gc2NvcmVMaW1pdCBJZiB0aGUgc2NvcmUgb2YgdGhlIG1vZGVsIGdldHMgYmV0dGVyIHRoYW4gdGhlIGxpbWl0IHRoZSBzaW11bGF0aW9uIHN0b3BzLlxyXG4gKiBAcmV0dXJuIHtudW1iZXJ9IFRoZSBhdmVyYWdlIHBlcmZvcm1hbmNlIHNjb3JlIG9mIHRoZSBtb2RlbC5cclxuICovXHJcblRyYWluaW5nLnRlc3RNb2RlbCA9IGZ1bmN0aW9uKG1vZGVsLCBydW5zLCBzY29yZUxpbWl0KVxyXG57XHJcblx0dmFyIHNjb3JlID0gMDtcclxuXHRmb3IodmFyIHIgPSAwOyByIDwgcnVuczsgcisrKVxyXG5cdHtcclxuXHRcdHNjb3JlICs9IFJ1bm5lci5ydW5IZWFkbGVzcyhmdW5jdGlvbihjYXJ0KVxyXG5cdFx0e1xyXG5cdFx0XHRtb2RlbC5jb250cm9sKGNhcnQpO1xyXG5cdFx0fSwgc2NvcmVMaW1pdCk7XHJcblx0fVxyXG5cdHJldHVybiBzY29yZSAvIHJ1bnM7XHJcbn07XHJcblxyXG5leHBvcnQge1RyYWluaW5nfTsiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwiZGVmaW5lIiwiYW1kIiwic2VsZiIsIl9fd2VicGFja19yZXF1aXJlX18iLCJkZWZpbml0aW9uIiwia2V5IiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIm9iaiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwiQm94IiwibWluIiwibWF4IiwidGhpcyIsIkNhcnQiLCJiYXJyaWVyRGlzdGFuY2UiLCJib3hIYWxmU2l6ZSIsIm1vdmVBY2NlbGVyYXRpb24iLCJsaW1pdEFuZ2xlIiwiY2FydCIsIlZlY3RvcjIiLCJwZW5kdWx1bSIsIkxpbmUiLCJiYXJyaWVyTGVmdCIsImJhcnJpZXJSaWdodCIsInJlc2V0IiwiTGluZWFyUmVncmVzc2lvbiIsIm9yaSIsImRlY2wiLCJMaW5lYXJNb2RlbCIsInZlbCIsImFuZ2xlIiwicG9zIiwiZSIsIlJ1bm5lciIsIlRyYWluaW5nIiwiY29uc3RydWN0b3IiLCJ4IiwieSIsImdldFNpemUiLCJkcmF3IiwiY29udGV4dCIsInNpemUiLCJsaW5lV2lkdGgiLCJzdHJva2VSZWN0Iiwib3JpZ2luIiwiZW5kIiwiTWF0aCIsInNxcnQiLCJwb3ciLCJiZWdpblBhdGgiLCJtb3ZlVG8iLCJsaW5lVG8iLCJzdHJva2UiLCJnYW1lT3ZlciIsInNjb3JlIiwicG9zaXRpb24iLCJsZWZ0UHJlc3NlZCIsInJpZ2h0UHJlc3NlZCIsImFjY2VsZXJhdGlvbiIsImZyaWN0aW9uIiwidmVsb2NpdHkiLCJyYW5kb20iLCJ0cmFuc2xhdGUiLCJzdHJva2VTdHlsZSIsInNpbiIsImNvcyIsInVwZGF0ZSIsImppdHRlciIsInNjYWxlIiwiY2xvbmUiLCJtIiwiY29udHJvbCIsInYiLCJydW5IZWFkbGVzcyIsImxvZ2ljQ2FsbGJhY2siLCJwb2ludExpbWl0IiwibG9nUGVyZm9ybWFuY2UiLCJ1bmRlZmluZWQiLCJJbmZpbml0eSIsInRpbWUiLCJwZXJmb3JtYW5jZSIsIm5vdyIsImNvbnNvbGUiLCJsb2ciLCJydW5HcmFwaGljYWwiLCJjYW52YXMiLCJvbkl0ZXJhdGlvbiIsIm9uR2FtZU92ZXIiLCJnZXRDb250ZXh0IiwibWF4UG9pbnRzIiwibG9vcCIsInNhdmUiLCJjbGVhclJlY3QiLCJ3aWR0aCIsImhlaWdodCIsImZvbnQiLCJ0ZXh0QWxpZ24iLCJmaWxsVGV4dCIsInRyYW5zZm9ybSIsInJlc3RvcmUiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJ0cmFpbkl0ZXJhdGl2ZSIsImVwb2NocyIsIml0ZXJhdGlvbnMiLCJydW5zIiwic2NvcmVMaW1pdCIsImJlc3RNb2RlbCIsImJlc3RTY29yZSIsInRlc3RNb2RlbCIsImVwb2NoTW9kZWwiLCJlcG9jaFNjb3JlIiwiaSIsIm1vZGVsIiwicG9pbnRzIiwidHJhaW5SYW5kb20iLCJyIiwiVXRpbHMiLCJkYXRhIiwiZm5hbWUiLCJKU09OIiwic3RyaW5naWZ5IiwiYmxvYiIsIkJsb2IiLCJ0eXBlIiwiZG93bmxvYWQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJocmVmIiwid2luZG93IiwiVVJMIiwiY3JlYXRlT2JqZWN0VVJMIiwic3R5bGUiLCJkaXNwbGF5Iiwib25jbGljayIsImJvZHkiLCJyZW1vdmVDaGlsZCIsImFwcGVuZENoaWxkIiwiY2xpY2siLCJvbkxvYWQiLCJjaG9vc2VyIiwib25jaGFuZ2UiLCJmaWxlcyIsImxlbmd0aCIsInJlYWRlciIsIkZpbGVSZWFkZXIiLCJvbmxvYWQiLCJ0ZXh0IiwicmVzdWx0IiwicmVhZEFzVGV4dCJdLCJzb3VyY2VSb290IjoiIn0=